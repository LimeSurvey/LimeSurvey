(()=>{function e(e){var t=e.find("[name=administrator]:checked").val(),i=$("#conditional-administrator-fields");"custom"==t?i.show(200):i.hide(200)}$("#copysurveyform").submit(function(){let e="";if(""==$("#copysurveylist").val()&&(e+=sSelectASurveyMessage),""==$("#copysurveyname").val()&&(e=e+"\n\r"+sSelectASurveyName),""!=e)return alert(e),!1}),$(document).on("click","[data-copy] :submit",function(){$("form :input[value='"+$(this).val()+"']").click()}),$(document).on("ready  pjax:scriptcomplete",function(){if($("#template").on("change keyup",function(e){console.ls.log("TEMPLATECHANGE",e),function(e){$("#preview-image-container").html('<div style="height:200px;" class="ls-flex ls-flex-column align-content-center align-items-center"><i class="ri-loader-2-fill remix-spin remix-3x"></i></div>');let t=e.val();"inherit"===t&&(t=e.data("inherit-template-name")),$.ajax({url:e.data("updateurl"),data:{templatename:t},method:"POST",dataType:"json",success:function(e){$("#preview-image-container").html(e.image)},error:console.ls.error})}($(this))}),$("[data-copy]").each(function(){$(this).html($("#"+$(this).data("copy")).html())}),$("#tabs").on("tabsactivate",function(e,t){t.newTab.index()>4?$("#btnSave").hide():$("#btnSave").show()}),$("#addnewsurvey")){var t=$("#addnewsurvey");e(t),t.find("[name=administrator]").on("change",function(){e(t)})}})})(),(()=>{"use strict";const e=function(){let e={},t="",i=[],n={},s={},a=null;return{init:function(i){if(!i||!i.storagePrefix||!i.defaultState)return console.error("StateManager.init requires storagePrefix and defaultState"),e;t=i.storagePrefix,i.userid&&(t+="_"+i.userid),i.surveyid&&(t+="_"+i.surveyid),n=i.mutations||{},s=i.getters||{},a=i.persistKeys||null;const o=function(){try{const e=sessionStorage.getItem(t);if(e)return JSON.parse(e)}catch(e){console.warn("Failed to load state from sessionStorage:",e)}return{}}();return e=Object.assign({},i.defaultState,o),e},get:function(t){return t?e[t]:e},set:function(n,s){const o=e[n];e[n]=s,function(){try{if(a){for(var i={},n=0;n<a.length;n++){var s=a[n];e.hasOwnProperty(s)&&(i[s]=e[s])}sessionStorage.setItem(t,JSON.stringify(i))}else sessionStorage.setItem(t,JSON.stringify(e))}catch(e){console.warn("Failed to save state to sessionStorage:",e)}}(),function(e,t,n){i.forEach(function(i){i(e,t,n)})}(n,s,o)},commit:function(e,t){n[e]?n[e](t):console.warn("Unknown mutation:",e)},getComputed:function(e){if(s[e])return s[e]();console.warn("Unknown getter:",e)},subscribe:function(e){return i.push(e),function(){i=i.filter(t=>t!==e)}},registerMutations:function(e){Object.assign(n,e)},registerGetters:function(e){Object.assign(s,e)},getState:function(){return e}}}();function t(e,t){const i=$("#vue-apps-main-container"),n=i.length?i.width():1200;let s=.33*n;return n>1400&&(s=.25*n),{surveyid:0,language:"",maxHeight:0,inSurveyViewHeight:1e3,sideBodyHeight:"100%",sideBarHeight:400,currentUser:e,currentTab:"settings",sidebarwidth:s,maximalSidebar:!1,isCollapsed:!1,pjax:null,pjaxLoading:!1,lastMenuOpen:!1,lastMenuItemOpen:!1,lastQuestionOpen:!1,lastQuestionGroupOpen:!1,questionGroupOpenArray:[],questiongroups:[],collapsedmenus:null,sidemenus:null,topmenus:null,bottommenus:null,surveyActiveState:!1,toggleKey:Math.floor(1e4*Math.random())+"--key",allowOrganizer:!0}}function i(e){return{updateSurveyId:function(t){e.set("surveyid",t)},changeLanguage:function(t){e.set("language",t)},changeCurrentTab:function(t){e.set("currentTab",t)},changeSidebarwidth:function(t){e.set("sidebarwidth",t)},maxSideBarWidth:function(t){e.set("maximalSidebar",t)},changeIsCollapsed:function(t){e.set("isCollapsed",t),$(document).trigger("vue-sidemenu-update-link")},changeMaxHeight:function(t){e.set("maxHeight",t)},changeSideBarHeight:function(t){e.set("sideBarHeight",t)},changeInSurveyViewHeight:function(t){e.set("inSurveyViewHeight",t)},changeSideBodyHeight:function(t){e.set("sideBodyHeight",t?t+"px":"100%")},changeCurrentUser:function(t){e.set("currentUser",t)},closeAllMenus:function(){e.set("lastMenuOpen",!1),e.set("lastMenuItemOpen",!1),e.set("lastQuestionGroupOpen",!1),e.set("lastQuestionOpen",!1)},lastMenuItemOpen:function(t){e.set("lastMenuOpen",t.menu_id),e.set("lastMenuItemOpen",t.id),e.set("lastQuestionGroupOpen",!1),e.set("lastQuestionOpen",!1)},lastMenuOpen:function(t){e.set("lastMenuOpen",t.id),e.set("lastQuestionOpen",!1),e.set("lastMenuItemOpen",!1)},lastQuestionOpen:function(t){e.set("lastQuestionGroupOpen",t.gid),e.set("lastQuestionOpen",t.qid),e.set("lastMenuItemOpen",!1)},lastQuestionGroupOpen:function(t){e.set("lastQuestionGroupOpen",t.gid),e.set("lastQuestionOpen",!1)},questionGroupOpenArray:function(t){e.set("questionGroupOpenArray",t)},updateQuestiongroups:function(t){e.set("questiongroups",t)},addToQuestionGroupOpenArray:function(t){const i=e.get().questionGroupOpenArray.slice();i.push(t.gid),e.set("questionGroupOpenArray",i)},updateSidemenus:function(t){e.set("sidemenus",t)},updateCollapsedmenus:function(t){e.set("collapsedmenus",t)},updateTopmenus:function(t){e.set("topmenus",t)},updateBottommenus:function(t){e.set("bottommenus",t)},setSurveyActiveState:function(t){e.set("surveyActiveState",!!t)},newToggleKey:function(){e.set("toggleKey",Math.floor(1e4*Math.random())+"--key")},setAllowOrganizer:function(t){e.set("allowOrganizer",t)}}}function n(e){return{substractContainer:function(){const t=e.get(),i=$("#vue-apps-main-container"),n=i.length?i.width():window.innerWidth,s=100*(1-parseInt(t.sidebarwidth)/n),a=100*(1-98/n);return Math.floor(t.isCollapsed?a:s)+"%"},sideBarSize:function(){const t=e.get(),i=$("#vue-apps-main-container"),n=i.length?i.width():window.innerWidth,s=parseInt(t.sidebarwidth)/n*100,a=98/n*100;return Math.ceil(t.isCollapsed?a:s)+"%"},isRTL:function(){return"rtl"===document.getElementsByTagName("html")[0].getAttribute("dir")},isCollapsed:function(){return!(window.innerWidth<768)&&e.get().isCollapsed}}}const s=function(){function e(e,t,i){return t=t||{},i=i||"get",new Promise(function(n,s){"undefined"!=typeof $?$.ajax({url:e,method:i,data:t,dataType:"json",success:function(e,t,i){n({success:!0,data:e,transferStatus:t,xhr:i})},error:function(e,t,i){const n=e.responseJSON||e.responseText;s({success:!1,error:i,data:n,transferStatus:t,xhr:e})}}):s("JQUERY NOT AVAILABLE!")})}return{post:function(t,i){return e(t,i,"post")},get:function(t,i){return e(t,i,"get")},delete:function(t,i){return e(t,i,"delete")},put:function(t,i){return e(t,i,"put")}}}(),a=function(){function t(){console.ls&&console.ls.log&&console.ls.log.apply(console.ls,arguments)}function i(){$(document).trigger("pjax:refresh"),e.commit("newToggleKey")}function n(){return new Promise(function(n,a){s.get(window.SideMenuData.getMenuUrl,{position:"side"}).then(function(s){t("sidemenues",s);const a=LS.ld.orderBy(s.data.menues,function(e){return parseInt(e.order||999999)},["desc"]);e.commit("updateSidemenus",a),i(),n(a)}).catch(function(e){a(e)})})}function a(){return new Promise(function(n,a){s.get(window.SideMenuData.getMenuUrl,{position:"collapsed"}).then(function(s){t("quickmenu",s);const a=LS.ld.orderBy(s.data.menues,function(e){return parseInt(e.order||999999)},["desc"]);e.commit("updateCollapsedmenus",a),i(),n(a)}).catch(function(e){a(e)})})}function o(){return new Promise(function(n,a){s.get(window.SideMenuData.getQuestionsUrl).then(function(s){t("Questions",s);const a=s.data.groups;e.commit("updateQuestiongroups",a),i(),n(a)}).catch(function(e){a(e)})})}function r(){return Promise.all([n(),a()])}return{updatePjax:i,getSidemenus:n,getCollapsedmenus:a,getQuestions:o,collectMenus:r,unlockLockOrganizer:function(){return new Promise(function(i,n){const a=e.get("allowOrganizer")?0:1,o=a?"0":"1";s.post(window.SideMenuData.unlockLockOrganizerUrl,{setting:"lock_organizer",newValue:o}).then(function(n){t("setUsersettingLog",n),e.commit("setAllowOrganizer",a),i(n)}).catch(function(e){n(e)})})},changeCurrentTab:function(t){return e.commit("changeCurrentTab",t),Promise.all([r(),o()])},updateQuestionGroupOrder:function(e,t){const i=LS.ld.map(e,function(e){const t=LS.ld.map(e.questions,function(e){return{qid:e.qid,question:e.question,gid:e.gid,question_order:e.question_order}});return{gid:e.gid,group_name:e.group_name,group_order:e.group_order,questions:t}});return s.post(window.SideMenuData.updateOrderLink,{grouparray:i,surveyid:t})}}}(),o=function(){function e(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}return{translate:function(e){return window.SideMenuData&&window.SideMenuData.translate&&window.SideMenuData.translate[e]||e},redoTooltips:function(){window.LS&&window.LS.doToolTip&&window.LS.doToolTip()},reConvertHTML:function(e){if(!e)return"";var t={"&#039;":"'","&copy;":"©","&reg;":"®","&#36;":"$","&#37;":"%","&#64;":"@","&Agrave;":"À","&Aacute;":"Á","&Acirc;":"Â","&Atilde;":"Ã","&Auml;":"Ä","&Aring;":"Å","&AElig;":"Æ","&Ccedil;":"Ç","&Egrave;":"È","&Eacute;":"É","&Ecirc;":"Ê","&Euml;":"Ë","&Igrave;":"Ì","&Iacute;":"Í","&Icirc;":"Î","&Iuml;":"Ï","&ETH;":"Ð","&Ntilde;":"Ñ","&Otilde;":"Õ","&Ouml;":"Ö","&Oslash;":"Ø","&Ugrave;":"Ù","&Uacute;":"Ú","&Ucirc;":"Û","&Uuml;":"Ü","&Yacute;":"Ý","&THORN;":"Þ","&szlig;":"ß","&agrave;":"à","&aacute;":"á","&acirc;":"â","&atilde;":"ã","&auml;":"ä","&aring;":"å","&aelig;":"æ","&ccedil;":"ç","&egrave;":"è","&eacute;":"é","&ecirc;":"ê","&euml;":"ë","&igrave;":"ì","&iacute;":"í","&icirc;":"î","&iuml;":"ï","&eth;":"ð","&ntilde;":"ñ","&ograve;":"ò","&oacute;":"ó","&ocirc;":"ô","&otilde;":"õ","&ouml;":"ö","&oslash;":"ø","&ugrave;":"ù","&uacute;":"ú","&ucirc;":"û","&yacute;":"ý","&thorn;":"þ","&yuml;":"ÿ"};for(var i in t)t.hasOwnProperty(i)&&(e=e.split(i).join(t[i]));return e=e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})},renderMenuIcon:function(t,i){if(!i)return"";switch(t){case"fontawesome":return'<i class="icon fa fa-'+e(i)+'">&nbsp;</i>';case"image":return'<img class="icon" width="32px" src="'+e(i)+'" />';case"iconclass":case"remix":return'<i class="icon '+e(i)+'">&nbsp;</i>';default:return""}},createLoaderWidget:function(t,i){return i=i||"",'<div id="'+e(t=t||"loader-"+Math.floor(1e3*Math.random()))+'" class="loader--loaderWidget ls-flex ls-flex-column align-content-center align-items-center" style="min-height: 100%;"><div class="ls-flex align-content-center align-items-center"><div class="loader-adminpanel text-center '+e(i)+'"><div class="contain-pulse animate-pulse"><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div></div></div></div></div>'},parseIntOr:function(e,t){t=void 0!==t?t:999999;var i=parseInt(e,10);return isNaN(i)?t:i},useMobileView:function(){return window.innerWidth<768},escapeHtml:e}}(),r=class{constructor(){this.container=null,this.isLoading=!0,this.handleMenuItemClick=this.handleMenuItemClick.bind(this)}render(e,t){this.container=e,this.container&&(this.isLoading=!1,this.renderMenu())}renderMenu(){if(!this.container)return;const t=e.get("sidemenus")||[],i=LS.ld.orderBy(t,function(e){return parseInt(e.ordering||999999)},["asc"]);let n='<div class="ls-flex-column menu-pane overflow-enabled ls-space all-0 py-4 bg-white">';this.isLoading?n+=o.createLoaderWidget("sidemenuLoaderWidget",""):i.length>=2&&(n+='<div title="'+o.escapeHtml(i[0].title)+'" id="'+i[0].id+'" class="ls-flex-row wrap ls-space padding all-0">',n+=this.renderSubmenu(i[0]),n+="</div>",n+='<div title="'+o.escapeHtml(i[1].title)+'" id="'+i[1].id+'" class="ls-flex-row wrap ls-space padding all-0">',n+='<label class="menu-label mt-3 p-2 ls-survey-menu-item">'+o.escapeHtml(i[1].title)+"</label>",n+=this.renderSubmenu(i[1]),n+="</div>"),n+="</div>",this.container.innerHTML=n,this.bindEvents(),o.redoTooltips()}renderSubmenu(e){if(!e||!e.entries)return"";const t=LS.ld.orderBy(e.entries,function(e){return parseInt(e.ordering||999999)},["asc"]);let i='<ul class="list-group subpanel col-12 level-'+(e.level||0)+'">';return t.forEach(e=>{const t=this.getLinkClass(e),n=e.disabled?"#":e.link,s=!0===e.link_external?"_blank":"",a=e.disabled?e.disabled_tooltip:o.reConvertHTML(e.menu_description);i+='<a href="'+n+'"'+(s?' target="'+s+'"':"")+' id="sidemenu_'+e.name+'" class="list-group-item w-100 '+t+'" data-menu-item-id="'+e.id+'" data-menu-id="'+e.menu_id+'">',i+='<div class="d-flex '+(e.menu_class||"")+'" title="'+o.escapeHtml(a)+'" data-bs-toggle="tooltip">',i+='<div class="ls-space padding all-0 me-auto wrapper">',i+=o.renderMenuIcon(e.menu_icon_type,e.menu_icon),i+='<span class="title">'+(e.menu_title||"")+"</span>",!0===e.link_external&&(i+='<i class="ri-external-link-fill">&nbsp;</i>'),i+="</div>",i+="</div>",i+="</a>"}),i+="</ul>",i}getLinkClass(t){let i="nowrap ";return i+=t.pjax?"pjax ":" ",i+=e.get("lastMenuItemOpen")===t.id?"selected ":" ",i+=t.menu_icon?"":"ls-survey-menu-item",t.disabled&&(i+=" disabled"),i}bindEvents(){this.container&&$(this.container).off("click",".list-group-item").on("click",".list-group-item",this.handleMenuItemClick)}handleMenuItemClick(t){const i=$(t.currentTarget),n=i.data("menu-item-id"),s=i.data("menu-id");if(i.hasClass("disabled"))return t.preventDefault(),!1;e.commit("lastMenuItemOpen",{id:n,menu_id:s}),this.renderMenu()}},d=class{constructor(){this.container=null,this.isLoading=!0,this.handleMenuItemClick=this.handleMenuItemClick.bind(this)}render(e,t){this.container=e,this.container&&(this.isLoading=!1,this.renderMenu())}renderMenu(){if(!this.container)return;const t=e.get("collapsedmenus")||[],i=LS.ld.orderBy(t,function(e){return parseInt(e.ordering||999999)},["asc"]);let n='<div class="ls-flex-column fill">';this.isLoading?n+=o.createLoaderWidget("quickmenuLoadingIcon","loader-quickmenu"):i.forEach(e=>{n+='<div class="ls-space margin top-10" title="'+o.escapeHtml(e.title)+'">',n+='<div class="btn-group-vertical ls-space padding right-10">',this.sortMenuEntries(e.entries).forEach(e=>{n+=this.renderMenuItem(e)}),n+="</div>",n+="</div>"}),n+="</div>",this.container.innerHTML=n,this.bindEvents(),o.redoTooltips()}sortMenuEntries(e){return LS.ld.orderBy(e,function(e){return parseInt(e.ordering||999999)},["asc"])}renderMenuItem(e){const t=this.compileEntryClasses(e),i=o.reConvertHTML(e.menu_description),n=e.link_external?"_blank":"_self";let s='<a href="'+e.link+'" title="'+o.escapeHtml(i)+'" target="'+n+'" data-bs-toggle="tooltip" class="btn '+t+'" data-menu-item-id="'+e.id+'">';return s+=this.renderIcon(e),s+="</a>",s}renderIcon(e){const t=e.menu_icon_type,i=e.menu_icon;switch(t){case"fontawesome":return'<i class="quickmenuIcon fa fa-'+o.escapeHtml(i)+'"></i>';case"image":return'<img width="32px" src="'+o.escapeHtml(i)+'" />';case"iconclass":case"remix":return'<i class="quickmenuIcon '+o.escapeHtml(i)+'"></i>';default:return""}}compileEntryClasses(t){let i="";return e.get("lastMenuItemOpen")===t.id?i+=" btn-primary ":i+=" btn-outline-secondary ",t.link_external||(i+=" pjax "),i}bindEvents(){this.container&&$(this.container).off("click",".btn").on("click",".btn",this.handleMenuItemClick)}handleMenuItemClick(t){const i=$(t.currentTarget).data("menu-item-id");e.commit("lastMenuItemOpen",{id:i,menu_id:null}),this.renderMenu()}},l=class{constructor(){this.container=null,this.onOrderChange=null,this.active=[],this.questiongroupDragging=!1,this.draggedQuestionGroup=null,this.questionDragging=!1,this.draggedQuestion=null,this.draggedQuestionsGroup=null,this.orderChanged=!1}render(t,i,n){this.container=t,this.onOrderChange=n,this.container&&(this.active=e.get("questionGroupOpenArray")||[],this.renderExplorer())}isOpen(e){return!0!==this.questiongroupDragging&&-1!==LS.ld.indexOf(this.active,e)}isActive(t){return t==e.get("lastQuestionGroupOpen")}questionGroupItemClasses(e){var t="";return t+=this.isOpen(e.gid)?" selected ":" ",t+=this.isActive(e.gid)?" activated ":" ",null!==this.draggedQuestionGroup&&(t+=this.draggedQuestionGroup.gid===e.gid?" dragged":" "),t}questionItemClasses(t){var i="";return i+=e.get("lastQuestionOpen")===t.qid?"selected activated":"selected ",null!==this.draggedQuestion&&(i+=this.draggedQuestion.qid===t.qid?" dragged":" "),i}renderExplorer(){if(this.container){var t=e.get("questiongroups")||[],i=null===e.get("allowOrganizer")?1:1===e.get("allowOrganizer"),n=window.SideMenuData.isActive,s=window.SideMenuData.createQuestionGroupLink,a=window.SideMenuData.createQuestionLink,r=t.length>0&&a&&a.length>1,d=r?"":"disabled",l=s&&s.length>1?"":"disabled",u=LS.ld.orderBy(t,function(e){return o.parseIntOr(e.group_order,999999)},["asc"]),c=parseInt(e.get("sidebarwidth"))-120+"px",g='<div id="questionexplorer" class="ls-flex-column fill ls-ba menu-pane h-100 pt-2">';g+='<div class="ls-flex-row button-sub-bar mb-2">',g+='<div class="scoped-toolbuttons-right me-2">',g+='<button class="btn btn-sm btn-outline-secondary toggle-organizer-btn" title="'+o.translate(i?"lockOrganizerTitle":"unlockOrganizerTitle")+'">',g+='<i class="'+(i?"ri-lock-unlock-fill":"ri-lock-fill")+'"></i>',g+="</button>",g+='<button class="btn btn-sm btn-outline-secondary me-2 collapse-all-btn" title="'+o.translate("collapseAll")+'">',g+='<i class="ri-link-unlink"></i>',g+="</button>",g+="</div>",g+="</div>",g+='<div class="ls-flex-row wrap align-content-center align-items-center button-sub-bar">',g+='<div class="scoped-toolbuttons-left mb-2 d-flex align-items-center">';var h=o.translate(r?"":"deactivateSurvey");g+='<div class="create-question px-3" data-bs-toggle="tooltip" data-bs-placement="top" title="'+h+'">',g+='<a id="adminsidepanel__sidebar--selectorCreateQuestion" href="'+this.createFullQuestionLink(a)+'" class="btn btn-primary pjax '+d+'">',g+='<i class="ri-add-circle-fill"></i>&nbsp;'+o.translate("createQuestion"),g+="</a>",g+="</div>",g+='<div data-bs-toggle="tooltip" data-bs-placement="top" title="'+h+'">',g+='<a id="adminsidepanel__sidebar--selectorCreateQuestionGroup" href="'+s+'" class="btn btn-secondary pjax '+l+'">',g+=o.translate("createPage"),g+="</a>",g+="</div>",g+="</div>",g+="</div>",g+='<div class="ls-flex-row ls-space padding all-0">',g+='<ul class="list-group col-12 questiongroup-list-group">',u.forEach(e=>{g+=this.renderQuestionGroup(e,i,n,c)}),g+="</ul>",g+="</div>",g+="</div>",this.container.innerHTML=g,this.bindEvents(),o.redoTooltips()}}createFullQuestionLink(e){return e?LS.reparsedParameters&&LS.reparsedParameters().combined&&LS.reparsedParameters().combined.gid?e+"&gid="+LS.reparsedParameters().combined.gid:e:"#"}renderQuestionGroup(e,t,i,n){var s="list-group-item ls-flex-column"+this.questionGroupItemClasses(e),a=this.isOpen(e.gid),r=this.isActive(e.gid),d='<li class="'+s+'" data-gid="'+e.gid+'">';d+='<div class="q-group d-flex nowrap ls-space padding right-5 bottom-5 bg-white ms-2 p-2" data-gid="'+e.gid+'">',d+='<div class="bigIcons dragPointer me-1 questiongroup-drag-handle '+(t?"":"disabled")+'" ',d+=(t?'draggable="true"':"")+' data-gid="'+e.gid+'">',d+='<svg width="9" height="14" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">',d+='<path fill-rule="evenodd" clip-rule="evenodd" d="M0.4646 0.125H3.24762V2.625H0.4646V0.125ZM6.03064 0.125H8.81366V2.625H6.03064V0.125ZM0.4646 5.75H3.24762V8.25H0.4646V5.75ZM6.03064 5.75H8.81366V8.25H6.03064V5.75ZM0.4646 11.375H3.24762V13.875H0.4646V11.375ZM6.03064 11.375H8.81366V13.875H6.03064V11.375Z" fill="currentColor"/>',d+="</svg>",d+="</div>";var l=a?"transform: rotate(90deg)":"transform: rotate(0deg)";if(d+='<div class="cursor-pointer me-1 toggle-questiongroup" data-gid="'+e.gid+'" style="'+l+'">',d+='<i class="ri-arrow-right-s-fill"></i>',d+="</div>",d+='<div class="w-100 position-relative">',d+='<div class="cursor-pointer">',d+='<a class="d-flex pjax" href="'+e.link+'">',d+='<span class="question_text_ellipsize" style="max-width: '+n+'">'+o.escapeHtml(e.group_name)+"</span>",d+="</a>",d+="</div>",d+='<div class="position-absolute top-0 d-flex align-items-center" style="right:5px">',d+='<div class="toggle-questiongroup" data-gid="'+e.gid+'">',d+='<span class="badge reverse-color ls-space margin right-5">'+(e.questions?e.questions.length:0)+"</span>",d+="</div>",e.groupDropdown){var u=r?"":' style="display:none"';for(var c in d+='<div class="dropdown questiongroup-dropdown'+(r?" active":"")+'"'+u+">",d+='<div class="ls-questiongroup-tools cursor-pointer" data-bs-toggle="dropdown" aria-expanded="false">',d+='<i class="ri-more-fill"></i>',d+="</div>",d+='<ul class="dropdown-menu">',e.groupDropdown)if(e.groupDropdown.hasOwnProperty(c)){var g=e.groupDropdown[c];"delete"!==c?(d+="<li>",d+='<a class="dropdown-item" id="'+(g.id||"")+'" href="'+g.url+'">',d+='<span class="'+(g.icon||"")+'"></span> '+g.label,d+="</a>",d+="</li>"):(d+='<li class="'+(g.disabled?"disabled":"")+'">',g.disabled?d+='<a href="#" onclick="return false;" class="dropdown-item" data-bs-toggle="tooltip" data-bs-placement="bottom" title="'+o.escapeHtml(g.title||"")+'">':d+='<a href="#" onclick="return false;" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#confirmation-modal" data-btnclass="btn-danger" data-title="'+o.escapeHtml(g.dataTitle||"")+'" data-btntext="'+o.escapeHtml(g.dataBtnText||"")+'" data-onclick="'+o.escapeHtml(g.dataOnclick||"")+'" data-message="'+o.escapeHtml(g.dataMessage||"")+'">',d+='<span class="'+(g.icon||"")+'"></span> '+g.label,d+="</a>",d+="</li>")}d+="</ul>",d+="</div>"}return d+="</div>",d+="</div>",d+="</div>",a&&e.questions&&(d+=this.renderQuestionsList(e,t,i,n)),d+="</li>"}renderQuestionsList(e,t,i,n){var s=LS.ld.orderBy(e.questions,function(e){return o.parseIntOr(e.question_order,999999)},["asc"]),a='<ul class="list-group background-muted padding-left question-question-list" style="padding-right:15px">';return s.forEach(s=>{a+=this.renderQuestion(s,e,t,i,n)}),a+="</ul>"}renderQuestion(t,i,n,s,a){var r="list-group-item question-question-list-item ls-flex-row align-itmes-flex-start "+this.questionItemClasses(t),d=e.get("lastQuestionOpen")===t.qid,l="1"!==t.relevance,u='<li class="'+r+'" data-qid="'+t.qid+'" data-gid="'+i.gid+'" data-is-hidden="'+t.hidden+'" data-questiontype="'+t.type+'" data-has-condition="'+l+'" title="'+o.escapeHtml(t.question_flat)+'" data-bs-toggle="tooltip">';if(s||(u+='<div class="margin-right bigIcons dragPointer question-question-list-item-drag question-drag-handle '+(n?"":"disabled")+'" ',u+=(n?'draggable="true"':"")+' data-qid="'+t.qid+'" data-gid="'+i.gid+'">',u+='<svg width="9" height="14" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg">',u+='<path fill-rule="evenodd" clip-rule="evenodd" d="M0.4646 0.125H3.24762V2.625H0.4646V0.125ZM6.03064 0.125H8.81366V2.625H6.03064V0.125ZM0.4646 5.75H3.24762V8.25H0.4646V5.75ZM6.03064 5.75H8.81366V8.25H6.03064V5.75ZM0.4646 11.375H3.24762V13.875H0.4646V11.375ZM6.03064 11.375H8.81366V13.875H6.03064V11.375Z" fill="currentColor"/>',u+="</svg>",u+="</div>"),u+='<a href="'+t.link+'" class="col-9 pjax question-question-list-item-link display-as-container question-link" data-qid="'+t.qid+'" data-gid="'+t.gid+'">',u+='<span class="question_text_ellipsize '+(t.hidden?"question-hidden":"")+'" style="width: '+a+'">',u+="["+o.escapeHtml(t.title)+"] &rsaquo; "+o.escapeHtml(t.question_flat),u+="</span>",u+="</a>",t.questionDropdown){var c=d?"right:10px":"right:10px;display:none";for(var g in u+='<div class="dropdown question-dropdown position-absolute'+(d?" active":"")+'" style="'+c+'">',u+='<div class="ls-question-tools ms-auto position-relative cursor-pointer" data-bs-toggle="dropdown" aria-expanded="false">',u+='<i class="ri-more-fill"></i>',u+="</div>",u+='<ul class="dropdown-menu">',t.questionDropdown)if(t.questionDropdown.hasOwnProperty(g)){var h=t.questionDropdown[g];if("delete"===g||"language"===g&&Array.isArray(h))"delete"===g?(u+='<li class="'+(h.disabled?"disabled":"")+'">',h.disabled?u+='<a href="#" onclick="return false;" class="dropdown-item" data-bs-toggle="tooltip" data-bs-placement="bottom" title="'+o.escapeHtml(h.title||"")+'">':u+='<a href="#" onclick="return false;" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#confirmation-modal" data-btnclass="btn-danger" data-title="'+o.escapeHtml(h.dataTitle||"")+'" data-btntext="'+o.escapeHtml(h.dataBtnText||"")+'" data-onclick="'+o.escapeHtml(h.dataOnclick||"")+'" data-message="'+o.escapeHtml(h.dataMessage||"")+'">',u+='<span class="'+(h.icon||"")+'"></span> '+h.label,u+="</a>",u+="</li>"):"language"===g&&Array.isArray(h)&&(u+='<li role="separator" class="dropdown-divider"></li>',u+='<li class="dropdown-header">Survey logic file</li>',h.forEach(function(e){u+="<li>",u+='<a class="dropdown-item" id="'+(e.id||"")+'" href="'+e.url+'">',u+='<span class="'+(e.icon||"")+'"></span> '+e.label,u+="</a>",u+="</li>"}));else{var p="editDefault"===g&&0===h.active;u+="<li>",u+='<a class="dropdown-item '+(p?"disabled":"")+'" id="'+(h.id||"")+'" href="'+(p?"#":h.url)+'">',u+='<span class="'+(h.icon||"")+'"></span> '+h.label,u+="</a>",u+="</li>"}}u+="</ul>",u+="</div>"}return u+="</li>"}addActive(t){this.isOpen(t)||this.active.push(t),e.commit("questionGroupOpenArray",this.active)}toggleQuestionGroup(t){if(this.isOpen(t.gid)){var i=this.active.filter(function(e){return e!==t.gid});this.active=i.slice(),e.commit("questionGroupOpenArray",this.active)}else this.addActive(t.gid),e.commit("lastQuestionGroupOpen",t);this.renderExplorer()}openQuestion(t){this.addActive(t.gid),e.commit("lastQuestionOpen",t),$(document).trigger("pjax:load",{url:t.link})}collapseAll(){this.active=[],e.commit("questionGroupOpenArray",this.active),this.renderExplorer()}bindEvents(){if(this.container){var t=$(this.container);t.off(".qe"),t.on("click.qe",".toggle-organizer-btn",e=>{e.preventDefault(),a.unlockLockOrganizer().then(()=>{this.renderExplorer()})}),t.on("click.qe",".collapse-all-btn",e=>{e.preventDefault(),this.collapseAll()}),t.on("click.qe",".toggle-questiongroup",t=>{t.preventDefault(),t.stopPropagation();var i=$(t.currentTarget).data("gid"),n=(e.get("questiongroups")||[]).find(function(e){return e.gid===i});n&&this.toggleQuestionGroup(n)}),t.on("click.qe",".question-link",t=>{t.preventDefault(),t.stopPropagation();var i=$(t.currentTarget).data("qid"),n=$(t.currentTarget).data("gid"),s=(e.get("questiongroups")||[]).find(function(e){return e.gid===n});if(s&&s.questions){var a=s.questions.find(function(e){return e.qid===i});a&&this.openQuestion(a)}}),t.on("mouseover.qe",".q-group[data-gid]",function(e){$(this).find(".questiongroup-dropdown:not(.active)").show()}),t.on("mouseleave.qe",".q-group[data-gid]",function(e){$(this).find(".questiongroup-dropdown:not(.active)").hide()}),t.on("mouseover.qe",".question-question-list-item",function(e){$(this).find(".question-dropdown:not(.active)").show()}),t.on("mouseleave.qe",".question-question-list-item",function(e){$(this).find(".question-dropdown:not(.active)").hide()}),this.bindDragEvents(t)}}bindDragEvents(t){t.on("dragstart.qe",'.questiongroup-drag-handle[draggable="true"]',t=>{var i=$(t.currentTarget).data("gid"),n=e.get("questiongroups")||[];this.draggedQuestionGroup=n.find(function(e){return e.gid===i}),this.questiongroupDragging=!0,this.orderChanged=!1,t.originalEvent.dataTransfer.setData("text/plain","node"),$(t.currentTarget).closest(".list-group-item").addClass("dragged")}),t.on("dragend.qe",".questiongroup-drag-handle",()=>{null!==this.draggedQuestionGroup&&(this.draggedQuestionGroup=null,this.questiongroupDragging=!1,this.orderChanged&&this.onOrderChange&&this.onOrderChange(),this.orderChanged=!1,this.renderExplorer())}),t.on("dragenter.qe",".list-group-item[data-gid]",i=>{i.preventDefault();var n=$(i.currentTarget).data("gid"),s=e.get("questiongroups")||[],a=s.find(function(e){return e.gid===n});if(this.questiongroupDragging&&this.draggedQuestionGroup&&a){t.find(".list-group-item").removeClass("dragged"),$(i.currentTarget).addClass("dragged");var o=parseInt(a.group_order),r=parseInt(this.draggedQuestionGroup.group_order);1===Math.abs(o-r)&&(a.group_order=r,this.draggedQuestionGroup.group_order=o,e.commit("updateQuestiongroups",s),this.orderChanged=!0)}else if(this.questionDragging&&this.draggedQuestion&&a){if(window.SideMenuData.isActive)return;this.addActive(a.gid),this.draggedQuestion.gid!==a.gid&&LS.ld.remove(this.draggedQuestionsGroup.questions,e=>e.qid===this.draggedQuestion.qid).length>0&&(this.draggedQuestion.question_order=null,a.questions.push(this.draggedQuestion),this.draggedQuestion.gid=a.gid,a.group_order>this.draggedQuestionsGroup.group_order?(this.draggedQuestion.question_order=0,LS.ld.each(a.questions,function(e){e.question_order=parseInt(e.question_order)+1})):this.draggedQuestion.question_order=this.draggedQuestionsGroup.questions.length+1,this.draggedQuestionsGroup=a,e.commit("updateQuestiongroups",s),this.orderChanged=!0)}}),t.on("dragstart.qe",'.question-drag-handle[draggable="true"]',t=>{var i=$(t.currentTarget).data("qid"),n=$(t.currentTarget).data("gid"),s=(e.get("questiongroups")||[]).find(function(e){return e.gid===n});s&&s.questions&&(this.draggedQuestion=s.questions.find(function(e){return e.qid===i}),this.draggedQuestionsGroup=s,this.questionDragging=!0,this.orderChanged=!1,t.originalEvent.dataTransfer.setData("application/node","node"),$(t.currentTarget).closest(".question-question-list-item").addClass("dragged"))}),t.on("dragend.qe",".question-drag-handle",()=>{this.questionDragging&&(this.questionDragging=!1,this.draggedQuestion=null,this.draggedQuestionsGroup=null,this.orderChanged&&this.onOrderChange&&this.onOrderChange(),this.orderChanged=!1,this.renderExplorer())}),t.on("dragenter.qe",".question-question-list-item",i=>{i.preventDefault(),i.stopPropagation();var n=$(i.currentTarget).data("qid"),s=$(i.currentTarget).data("gid");if(this.questionDragging&&this.draggedQuestion){if(t.find(".question-question-list-item").removeClass("dragged"),$(i.currentTarget).addClass("dragged"),window.SideMenuData.isActive&&this.draggedQuestion.gid!==s)return;var a=e.get("questiongroups")||[],o=a.find(function(e){return e.gid===s});if(o&&o.questions){var r=o.questions.find(function(e){return e.qid===n});if(r&&r.qid!==this.draggedQuestion.qid){var d=r.question_order;r.question_order=this.draggedQuestion.question_order,this.draggedQuestion.question_order=d,e.commit("updateQuestiongroups",a),this.orderChanged=!0}}}}),t.on("dragover.qe",".list-group-item, .question-question-list-item",function(e){e.preventDefault()})}},u=class{constructor(){this.container=null,this.sideBarWidth="315",this.isMouseDown=!1,this.isMouseDownTimeOut=null,this.smallScreenHidden=!1,this.showLoader=!1,this.loading=!0,this.sideMenu=new r,this.quickMenu=new d,this.questionExplorer=new l,this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleQuestionGroupOrderChange=this.handleQuestionGroupOrderChange.bind(this),this.controlActiveLink=this.controlActiveLink.bind(this),this.handleUpdateSideBar=this.handleUpdateSideBar.bind(this),this.handleVueReloadRemote=this.handleVueReloadRemote.bind(this),this.handleVueRedraw=this.handleVueRedraw.bind(this),this.handlePjaxSend=this.handlePjaxSend.bind(this),this.handlePjaxRefresh=this.handlePjaxRefresh.bind(this),this.handleStateChange=this.handleStateChange.bind(this)}init(t){if(this.container=t,window.innerWidth<768&&e.commit("changeIsCollapsed",!1),e.commit("setSurveyActiveState",1===parseInt(window.SideMenuData.isActive)),e.getComputed("isCollapsed"))this.sideBarWidth=98;else{const t=e.get("sidebarwidth");this.sideBarWidth="string"==typeof t?parseInt(t):t}e.subscribe(this.handleStateChange),window.SideMenuData&&window.SideMenuData.basemenus&&LS.ld.each(window.SideMenuData.basemenus,(e,t)=>{this.setBaseMenuPosition(e,t)}),this.render(),this.bindEvents(),this.calculateHeight();const i=e.get("sidemenus");i&&i.length>0?this.loading=!1:this.loading=!0,this.renderContent(),$(document).trigger("sidebar:mounted")}handleStateChange(t,i,n){if("sidebarwidth"!==t||e.getComputed("isCollapsed")){if("isCollapsed"===t){if(i)this.sideBarWidth=98;else{const t=e.get("sidebarwidth");this.sideBarWidth="string"==typeof t?parseInt(t):t}this.render()}}else{this.sideBarWidth="string"==typeof i?parseInt(i):i;const e=document.getElementById("sidebar");e&&!this.isMouseDown&&(e.style.width=this.sideBarWidth+"px")}}setBaseMenuPosition(t,i){const n=LS.ld.orderBy(t,function(e){return parseInt(e.order||999999)},["desc"]);switch(i){case"side":e.commit("updateSidemenus",n);break;case"collapsed":e.commit("updateCollapsedmenus",n)}}calculateHeight(){const t=$("#in_survey_common").height();t&&e.commit("changeSideBarHeight",t)}getSideBarWidth(){const t=e.getComputed("isCollapsed")?98:this.sideBarWidth;return"string"==typeof t?parseInt(t):t}calculateSideBarMenuHeight(){const t=e.get("sideBarHeight");return LS.ld.min([t,Math.floor(2*screen.height)])+"px"}toggleCollapse(){const t=e.get("isCollapsed");if(e.commit("changeIsCollapsed",!t),e.getComputed("isCollapsed"))this.sideBarWidth=98;else{const t=e.get("sidebarwidth");this.sideBarWidth="string"==typeof t?parseInt(t):t}this.render()}toggleSmallScreenHide(){this.smallScreenHidden=!this.smallScreenHidden,this.render()}changeCurrentTab(t){"structure"===t&&(t="questiontree"),"settings"!==t&&"questiontree"!==t&&(t="settings"),e.commit("changeCurrentTab",t),this.render()}handleMouseDown(t){if(o.useMobileView())return e.commit("changeIsCollapsed",!1),this.smallScreenHidden=!this.smallScreenHidden,void this.render();this.isMouseDown=!e.getComputed("isCollapsed"),$("#sidebar").removeClass("transition-animate-width"),$("#pjax-content").removeClass("transition-animate-width")}handleMouseUp(t){if(this.isMouseDown){this.isMouseDown=!1;const t="string"==typeof this.sideBarWidth?parseInt(this.sideBarWidth):this.sideBarWidth;t<250&&!e.getComputed("isCollapsed")?(this.toggleCollapse(),e.commit("changeSidebarwidth",340)):e.commit("changeSidebarwidth",t),$("#sidebar").addClass("transition-animate-width"),$("#pjax-content").removeClass("transition-animate-width")}}handleMouseLeave(e){this.isMouseDown&&(this.isMouseDownTimeOut=setTimeout(()=>{this.handleMouseUp(e)},1e3))}handleMouseMove(t){if(!this.isMouseDown)return;const i=e.getComputed("isRTL");if(0!==t.screenX||0!==t.screenY){if(i){if(window.innerWidth-t.clientX>screen.width/2)return void e.commit("maxSideBarWidth",!0);this.sideBarWidth=window.innerWidth-t.pageX-8}else{if(t.clientX>screen.width/2)return void e.commit("maxSideBarWidth",!0);this.sideBarWidth=t.pageX-4}e.commit("changeSidebarwidth",this.sideBarWidth),e.commit("maxSideBarWidth",!1),window.clearTimeout(this.isMouseDownTimeOut),this.isMouseDownTimeOut=null,$("#sidebar").css("width",this.sideBarWidth+"px")}}controlActiveLink(){const t=window.location.href,i=e.get("sidemenus")||[],n=e.get("collapsedmenus")||[],s=e.get("questiongroups")||[];let a=!1;LS.ld.each(i,function(e){LS.ld.each(e.entries,function(e){LS.ld.endsWith(t,e.link)&&(a=e)})});let o=!1;LS.ld.each(n,function(e){LS.ld.each(e.entries,function(e){LS.ld.endsWith(t,e.link)&&(o=e)})});let r=!1;LS.ld.each(s,function(e){if(new RegExp("questionGroupsAdministration/view\\?surveyid=\\d*&gid="+e.gid+"|questionGroupsAdministration/edit\\?surveyid=\\d*&gid="+e.gid+"|questionGroupsAdministration/view/surveyid/\\d*/gid/"+e.gid+"|questionGroupsAdministration/edit/surveyid/\\d*/gid/"+e.gid).test(t)||LS.ld.endsWith(t,e.link))return r=e,!1});let d=!1;const l=document.querySelector('#edit-question-form [name="question[qid]"]');if(null!==l){const e=l.value;LS.ld.each(s,function(t){if(LS.ld.each(t.questions,function(i){if(e===i.qid)return d=i,r=t,!1}),!1!==d)return!1})}e.commit("closeAllMenus"),!1===a||e.getComputed("isCollapsed")||e.commit("lastMenuItemOpen",a),!1!==o&&e.getComputed("isCollapsed")&&e.commit("lastMenuItemOpen",o),!1!==r&&(e.commit("lastQuestionGroupOpen",r),e.commit("addToQuestionGroupOpenArray",r)),!1!==d&&e.commit("lastQuestionOpen",d)}handleQuestionGroupOrderChange(){this.showLoader=!0,this.render();const t=e.get("questiongroups"),i=e.get("surveyid");a.updateQuestionGroupOrder(t,i).then(()=>a.getQuestions()).then(()=>{this.showLoader=!1,this.render()}).catch(e=>{console.ls.error("questiongroups updating error!",e),a.getQuestions().then(()=>{this.showLoader=!1,this.render()})})}bindEvents(){window.addEventListener("resize",LS.ld.debounce(()=>this.calculateHeight(),300)),$("body").on("mousemove",this.handleMouseMove),$(document).on("vue-sidemenu-update-link",this.controlActiveLink),$(document).on("vue-reload-remote",this.handleVueReloadRemote),$(document).on("vue-redraw",this.handleVueRedraw),$(document).on("pjax:send",this.handlePjaxSend),$(document).on("pjax:refresh",this.handlePjaxRefresh),$(document).on("updateSideBar",this.handleUpdateSideBar)}handleVueReloadRemote(){Promise.all([a.getQuestions(),a.collectMenus()]).then(()=>{this.controlActiveLink(),this.renderContent()}),e.commit("newToggleKey")}handleVueRedraw(){Promise.all([a.getQuestions(),a.collectMenus()]).then(()=>{this.controlActiveLink(),this.renderContent()})}handlePjaxSend(){o.useMobileView()&&this.smallScreenHidden&&(this.smallScreenHidden=!1,this.render())}handlePjaxRefresh(){this.controlActiveLink()}handleUpdateSideBar(e,t){this.loading=!0,this.renderContent();const i=[Promise.resolve()];t&&t.updateQuestions&&i.push(a.getQuestions()),t&&t.collectMenus&&i.push(a.collectMenus()),t&&t.activeMenuIndex&&this.controlActiveLink(),Promise.all(i).catch(e=>{console.ls.error(e)}).finally(()=>{this.loading=!1,this.renderContent()})}render(){if(!this.container)return;const t=e.getComputed("isCollapsed"),i=e.get("currentTab"),n=e.getComputed("isRTL"),s=e.get("inSurveyViewHeight"),a=this.getSideBarWidth();let r="d-flex col-lg-4 ls-ba position-relative transition-animate-width";this.smallScreenHidden&&(r+=" toggled");const d=o.useMobileView()&&this.smallScreenHidden||!o.useMobileView(),l=o.useMobileView()&&this.smallScreenHidden,u=this.isMouseDown;let c='<div id="sidebar" class="'+r+'" style="width: '+a+"px; max-height: "+s+'px; display: flex;">';d&&(this.showLoader&&(c+='<div class="sidebar_loader" style="width: '+this.getSideBarWidth()+"px; height: "+$("#sidebar").height()+'px;"><div class="ls-flex ls-flex-column fill align-content-center align-items-center"><i class="ri-loader-2-fill remix-2x remix-spin"></i></div></div>'),c+='<div class="col-12 mainContentContainer">',c+='<div class="mainMenu col-12 position-relative">',c+=this.renderStateToggle(t,i,n),c+='<div id="sidemenu-container" class="slide-fade" style="display: '+(t||"settings"!==i?"none":"block")+"; min-height: "+this.calculateSideBarMenuHeight()+';"></div>',c+='<div id="questionexplorer-container" class="slide-fade" style="display: '+(t||"questiontree"!==i?"none":"block")+"; min-height: "+this.calculateSideBarMenuHeight()+';"></div>',c+='<div id="quickmenu-container" style="display: '+(t?"block":"none")+';"></div>',(o.useMobileView()&&!this.smallScreenHidden||!o.useMobileView())&&(c+='<div class="resize-handle ls-flex-column" style="height: '+this.calculateSideBarMenuHeight()+';">',t||(c+='<button class="btn resize-btn" type="button"><svg width="9" height="14" viewBox="0 0 9 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.4646 0.125H3.24762V2.625H0.4646V0.125ZM6.03064 0.125H8.81366V2.625H6.03064V0.125ZM0.4646 5.75H3.24762V8.25H0.4646V5.75ZM6.03064 5.75H8.81366V8.25H6.03064V5.75ZM0.4646 11.375H3.24762V13.875H0.4646V11.375ZM6.03064 11.375H8.81366V13.875H6.03064V11.375Z" fill="currentColor"/></svg></button>'),c+="</div>"),c+="</div>",c+="</div>"),l&&(c+='<div class="scoped-placeholder-greyed-area"> </div>'),u&&(c+='<div style="position: fixed; inset: 0;"></div>'),c+="</div>",this.container.innerHTML=c,this.bindInternalEvents(),this.renderContent()}renderStateToggle(e,t,i){let n='<div class="ls-space col-12">';return n+='<div class="ls-flex-row align-content-space-between align-items-flex-end ls-space padding left-0 bottom-0 top-0">',n+=e?'<button class="btn btn-outline-secondary ls-space padding left-15 right-15 expand-sidebar-btn"><i class="'+(i?"ri-arrow-left-s-line":"ri-arrow-right-s-line")+'"></i></button>':'<div class="ls-flex-item grow-10 col-12"><ul class="nav nav-tabs" id="surveysystem" role="tablist"><li class="nav-item"><a id="adminsidepanel__sidebar--selectorSettingsButton" class="nav-link sidebar-tab-link'+("settings"===t?" active":"")+'" href="#settings" data-tab="settings" role="tab">'+o.translate("settings")+'</a></li><li class="nav-item"><a id="adminsidepanel__sidebar--selectorStructureButton" class="nav-link sidebar-tab-link'+("questiontree"===t?" active":"")+'" href="#structure" data-tab="questiontree" role="tab">'+o.translate("structure")+"</a></li></ul></div>",n+="</div>",n+="</div>",n}renderContent(){const e=document.getElementById("sidemenu-container"),t=document.getElementById("questionexplorer-container"),i=document.getElementById("quickmenu-container");e&&this.sideMenu.render(e,this.loading),t&&this.questionExplorer.render(t,this.loading,this.handleQuestionGroupOrderChange),i&&this.quickMenu.render(i,this.loading),o.redoTooltips()}bindInternalEvents(){$(this.container).off("click",".sidebar-tab-link").on("click",".sidebar-tab-link",e=>{e.preventDefault();const t=$(e.currentTarget).data("tab");this.changeCurrentTab(t)}),$(this.container).off("click",".expand-sidebar-btn").on("click",".expand-sidebar-btn",e=>{e.preventDefault(),this.toggleCollapse()}),$(this.container).off("mousedown",".resize-btn").on("mousedown",".resize-btn",this.handleMouseDown),$(this.container).off("mouseup").on("mouseup",this.handleMouseUp),$(this.container).off("mouseleave","#sidebar").on("mouseleave","#sidebar",this.handleMouseLeave),$(this.container).off("click",".scoped-placeholder-greyed-area").on("click",".scoped-placeholder-greyed-area",()=>this.toggleSmallScreenHide())}update(e){e=e||{},this.loading=!0,this.renderContent();const t=[];e.updateQuestions&&t.push(a.getQuestions()),e.collectMenus&&t.push(a.collectMenus()),Promise.all(t).then(()=>{e.activeMenuIndex&&this.controlActiveLink()}).catch(e=>{console.ls.error(e)}).finally(()=>{this.loading=!1,this.renderContent()})}},c=function(s,a){const o={};function r(){const e=($("body").find("nav").first().height()||0)+($("body").find("footer").last().height()||0)+($(".menubar").outerHeight()||0)+25,t=window.innerHeight-e,i=$("#sidebar").width()||0,n=$("#vue-apps-main-container").width()||1,s=100*(1-parseInt(i)/n),a=100*(1-parseInt("98px")/n),r=Math.floor($("#sidebar").data("collapsed")?s:a)+"%";o.surveyViewHeight=t,o.surveyViewWidth=r,$("#fullbody-container").css({"max-width":r,"overflow-x":"auto"})}function d(){const o=document.getElementById("vue-sidebar-container");if(!o)return null;e.init({storagePrefix:"limesurveyadminsidepanel",userid:s,surveyid:a,defaultState:t(s),mutations:i(e),getters:n(e),persistKeys:["currentTab","isCollapsed","sidebarwidth","questionGroupOpenArray","lastMenuOpen","lastMenuItemOpen","lastQuestionOpen","lastQuestionGroupOpen","allowOrganizer"]}),0!==a&&"0"!==a&&"newSurvey"!==a&&e.commit("updateSurveyId",a);const r=$("#in_survey_common").height()-35||400;e.commit("changeMaxHeight",r),window.SideMenuData&&void 0!==window.SideMenuData.allowOrganizer?e.commit("setAllowOrganizer",0===window.SideMenuData.allowOrganizer?0:1):e.commit("setAllowOrganizer",1);const d=new u;return d.init(o),$(document).on("vue-redraw",function(){e.commit("newToggleKey")}),$(document).trigger("vue-reload-remote"),d}return LS&&LS.adminCore&&LS.adminCore.addToNamespace&&LS.adminCore.addToNamespace(o,"adminsidepanel"),function(){window.singletonPjax&&window.singletonPjax(),document.getElementById("vue-sidebar-container")&&(o.sidemenu=d()),$(document).on("click","ul.pagination>li>a",function(){$(document).trigger("pjax:refresh")}),r(),window.addEventListener("resize",LS.ld.debounce(r,300)),$(document).on("vue-resize-height",LS.ld.debounce(r,300)),o.reloadcounter=5,$(document).off("pjax:send.panelloading").on("pjax:send.panelloading",function(){$('<div id="pjaxClickInhibitor"></div>').appendTo("body"),$(".ui-dialog.ui-corner-all.ui-widget.ui-widget-content.ui-front.ui-draggable.ui-resizable").remove(),$("#pjax-file-load-container").find("div").css({width:"20%",display:"block"}),LS.adminsidepanel.reloadcounter--}),$(document).off("pjax:error.panelloading").on("pjax:error.panelloading",function(e){console.ls&&console.ls.log&&console.ls.log(e)}),$(document).off("pjax:complete.panelloading").on("pjax:complete.panelloading",function(){0===LS.adminsidepanel.reloadcounter&&location.reload()}),$(document).off("pjax:scriptcomplete.panelloading").on("pjax:scriptcomplete.panelloading",function(){$("#pjax-file-load-container").find("div").css("width","100%"),$("#pjaxClickInhibitor").fadeOut(400,function(){$(this).remove()}),$(document).trigger("vue-resize-height"),$(document).trigger("vue-reload-remote"),setTimeout(function(){$("#pjax-file-load-container").find("div").css({width:"0%",display:"none"})},2200)})}};$(document).ready(function(){let e="newSurvey";void 0!==window.LS&&(e=window.LS.parameters.$GET.surveyid||window.LS.parameters.keyValuePairs.surveyid),window.SideMenuData&&(e=window.SideMenuData.surveyid);const t=window.LS&&window.LS.globalUserId?window.LS.globalUserId:null;window.adminsidepanel=window.adminsidepanel||c(t,e),window.adminsidepanel()})})();