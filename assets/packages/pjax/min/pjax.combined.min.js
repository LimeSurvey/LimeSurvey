!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Pjax=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return s(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(t){if(Array.prototype.from)return Array.from(t);for(var e=[],n=t.length;n--;e.unshift(t[n]));return e}var r,a=function(t,e,n){return t instanceof HTMLCollection||t instanceof NodeList||t instanceof Array?s(t).forEach((function(t,o){return e.call(n,t,o)})):e.call(n,t)},l=function(t){return t.querySelectorAll(this.options.elements)},c=function(e){if(null===e||"object"!=t(e))return e;var n=e.constructor();for(var o in e)o in e&&(n[o]=e[o]);return n},u=function(){return window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/)},h=(r=0,function(){var t="pjax"+(new Date).getTime()+"_"+r;return r++,t});function p(t,e,n,o){(e="string"==typeof e?e.split(" "):e).forEach((function(e){a(t,(function(t){t.addEventListener(e,n,o),t.eventHandlers||(t.eventHandlers={}),t.eventHandlers[e]||(t.eventHandlers[e]=[]),t.eventHandlers[e].push(n)}))}))}function f(t,e,n){(e="string"==typeof e?e.split(" "):e).forEach((function(e){a(t,(function(t){t.eventHandlers&&t.eventHandlers[e]&&(t.eventHandlers[e].forEach((function(o){t.removeEventListener(e,o,n)})),t.eventHandlers[e]=[])}))}))}var d=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e(this,t),this.param=n,this.silencer=o,this.collector=[],this.currentGroupDescription="",this.activeGroups=0,this.timeHolder=null,this.methods=["group","groupEnd","log","trace","time","timeEnd","error","warn"],this.silent={group:function(){},groupEnd:function(){},log:function(){},trace:function(){},time:function(){},timeEnd:function(){},error:function(){},err:function(){},debug:function(){},warn:function(){}}}return o(t,[{key:"_generateError",value:function(){try{throw new Error}catch(t){return t}}},{key:"_insertParamToArguments",value:function(t){if(""!==this.param){var e=i(t);return e.unshift(this.param),e}return s(arguments)}},{key:"setSilent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.silencer=t||!this.silencer}},{key:"group",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);if("function"!=typeof console.group){var e=t[0]||"GROUP";this.currentGroupDescription=e,this.activeGroups++}else console.group.apply(console,t)}}},{key:"groupEnd",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);"function"!=typeof console.groupEnd?(this.currentGroupDescription="",this.activeGroups--,this.activeGroups=0===this.activeGroups?0:this.activeGroups--):console.groupEnd.apply(console,t)}}},{key:"log",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);"function"!=typeof console.group?(t.shift(),t.unshift(" ".repeat(2*this.activeGroups)),this.log.apply(this,t)):console.log.apply(console,t)}}},{key:"trace",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);if("function"!=typeof console.trace){var e=this._generateError();e.stack?this.log.apply(console,e.stack):(this.log.log(t),null!=arguments.callee&&this.trace.apply(console,arguments.callee))}else console.trace.apply(console,t)}}},{key:"time",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);"function"!=typeof console.time?this.timeHolder=new Date:console.time.apply(console,t)}}},{key:"timeEnd",value:function(){if(!this.silencer){var t=this._insertParamToArguments(arguments);if("function"!=typeof console.timeEnd){var e=new Date-this.timeHolder;this.log.log("Took ".concat(Math.floor(e/36e5)," hours, ").concat(Math.floor(e/6e4)," minutes and ").concat(Math.floor(e/1e3)," seconds ( ").concat(e," ms)")),this.time=new Date}else console.timeEnd.apply(console,t)}}},{key:"error",value:function(){var t=this._insertParamToArguments(arguments);"function"!=typeof console.error?(this.log.log("--- ERROR ---"),this.log.log(t)):console.error.apply(console,t)}},{key:"warn",value:function(){var t=this._insertParamToArguments(arguments);"function"!=typeof console.warn?(this.log.log("--- WARN ---"),this.log.log(t)):console.warn.apply(console,t)}}]),t}();function m(){return console.log("PJAX options",this.options),this.options.logObject=new d("PJAX ->",!this.options.debug),this.options.logObject}function w(t,e,n){(e="string"==typeof e?e.split(" "):e).forEach((function(e){var o;(o=document.createEvent("HTMLEvents")).initEvent(e,!0,!0),o.eventName=e,n&&Object.keys(n).forEach((function(t){o[t]=n[t]})),a(t,(function(t){var e=!1;t.parentNode||t===document||t===window||(e=!0,document.body.appendChild(t)),t.dispatchEvent(o),e&&t.parentNode.removeChild(t)}))}))}function y(t,e,n){var o=(e=e||{}).requestMethod||"GET",i=e.requestPayloadString||null,s=new XMLHttpRequest;return s.onreadystatechange=function(){4===s.readyState&&(200===s.status?n(s.responseText,s):n(null,s))},this.options.cacheBust&&(t+=(/[?&]/.test(t)?"&":"?")+(new Date).getTime()),s.open(o.toUpperCase(),t,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!=e.requestPayloadString&&""!=e.requestPayloadString&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(i),s}var g={outerHTML:function(t,e){t.outerHTML=e.outerHTML,this.onSwitch()},innerHTML:function(t,e){t.innerHTML=e.innerHTML,t.className=e.className,this.onSwitch()},sideBySide:function(t,e,n,o){var i=[],r=[],a=document.createDocumentFragment(),l="animationend webkitAnimationEnd MSAnimationEnd oanimationend",c=0,u=function(t){t.target==t.currentTarget&&--c<=0&&i&&(i.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)})),r.forEach((function(t){t.className=t.className.replace(t.getAttribute("data-pjax-classes"),""),t.removeAttribute("data-pjax-classes")})),r=null,i=null,this.onSwitch())}.bind(this);o=o||{},s(t.childNodes).forEach((function(t){i.push(t),t.classList&&!t.classList.contains("js-Pjax-remove")&&(t.hasAttribute("data-pjax-classes")&&(t.className=t.className.replace(t.getAttribute("data-pjax-classes"),""),t.removeAttribute("data-pjax-classes")),t.classList.add("js-Pjax-remove"),o.callbacks&&o.callbacks.removeElement&&o.callbacks.removeElement(t),o.classNames&&(t.className+=" "+o.classNames.remove+" "+(n.backward?o.classNames.backward:o.classNames.forward)),c++,p(t,l,u,!0))})),s(e.childNodes).forEach((function(t){if(t.classList){var e="";o.classNames&&(e=" js-Pjax-add "+o.classNames.add+" "+(n.backward?o.classNames.forward:o.classNames.backward)),o.callbacks&&o.callbacks.addElement&&o.callbacks.addElement(t),t.className+=e,t.setAttribute("data-pjax-classes",e),r.push(t),a.appendChild(t),c++,p(t,l,u,!0)}})),t.className=e.className,t.appendChild(a)}};function v(){var t=this;return function(e,n,o,i,s,r){o.forEach((function(o){var l=i.querySelectorAll(o),c=s.querySelectorAll(o);if((t.log.log("Pjax switch",o,l,c),l.length!==c.length)&&r.onDomDiffers(s,i))throw"DOM doesn’t look the same on new loaded page: ’"+o+"’ - new "+l.length+", old "+c.length;a(l,(function(t,i){var s=c[i];null!=s&&(this.log.log("newEl",t,"oldEl",s),e[o]?e[o].call(this,s,t,r,n[o]):g.outerHTML.call(this,s,t,r))}),t)}))}}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,o=function(){},i=function(){return n.apply(this instanceof o&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,i.prototype=new o,i});var b="data-pjax-click-state",j=function(t,e){if(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)t.setAttribute(b,"modifier");else if(t.protocol===window.location.protocol&&t.host===window.location.host)if(t.pathname===window.location.pathname&&t.hash.length>0)t.setAttribute(b,"anchor-present");else if(t.hash&&t.href.replace(t.hash,"")===window.location.href.replace(location.hash,""))t.setAttribute(b,"anchor");else if(t.href!==window.location.href.split("#")[0]+"#"){if(e.preventDefault(),this.options.currentUrlFullReload&&t.href===window.location.href.split("#")[0])return t.setAttribute(b,"reload"),void this.reload();this.options.requestOptions=this.options.requestOptions||{},t.setAttribute(b,"load"),this.loadUrl(t.href,c(this.options))}else t.setAttribute(b,"anchor-empty");else t.setAttribute(b,"external")},x=function(t){return t.defaultPrevented||!1===t.returnValue};function E(){var t=this;return function(e){f(e,"click"),p(e,"click",(function(n){x(n)||j.call(t,e,n)})),f(e,"keyup"),p(e,"keyup",(function(n){x(n)||(n.which>1||n.metaKey||n.ctrlKey||n.shiftKey||n.altKey?e.setAttribute("data-pjax-keyup-state","modifier"):13==n.keyCode&&j.call(t,e,n))}))}}var P="data-pjax-submit-state",A=function(t,e){this.options.requestOptions={requestUrl:t.getAttribute("action")||window.location.href,requestMethod:t.getAttribute("method")||"GET"};var n=document.createElement("a");if(n.setAttribute("href",this.options.requestOptions.requestUrl),n.protocol===window.location.protocol&&n.host===window.location.host)if(n.pathname===window.location.pathname&&n.hash.length>0)t.setAttribute(P,"anchor-present");else if(n.href!==window.location.href.split("#")[0]+"#")if(this.options.currentUrlFullReload)t.setAttribute(P,"reload");else{e.preventDefault();var o=[],i=[];for(var r in t.elements){var a=t.elements[r];if(a.name&&void 0!==a.attributes&&"button"!==a.tagName.toLowerCase()&&("checkbox"!==a.type&&"radio"!==a.type||a.checked)&&-1===o.indexOf(a.name)){if(o.push(a.name),"select"===String(a.nodeName).toLowerCase()&&1==a.multiple){var l=s(a.options).map((function(t){return t.selected?t.value:null}));return void i.push({name:encodeURIComponent(a.name),value:l})}i.push({name:encodeURIComponent(a.name),value:encodeURIComponent(a.value)})}}var u=i.map((function(t){return t.name+"="+t.value})).join("&");this.options.requestOptions.requestPayload=i,this.options.requestOptions.requestPayloadString=u,t.setAttribute(P,"submit"),this.loadUrl(n.href,c(this.options))}else t.setAttribute(P,"anchor-empty");else t.setAttribute(P,"external")};function S(){var t=this;return function(e){p(e,"submit",(function(n){(function(t){return t.defaultPrevented||!1===t.returnValue})(n)||A.call(t,e,n)}))}}var k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(t,e){t(e={exports:{}},e.exports)}((function(t){!function(e){var n=setTimeout;function o(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function s(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void a(e.promise,t)}r(e.promise,o)}else(1===t._state?r:a)(e.promise,t._value)}))):t._deferreds.push(e)}function r(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void u((o=n,s=e,function(){o.apply(s,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){a(t,e)}var o,s}function a(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)s(t,t._deferreds[e]);t._deferreds=null}function c(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function u(t,e){var n=!1;try{t((function(t){n||(n=!0,r(e,t))}),(function(t){n||(n=!0,a(e,t))}))}catch(t){if(n)return;n=!0,a(e,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(o);return s(this,new c(t,e,n)),n},i.all=function(t){return new i((function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(t);if(0===o.length)return e([]);var i=o.length;function s(t,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var a=r.then;if("function"==typeof a)return void a.call(r,(function(e){s(t,e)}),n)}o[t]=r,0==--i&&e(o)}catch(t){n(t)}}for(var r=0;r<o.length;r++)s(r,o[r])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(e){e(t)}))},i.reject=function(t){return new i((function(e,n){n(t)}))},i.race=function(t){return new i((function(e,n){for(var o=0,i=t.length;o<i;o++)t[o].then(e,n)}))},i._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){n(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},t.exports?t.exports=i:e.Promise||(e.Promise=i)}(k)}));function T(t){var e=this.options.mainScriptElement,n=t.text||t.textContent||t.innerHTML||"";if(this.log.log("Evaluating Script: ",t),n.match("document.write"))return console&&this.options.logObject.log&&this.options.logObject.log("Script contains document.write. Can’t be executed correctly. Code skipped ",t),!1;var o=t.src||"",i=t.parentNode||document.querySelector(e)||document.documentElement,s=document.createElement("script"),r=new Promise((function(t){if(s.type="text/javascript",""!=o&&(s.src=o,s.addEventListener("load",(function(){t(o)})),s.async=!0),""!=n){try{s.appendChild(document.createTextNode(n))}catch(t){s.text=n}t("text-node")}}));return this.log.log("ParentElement => ",i),i.appendChild(s),i.removeChild(s),["head","body"].indexOf(i.tagName.toLowerCase())>0||this.options.removeScriptsAfterParsing,r}function U(){var t=this;return function(e){t.log.log("Executing scripts for ",e);var n=[];return void 0===e?Promise.resolve():("script"===e.tagName.toLowerCase()&&T.call(t,e),a(e.querySelectorAll("script"),(function(e){e.type&&"text/javascript"!==e.type.toLowerCase()||e.parentNode&&"textarea"==e.parentNode.tagName||n.push(T.call(t,e))}),t),n)}}function O(){return function(t){f(t,"click"),f(t,"keyup")}}function _(){return function(t){f(t,"submit"),f(t,"keyup")}}function N(){var t=this;return function(e,n){t.log.log("styleheets old elements",n),t.log.log("styleheets new elements",e),a(e,(function(e){if(null!==s(n).reduce((function(t,n){return t=n.href===e.href?n:t}),null))t.log&&t.log.log("old stylesheet found not resetting");else{t.log&&t.log.log("new stylesheet => add to head");var o=document.getElementsByTagName("head")[0],i=document.createElement("link");i.setAttribute("href",e.href),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),o.appendChild(i)}}))}}function D(){return{parseElementUnload:function(t){switch(t.tagName.toLowerCase()){case"a":t.hasAttribute("data-pjax-click-state")||this.unattachLink(t);break;case"form":t.hasAttribute("data-pjax-click-state")||this.unattachForm(t);break;default:throw"Pjax can only be applied on <a> or <form> submit"}},parseElement:function(t){switch(t.tagName.toLowerCase()){case"a":t.hasAttribute("data-pjax-click-state")||this.attachLink(t);break;case"form":t.hasAttribute("data-pjax-click-state")||this.attachForm(t);break;default:throw"Pjax can only be applied on <a> or <form> submit"}},parseDOMUnload:function(t){a(this.getElements(t),this.parseElementUnload,this)},parseDOM:function(t){a(this.getElements(t),this.parseElement,this)},parseOptions:function(t){this.options=t,this.options.elements=this.options.elements||"a[href], form[action]",this.options.reRenderCSS=this.options.reRenderCSS||!1,this.options.forceRedirectOnFail=this.options.forceRedirectOnFail||!1,this.options.scriptloadtimeout=this.options.scriptloadtimeout||1e3,this.options.mainScriptElement=this.options.mainScriptElement||"head",this.options.removeScriptsAfterParsing=this.options.removeScriptsAfterParsing||!0,this.options.logObject=this.options.logObject||console,this.options.latestChance=this.options.latestChance||null,this.options.selectors=this.options.selectors||["title",".js-Pjax"],this.options.switches=this.options.switches||{},this.options.switchesOptions=this.options.switchesOptions||{},this.options.history=this.options.history||!0,this.options.onDomDiffers=this.options.onDomDiffers||function(){return!0},this.options.pjaxErrorHandler=this.options.pjaxErrorHandler||function(){return!1},this.options.onJsonDocument=this.options.onJsonDocument||function(){return!0},this.options.analytics=this.options.analytics||function(){window._gaq&&window._gaq.push(["_trackPageview"]),window.ga&&window.ga("send","pageview",{page:location.pathname,title:document.title})},this.options.scrollTo=void 0===this.options.scrollTo?0:this.options.scrollTo,this.options.cacheBust=void 0===this.options.cacheBust||this.options.cacheBust,this.options.debug=this.options.debug||!1,this.options.switches.head||(this.options.switches.head=this.switchElementsAlt),this.options.switches.body||(this.options.switches.body=this.switchElementsAlt),"function"!=typeof t.analytics&&(t.analytics=function(){})}}}function C(){var t=this;return{refresh:function(e){t.parseDOM(e||document)},reload:function(){window.location.reload()},foreachSelectors:function(t,e,n,o){o=o||document,t.forEach((function(t){a(o.querySelectorAll(t),e,n)}))},unattach:function(e){a(t.getElements(e),(function(t){f(t,"click"),f(t,"keyup")}),t)}}}return new function(){var t=function(){function t(n){var o=this;return e(this,t),this.firstrun=!0,this.oUtilities={forEachEls:a,getElements:l,clone:c,isSupported:u,newUid:h},this.oDomUtils=C.call(this),this.oParsers=D.call(this),this.oParsers.parseOptions.call(this,n),this.log=m.call(this),this.doRequest=y,this.getElements=this.oUtilities.getElements,this.parseElementUnload=this.oParsers.parseElementUnload,this.parseElement=this.oParsers.parseElement,this.parseDOM=this.oParsers.parseDOM,this.parseDOMUnload=this.oParsers.parseDOMUnload,this.refresh=this.oDomUtils.refresh,this.reload=this.oDomUtils.reload,this.isSupported=this.oUtilities.isSupported,this.attachLink=E.call(this),this.attachForm=S.call(this),this.unattachLink=O.call(this),this.unattachForm=_.call(this),this.updateStylesheets=N.call(this),this.log.log("Pjax options",this.options),this.maxUid=this.lastUid=this.oUtilities.newUid(),this.parseDOM(document),p(window,"popstate",(function(t){if(o.log.log("OPT -> ",t),t.state){var e=o.oUtilities.clone(o.options);e.url=t.state.url,e.title=t.state.title,e.history=!1,e.requestOptions={},o.log.log("OPT -> ",e),o.log.log("State UID",t.state.uid),o.log.log("lastUID",o.lastUid),t.state.uid<o.lastUid?e.backward=!0:e.forward=!0,o.lastUid=t.state.uid,o.loadUrl(t.state.url,e)}})),this}return o(t,[{key:"forEachSelectors",value:function(t,e,n){return this.oDomUtils.foreachSelectors(this.options.selectors,t,e,n)}},{key:"switchSelectors",value:function(t,e,n,o){return v.call(this)(this.options.switches,this.options.switchesOptions,t,e,n,o)}},{key:"latestChance",value:function(t){return window.location.href=t,!1}},{key:"onSwitch",value:function(){w(window,"resize scroll")}},{key:"loadContent",value:function(t,e){var n=this,o=U.apply(this),i=window.document.implementation.createHTMLDocument("pjax"),s=[Promise.resolve("basic resolve")],r=t.match(/<html[^>]+>/gi);r&&r.length&&(r=r[0].match(/\s?[a-z:]+(?:=(?:'|")[^'">]+(?:'|"))*/gi)).length&&(r.shift(),r.forEach((function(t){var e=t.trim().split("=");1===e.length?i.documentElement.setAttribute(e[0],!0):i.documentElement.setAttribute(e[0],e[1].slice(1,-1))})));var a=null;try{a=JSON.parse(t)}catch(t){this.log.warn("No JSON found. If you expected it there was an error")}if(i.documentElement.innerHTML=t,this.log.log("load content",i.documentElement.attributes,i.documentElement.innerHTML.length),null!==a&&(this.log.log("found JSON document",a),this.options.onJsonDocument.call(this,a)),window.document.activeElement&&!window.document.activeElement.value)try{window.document.activeElement.blur()}catch(t){}this.switchSelectors(this.options.selectors,i,document,e),!0===this.options.reRenderCSS&&this.updateStylesheets(i.querySelectorAll("link[rel=stylesheet]"),document.querySelectorAll("link[rel=stylesheet]"));var l=Array.prototype.slice.call(document.querySelectorAll("[autofocus]")).pop();l&&document.activeElement!==l&&l.focus(),this.options.selectors.forEach((function(t){n.oUtilities.forEachEls(document.querySelectorAll(t),(function(t){s.push.apply(s,o(t))}),n)})),this.log.log("waiting for scriptcomplete",s);var c=null;c=window.setTimeout((function(){w(document,"pjax:scriptcomplete pjax:scripttimeout",e),c=null}),this.options.scriptloadtimeout),Promise.all(s).then((function(){null!==c&&(window.clearTimeout(c),w(document,"pjax:scriptcomplete pjax:scriptsuccess",e))}),(function(){null!==c&&(window.clearTimeout(c),w(document,"pjax:scriptcomplete pjax:scripterror",e))}))}},{key:"loadUrl",value:function(t,e){var n=this;this.log.log("load href",t,e),w(document,"pjax:send",e),this.doRequest(t,e.requestOptions,(function(o,i){if(!1===o||200!==i.status)return w(document,"pjax:complete pjax:error",{options:e,requestData:i,href:t}),e.pjaxErrorHandler(t,e,i);document.activeElement.blur();try{n.loadContent(o,e)}catch(o){if(n.options.debug){if(n.options.forceRedirectOnFail)return e.pjaxErrorHandler(t,e,i)||n.latestChance(t);throw o}return console&&n.options.logObject.error&&n.options.logObject.error("Pjax switch fail: ",o),e.pjaxErrorHandler(t,e,i)||n.latestChance(t)}e.history&&(n.firstrun&&(n.lastUid=n.maxUid=n.oUtilities.newUid(),n.firstrun=!1,window.history.replaceState({url:window.location.href,title:document.title,uid:n.maxUid},document.title)),n.lastUid=n.maxUid=n.oUtilities.newUid(),window.history.pushState({url:t,title:e.title,uid:n.maxUid},e.title,t)),n.forEachSelectors((function(t){return n.parseDOM(t)})),w(document,"pjax:complete pjax:success",e),e.analytics(),!1!==e.scrollTo&&(e.scrollTo.length>1?window.scrollTo(e.scrollTo[0],e.scrollTo[1]):window.scrollTo(0,e.scrollTo))}))}}]),t}();if(!u()){console.warn("Pjax not supported");var n=function(){};for(var i in t.prototype)i in t.prototype&&"function"==typeof t.prototype[i]&&(n[i]=n);return n}return t}}));"use strict";var switchOuterHTML=function(t,e,n){n=n||{};var o=$(t).parent();$(t).off().remove(),o.append(e),this.onSwitch()},switchInnerHTML=function(t,e,n){n=n||{};$(t).parent();$(t).off().html(""),$(t).html($(e).html()),this.onSwitch()},singletonPjax=function(){return window.activePjax=window.activePjax||null,null===window.activePjax&&(console.ls.log("creating a Pjax instance on the window object"),window.activePjax=new Pjax({elements:["a.pjax","form.pjax"],selectors:["#pjax-content","#breadcrumb-container","#bottomScripts","#beginScripts"],debug:window.debugState.backend,forceRedirectOnFail:!0,reRenderCSS:!0,scriptloadtimeout:1500})),window.activePjax},forceRefreshPjax=function(){window.activePjax=null,singletonPjax()},unsetPjax=function(){window.activePjax.parseDOMtoUnload(),$("a.pjax").off("click"),window.activePjax=null},triggerLoadUrl=function(t,e){singletonPjax().loadUrl(e.url,singletonPjax().options)},reparseDocument=function(){singletonPjax().parseDOM(document)};window.singletonPjax=singletonPjax,$(document).off("pjax:reload"),$(document).off("pjax:create"),$(document).off("pjax:refresh"),$(document).off("pjax:load"),$(document).off("pjax:unload"),$(document).on("pjax:reload",forceRefreshPjax),$(document).on("pjax:create",singletonPjax),$(document).on("pjax:refresh",reparseDocument),$(document).on("pjax:load",triggerLoadUrl),$(document).on("pjax:unload",unsetPjax);