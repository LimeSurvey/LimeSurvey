!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Pjax=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){var clone=require("./lib/clone.js"),executeScripts=require("./lib/execute-scripts.js"),forEachEls=require("./lib/foreach-els.js"),newUid=require("./lib/uniqueid.js"),on=require("./lib/events/on.js"),trigger=require("./lib/events/trigger.js"),Pjax=function(options){return this.firstrun=!0,require("./lib/proto/parse-options.js").apply(this,[options]),this.log("Pjax options",this.options),this.maxUid=this.lastUid=newUid(),this.parseDOM(document),on(window,"popstate",function(st){if(st.state){var opt=clone(this.options);opt.url=st.state.url,opt.title=st.state.title,opt.history=!1,opt.requestOptions={},st.state.uid<this.lastUid?opt.backward=!0:opt.forward=!0,this.lastUid=st.state.uid,this.loadUrl(st.state.url,opt)}}.bind(this)),this};if(Pjax.prototype={log:require("./lib/proto/log.js"),getElements:require("./lib/proto/get-elements.js"),parseDOM:require("./lib/proto/parse-dom.js"),parseDOMtoUnload:require("./lib/proto/parse-dom-unload.js"),refresh:require("./lib/proto/refresh.js"),reload:require("./lib/reload.js"),attachLink:require("./lib/proto/attach-link.js"),attachForm:require("./lib/proto/attach-form.js"),unattachLink:require("./lib/proto/unattach-link.js"),unattachForm:require("./lib/proto/unattach-form.js"),updateStylesheets:require("./lib/update-stylesheets.js"),forEachSelectors:function(cb,context,DOMcontext){return require("./lib/foreach-selectors.js").bind(this)(this.options.selectors,cb,context,DOMcontext)},switchSelectors:function(selectors,fromEl,toEl,options){return require("./lib/switches-selectors.js").bind(this)(this.options.switches,this.options.switchesOptions,selectors,fromEl,toEl,options)},latestChance:function(href){window.location=href},onSwitch:function(){trigger(window,"resize scroll")},loadContent:function(html,options){var tmpEl=document.implementation.createHTMLDocument("pjax"),collectForScriptcomplete=[Promise.resolve("basic resolve")],matches=html.match(/<html[^>]+>/gi);matches&&matches.length&&(matches=matches[0].match(/\s?[a-z:]+(?:\=(?:\'|\")[^\'\">]+(?:\'|\"))*/gi)).length&&(matches.shift(),matches.forEach(function(htmlAttrib){var attr=htmlAttrib.trim().split("=");1===attr.length?tmpEl.documentElement.setAttribute(attr[0],!0):tmpEl.documentElement.setAttribute(attr[0],attr[1].slice(1,-1))})),jsonContent=null;try{jsonContent=JSON.parse(html)}catch(e){}if(tmpEl.documentElement.innerHTML=html,this.log("load content",tmpEl.documentElement.attributes,tmpEl.documentElement.innerHTML.length),null!==jsonContent&&(this.log("found JSON document",jsonContent),this.options.onJsonDocument(jsonContent)),document.activeElement&&!document.activeElement.value)try{document.activeElement.blur()}catch(e){}this.switchSelectors(this.options.selectors,tmpEl,document,options),!0===this.options.reRenderCSS&&this.updateStylesheets.call(this,tmpEl.querySelectorAll("link[rel=stylesheet]"),document.querySelectorAll("link[rel=stylesheet]"));var autofocusEl=Array.prototype.slice.call(document.querySelectorAll("[autofocus]")).pop();autofocusEl&&document.activeElement!==autofocusEl&&autofocusEl.focus(),this.options.selectors.forEach(function(selector){forEachEls(document.querySelectorAll(selector),function(el){collectForScriptcomplete.push.apply(collectForScriptcomplete,executeScripts.call(this,el))},this)},this),this.log("waiting for scriptcomplete",collectForScriptcomplete);var timeOutScriptEvent=null;timeOutScriptEvent=window.setTimeout(function(){trigger(document,"pjax:scriptcomplete pjax:scripttimeout",options),timeOutScriptEvent=null},this.options.scriptloadtimeout),Promise.all(collectForScriptcomplete).then(function(){null!==timeOutScriptEvent&&(window.clearTimeout(timeOutScriptEvent),trigger(document,"pjax:scriptcomplete pjax:scriptsuccess",options))},function(){null!==timeOutScriptEvent&&(window.clearTimeout(timeOutScriptEvent),trigger(document,"pjax:scriptcomplete pjax:scripterror",options))})},doRequest:require("./lib/request.js"),loadUrl:function(href,options){this.log("load href",href,options),trigger(document,"pjax:send",options),this.doRequest(href,options.requestOptions,function(html){if(!1!==html){document.activeElement.blur();try{this.loadContent(html,options)}catch(e){if(this.options.debug)throw this.options.forceRedirectOnFail&&this.latestChance(href),e;return console&&this.options.logObject.error&&this.options.logObject.error("Pjax switch fail: ",e),void this.latestChance(href)}options.history&&(this.firstrun&&(this.lastUid=this.maxUid=newUid(),this.firstrun=!1,window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid},document.title)),this.lastUid=this.maxUid=newUid(),window.history.pushState({url:href,title:options.title,uid:this.maxUid},options.title,href)),this.forEachSelectors(function(el){this.parseDOM(el)},this),trigger(document,"pjax:complete pjax:success",options),options.analytics(),!1!==options.scrollTo&&(1<options.scrollTo.length?window.scrollTo(options.scrollTo[0],options.scrollTo[1]):window.scrollTo(0,options.scrollTo))}else trigger(document,"pjax:complete pjax:error",options)}.bind(this))}},Pjax.isSupported=require("./lib/is-supported.js"),Pjax.isSupported())module.exports=Pjax;else{var stupidPjax=function(){};for(var key in Pjax.prototype)Pjax.prototype.hasOwnProperty(key)&&"function"==typeof Pjax.prototype[key]&&(stupidPjax[key]=stupidPjax);module.exports=stupidPjax}},{"./lib/clone.js":2,"./lib/events/on.js":5,"./lib/events/trigger.js":6,"./lib/execute-scripts.js":7,"./lib/foreach-els.js":8,"./lib/foreach-selectors.js":9,"./lib/is-supported.js":10,"./lib/proto/attach-form.js":12,"./lib/proto/attach-link.js":13,"./lib/proto/get-elements.js":14,"./lib/proto/log.js":15,"./lib/proto/parse-dom-unload.js":16,"./lib/proto/parse-dom.js":17,"./lib/proto/parse-options.js":20,"./lib/proto/refresh.js":21,"./lib/proto/unattach-form.js":22,"./lib/proto/unattach-link.js":23,"./lib/reload.js":24,"./lib/request.js":25,"./lib/switches-selectors.js":26,"./lib/uniqueid.js":28,"./lib/update-stylesheets.js":29}],2:[function(require,module,exports){module.exports=function(obj){if(null===obj||"object"!=typeof obj)return obj;var copy=obj.constructor();for(var attr in obj)obj.hasOwnProperty(attr)&&(copy[attr]=obj[attr]);return copy}},{}],3:[function(require,module,exports){module.exports=function(el){var promise,querySelector=this.options.mainScriptElement,code=el.text||el.textContent||el.innerHTML||"",src=el.src||"",parent=el.parentNode||document.querySelector(querySelector)||document.documentElement,script=document.createElement("script");return this.log("Evaluating Script: ",el),code.match("document.write")?(console&&this.options.logObject.log&&this.options.logObject.log("Script contains document.write. Can’t be executed correctly. Code skipped ",el),!1):(promise=new Promise(function(resolve,reject){if(script.type="text/javascript",""!=src&&(script.src=src,script.addEventListener("load",function(){resolve(src)}),script.async=!0),""!=code){try{script.appendChild(document.createTextNode(code))}catch(e){script.text=code}resolve("text-node")}}),this.log("ParentElement => ",parent),parent.appendChild(script),parent.removeChild(script),0<["head","body"].indexOf(parent.tagName.toLowerCase())||this.options.removeScriptsAfterParsing,promise)}},{}],4:[function(require,module,exports){var forEachEls=require("../foreach-els");module.exports=function(els,events,listener,useCapture){(events="string"==typeof events?events.split(" "):events).forEach(function(e){forEachEls(els,function(el){el.removeEventListener(e,listener,useCapture)})})}},{"../foreach-els":8}],5:[function(require,module,exports){var forEachEls=require("../foreach-els");module.exports=function(els,events,listener,useCapture){(events="string"==typeof events?events.split(" "):events).forEach(function(e){forEachEls(els,function(el){el.addEventListener(e,listener,useCapture)})})}},{"../foreach-els":8}],6:[function(require,module,exports){var forEachEls=require("../foreach-els");module.exports=function(els,events,opts){(events="string"==typeof events?events.split(" "):events).forEach(function(e){var event;(event=document.createEvent("HTMLEvents")).initEvent(e,!0,!0),event.eventName=e,opts&&Object.keys(opts).forEach(function(key){event[key]=opts[key]}),forEachEls(els,function(el){var domFix=!1;el.parentNode||el===document||el===window||(domFix=!0,document.body.appendChild(el)),el.dispatchEvent(event),domFix&&el.parentNode.removeChild(el)})})}},{"../foreach-els":8}],7:[function(require,module,exports){var forEachEls=require("./foreach-els"),evalScript=require("./eval-script");module.exports=function(el){this.log("Executing scripts for ",el);var loadingScripts=[];return void 0===el?Promise.resolve():("script"===el.tagName.toLowerCase()&&evalScript.call(this,el),forEachEls(el.querySelectorAll("script"),function(script){script.type&&"text/javascript"!==script.type.toLowerCase()||loadingScripts.push(evalScript.call(this,script))},this),loadingScripts)}},{"./eval-script":3,"./foreach-els":8}],8:[function(require,module,exports){module.exports=function(els,fn,context){return els instanceof HTMLCollection||els instanceof NodeList||els instanceof Array?Array.prototype.forEach.call(els,fn,context):fn.call(context,els)}},{}],9:[function(require,module,exports){var forEachEls=require("./foreach-els");module.exports=function(selectors,cb,context,DOMcontext){DOMcontext=DOMcontext||document,selectors.forEach(function(selector){forEachEls(DOMcontext.querySelectorAll(selector),cb,context)})}},{"./foreach-els":8}],10:[function(require,module,exports){module.exports=function(){return window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/)}},{}],11:[function(require,module,exports){Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),that=this,Fnoop=function(){},fBound=function(){return that.apply(this instanceof Fnoop&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return Fnoop.prototype=this.prototype,fBound.prototype=new Fnoop,fBound})},{}],12:[function(require,module,exports){require("../polyfills/Function.prototype.bind");var on=require("../events/on"),clone=require("../clone"),attrClick="data-pjax-submit-state";module.exports=function(el){var that=this;on(el,"submit",function(event){(function(event){return event.defaultPrevented||!1===event.returnValue})(event)||function(el,event){this.options.requestOptions={requestUrl:el.getAttribute("action")||window.location.href,requestMethod:el.getAttribute("method")||"GET"};var virtLinkElement=document.createElement("a");if(virtLinkElement.setAttribute("href",this.options.requestOptions.requestUrl),virtLinkElement.protocol===window.location.protocol&&virtLinkElement.host===window.location.host)if(virtLinkElement.pathname===window.location.pathname&&0<virtLinkElement.hash.length)el.setAttribute(attrClick,"anchor-present");else if(virtLinkElement.href!==window.location.href.split("#")[0]+"#")if(this.options.currentUrlFullReload)el.setAttribute(attrClick,"reload");else{event.preventDefault();var nameList=[],paramObject=[];for(var elementKey in el.elements){var element=el.elements[elementKey];element.name&&void 0!==element.attributes&&"button"!==element.tagName.toLowerCase()&&("checkbox"!==element.type&&"radio"!==element.type||element.checked)&&-1===nameList.indexOf(element.name)&&(nameList.push(element.name),paramObject.push({name:encodeURIComponent(element.name),value:encodeURIComponent(element.value)}))}var paramsString=paramObject.map(function(value){return value.name+"="+value.value}).join("&");this.options.requestOptions.requestPayload=paramObject,this.options.requestOptions.requestPayloadString=paramsString,el.setAttribute(attrClick,"submit"),this.loadUrl(virtLinkElement.href,clone(this.options))}else el.setAttribute(attrClick,"anchor-empty");else el.setAttribute(attrClick,"external")}.call(that,el,event)})}},{"../clone":2,"../events/on":5,"../polyfills/Function.prototype.bind":11}],13:[function(require,module,exports){require("../polyfills/Function.prototype.bind");var on=require("../events/on"),clone=require("../clone"),attrClick="data-pjax-click-state",linkAction=function(el,event){if(1<event.which||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey)el.setAttribute(attrClick,"modifier");else if(el.protocol===window.location.protocol&&el.host===window.location.host)if(el.pathname===window.location.pathname&&0<el.hash.length)el.setAttribute(attrClick,"anchor-present");else if(el.hash&&el.href.replace(el.hash,"")===window.location.href.replace(location.hash,""))el.setAttribute(attrClick,"anchor");else if(el.href!==window.location.href.split("#")[0]+"#"){if(event.preventDefault(),this.options.currentUrlFullReload&&el.href===window.location.href.split("#")[0])return el.setAttribute(attrClick,"reload"),void this.reload();this.options.requestOptions=this.options.requestOptions||{},el.setAttribute(attrClick,"load"),this.loadUrl(el.href,clone(this.options))}else el.setAttribute(attrClick,"anchor-empty");else el.setAttribute(attrClick,"external")},isDefaultPrevented=function(event){return event.defaultPrevented||!1===event.returnValue};module.exports=function(el){var that=this;on(el,"click",function(event){isDefaultPrevented(event)||linkAction.call(that,el,event)}),on(el,"keyup",function(event){isDefaultPrevented(event)||(1<event.which||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey?el.setAttribute("data-pjax-keyup-state","modifier"):13==event.keyCode&&linkAction.call(that,el,event))}.bind(this))}},{"../clone":2,"../events/on":5,"../polyfills/Function.prototype.bind":11}],14:[function(require,module,exports){module.exports=function(el){return el.querySelectorAll(this.options.elements)}},{}],15:[function(require,module,exports){module.exports=function(){this.options.debug&&this.options.logObject&&("function"==typeof this.options.logObject.log?this.options.logObject.log.apply(this.options.logObject,["PJAX ->",arguments]):this.options.logObject.log&&this.options.logObject.log(["PJAX ->",arguments]))}},{}],16:[function(require,module,exports){var forEachEls=require("../foreach-els"),parseElementUnload=require("./parse-element-unload");module.exports=function(el){forEachEls(this.getElements(el),parseElementUnload,this)}},{"../foreach-els":8,"./parse-element-unload":18}],17:[function(require,module,exports){var forEachEls=require("../foreach-els"),parseElement=require("./parse-element");module.exports=function(el){forEachEls(this.getElements(el),parseElement,this)}},{"../foreach-els":8,"./parse-element":19}],18:[function(require,module,exports){module.exports=function(el){switch(el.tagName.toLowerCase()){case"a":el.hasAttribute("data-pjax-click-state")||this.unattachLink(el);break;case"form":el.hasAttribute("data-pjax-click-state")||this.unattachForm(el);break;default:throw"Pjax can only be applied on <a> or <form> submit"}}},{}],19:[function(require,module,exports){module.exports=function(el){switch(el.tagName.toLowerCase()){case"a":el.hasAttribute("data-pjax-click-state")||this.attachLink(el);break;case"form":el.hasAttribute("data-pjax-click-state")||this.attachForm(el);break;default:throw"Pjax can only be applied on <a> or <form> submit"}}},{}],20:[function(require,module,exports){module.exports=function(options){this.options=options,this.options.elements=this.options.elements||"a[href], form[action]",this.options.reRenderCSS=this.options.reRenderCSS||!1,this.options.forceRedirectOnFail=this.options.forceRedirectOnFail||!1,this.options.scriptloadtimeout=this.options.scriptloadtimeout||1e3,this.options.mainScriptElement=this.options.mainScriptElement||"head",this.options.removeScriptsAfterParsing=this.options.removeScriptsAfterParsing||!0,this.options.logObject=this.options.logObject||console,this.options.selectors=this.options.selectors||["title",".js-Pjax"],this.options.switches=this.options.switches||{},this.options.switchesOptions=this.options.switchesOptions||{},this.options.history=this.options.history||!0,this.options.onDomDiffers=this.options.onDomDiffers||function(oldDom,newDom){return!0},this.options.onJsonDocument=this.options.onJsonDocument||function(jsonDocument){return!0},this.options.analytics=this.options.analytics||function(){window._gaq&&_gaq.push(["_trackPageview"]),window.ga&&ga("send","pageview",{page:location.pathname,title:document.title})},this.options.scrollTo=void 0===this.options.scrollTo?0:this.options.scrollTo,this.options.cacheBust=void 0===this.options.cacheBust||this.options.cacheBust,this.options.debug=this.options.debug||!1,this.options.switches.head||(this.options.switches.head=this.switchElementsAlt),this.options.switches.body||(this.options.switches.body=this.switchElementsAlt),"function"!=typeof options.analytics&&(options.analytics=function(){})}},{}],21:[function(require,module,exports){module.exports=function(el){this.parseDOM(el||document)}},{}],22:[function(require,module,exports){require("../polyfills/Function.prototype.bind");var off=require("../events/off"),clone=require("../clone"),attrClick="data-pjax-click-state",formAction=function(el,event){this.options.requestOptions={requestUrl:el.getAttribute("action")||window.location.href,requestMethod:el.getAttribute("method")||"GET"};var virtLinkElement=document.createElement("a");if(virtLinkElement.setAttribute("href",this.options.requestOptions.requestUrl),virtLinkElement.protocol===window.location.protocol&&virtLinkElement.host===window.location.host)if(virtLinkElement.pathname===window.location.pathname&&0<virtLinkElement.hash.length)el.setAttribute(attrClick,"anchor-present");else if(virtLinkElement.href!==window.location.href.split("#")[0]+"#")if(this.options.currentUrlFullReload)el.setAttribute(attrClick,"reload");else{event.preventDefault();var nameList=[],paramObject=[];for(var elementKey in el.elements){var element=el.elements[elementKey];element.name&&void 0!==element.attributes&&"button"!==element.tagName.toLowerCase()&&("checkbox"!==element.type&&"radio"!==element.type||element.checked)&&-1===nameList.indexOf(element.name)&&(nameList.push(element.name),paramObject.push({name:encodeURIComponent(element.name),value:encodeURIComponent(element.value)}))}var paramsString=paramObject.map(function(value){return value.name+"="+value.value}).join("&");this.options.requestOptions.requestPayload=paramObject,this.options.requestOptions.requestPayloadString=paramsString,el.setAttribute(attrClick,"submit"),this.loadUrl(virtLinkElement.href,clone(this.options))}else el.setAttribute(attrClick,"anchor-empty");else el.setAttribute(attrClick,"external")},isDefaultPrevented=function(event){return event.defaultPrevented||!1===event.returnValue};module.exports=function(el){var that=this;off(el,"submit",function(event){isDefaultPrevented(event)||formAction.call(that,el,event)}),off(el,"keyup",function(event){isDefaultPrevented(event)||13==event.keyCode&&formAction.call(that,el,event)}.bind(this))}},{"../clone":2,"../events/off":4,"../polyfills/Function.prototype.bind":11}],23:[function(require,module,exports){require("../polyfills/Function.prototype.bind");var off=require("../events/off"),clone=require("../clone"),attrClick="data-pjax-click-state",linkAction=function(el,event){if(1<event.which||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey)el.setAttribute(attrClick,"modifier");else if(el.protocol===window.location.protocol&&el.host===window.location.host)if(el.pathname===window.location.pathname&&0<el.hash.length)el.setAttribute(attrClick,"anchor-present");else if(el.hash&&el.href.replace(el.hash,"")===window.location.href.replace(location.hash,""))el.setAttribute(attrClick,"anchor");else if(el.href!==window.location.href.split("#")[0]+"#"){if(event.preventDefault(),this.options.currentUrlFullReload&&el.href===window.location.href.split("#")[0])return el.setAttribute(attrClick,"reload"),void this.reload();this.options.requestOptions=this.options.requestOptions||{},el.setAttribute(attrClick,"load"),this.loadUrl(el.href,clone(this.options))}else el.setAttribute(attrClick,"anchor-empty");else el.setAttribute(attrClick,"external")},isDefaultPrevented=function(event){return event.defaultPrevented||!1===event.returnValue};module.exports=function(el){var that=this;off(el,"click",function(event){isDefaultPrevented(event)||linkAction.call(that,el,event)}),off(el,"keyup",function(event){isDefaultPrevented(event)||(1<event.which||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey?el.setAttribute("data-pjax-keyup-state","modifier"):13==event.keyCode&&linkAction.call(that,el,event))}.bind(this))}},{"../clone":2,"../events/off":4,"../polyfills/Function.prototype.bind":11}],24:[function(require,module,exports){module.exports=function(){window.location.reload()}},{}],25:[function(require,module,exports){module.exports=function(location,options,callback){var requestMethod=(options=options||{}).requestMethod||"GET",requestPayload=options.requestPayloadString||null,request=new XMLHttpRequest;return request.onreadystatechange=function(){4===request.readyState&&(200===request.status?callback(request.responseText,request):callback(null,request))},this.options.cacheBust&&(location+=(/[?&]/.test(location)?"&":"?")+(new Date).getTime()),request.open(requestMethod.toUpperCase(),location,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!=options.requestPayloadString&&""!=options.requestPayloadString&&request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),request.send(requestPayload),request}},{}],26:[function(require,module,exports){var forEachEls=require("./foreach-els"),defaultSwitches=require("./switches");module.exports=function(switches,switchesOptions,selectors,fromEl,toEl,options){selectors.forEach(function(selector){var newEls=fromEl.querySelectorAll(selector),oldEls=toEl.querySelectorAll(selector);if((this.log&&this.log("Pjax switch",selector,newEls,oldEls),newEls.length!==oldEls.length)&&options.onDomDiffers(toEl,fromEl))throw"DOM doesn’t look the same on new loaded page: ’"+selector+"’ - new "+newEls.length+", old "+oldEls.length;forEachEls(newEls,function(newEl,i){var oldEl=oldEls[i];this.log&&this.log("newEl",newEl,"oldEl",oldEl),switches[selector]?switches[selector].bind(this)(oldEl,newEl,options,switchesOptions[selector]):defaultSwitches.outerHTML.bind(this)(oldEl,newEl,options)},this)},this)}},{"./foreach-els":8,"./switches":27}],27:[function(require,module,exports){var on=require("./events/on.js");module.exports={outerHTML:function(oldEl,newEl){oldEl.outerHTML=newEl.outerHTML,this.onSwitch()},innerHTML:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML,oldEl.className=newEl.className,this.onSwitch()},sideBySide:function(oldEl,newEl,options,switchOptions){var forEach=Array.prototype.forEach,elsToRemove=[],elsToAdd=[],fragToAppend=document.createDocumentFragment(),animationEventNames="animationend webkitAnimationEnd MSAnimationEnd oanimationend",animatedElsNumber=0,sexyAnimationEnd=function(e){e.target==e.currentTarget&&--animatedElsNumber<=0&&elsToRemove&&(elsToRemove.forEach(function(el){el.parentNode&&el.parentNode.removeChild(el)}),elsToAdd.forEach(function(el){el.className=el.className.replace(el.getAttribute("data-pjax-classes"),""),el.removeAttribute("data-pjax-classes")}),elsToRemove=elsToAdd=null,this.onSwitch())}.bind(this);switchOptions=switchOptions||{},forEach.call(oldEl.childNodes,function(el){elsToRemove.push(el),el.classList&&!el.classList.contains("js-Pjax-remove")&&(el.hasAttribute("data-pjax-classes")&&(el.className=el.className.replace(el.getAttribute("data-pjax-classes"),""),el.removeAttribute("data-pjax-classes")),el.classList.add("js-Pjax-remove"),switchOptions.callbacks&&switchOptions.callbacks.removeElement&&switchOptions.callbacks.removeElement(el),switchOptions.classNames&&(el.className+=" "+switchOptions.classNames.remove+" "+(options.backward?switchOptions.classNames.backward:switchOptions.classNames.forward)),animatedElsNumber++,on(el,animationEventNames,sexyAnimationEnd,!0))}),forEach.call(newEl.childNodes,function(el){if(el.classList){var addClasses="";switchOptions.classNames&&(addClasses=" js-Pjax-add "+switchOptions.classNames.add+" "+(options.backward?switchOptions.classNames.forward:switchOptions.classNames.backward)),switchOptions.callbacks&&switchOptions.callbacks.addElement&&switchOptions.callbacks.addElement(el),el.className+=addClasses,el.setAttribute("data-pjax-classes",addClasses),elsToAdd.push(el),fragToAppend.appendChild(el),animatedElsNumber++,on(el,animationEventNames,sexyAnimationEnd,!0)}}),oldEl.className=newEl.className,oldEl.appendChild(fragToAppend)}}},{"./events/on.js":5}],28:[function(require,module,exports){var counter;module.exports=(counter=0,function(){var id="pjax"+(new Date).getTime()+"_"+counter;return counter++,id})},{}],29:[function(require,module,exports){var forEachEls=require("./foreach-els");module.exports=function(elements,oldElements){this.log("styleheets old elements",oldElements),this.log("styleheets new elements",elements);forEachEls(elements,function(newEl,i){if(null!==function(enumerable){for(var arr=[],i=enumerable.length;i--;arr.unshift(enumerable[i]));return arr}(oldElements).reduce(function(acc,oldEl){return acc=oldEl.href===newEl.href?oldEl:acc},null))this.log&&this.log("old stylesheet found not resetting");else{this.log&&this.log("new stylesheet => add to head");var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.setAttribute("href",newEl.href),link.setAttribute("rel","stylesheet"),link.setAttribute("type","text/css"),head.appendChild(link)}},this)}},{"./foreach-els":8}]},{},[1])(1)});
