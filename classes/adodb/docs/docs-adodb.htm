<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>ADODB Manual</title>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

	
<style>
pre {
  background-color: #eee;
  padding: 0.75em 1.5em;
  font-size: 12px;
  border: 1px solid #ddd;
}
</style></head>
<body bgcolor="#ffffff" text="black">

<h2>ADOdb Library for PHP</h2>
<p>V4.94 23 Jan 2007 (c) 2000-2007 John Lim (jlim#natsoft.com)</p>
<p><font size="1">This software is dual licensed using BSD-Style and LGPL. This 
  means you can use it in compiled proprietary and commercial products.</font></p>
  

	<p>Useful ADOdb links:  <a href="http://adodb.sourceforge.net/#download">Download</a> &nbsp; <a href="http://adodb.sourceforge.net/#docs">Other Docs</a>

</p><p><a href="#intro"><b>Introduction</b></a><b><br>
	<a href="#features">Unique Features</a><br>
	<a href="#users">How People are using ADOdb</a><br>
	<a href="#bugs">Feature Requests and Bug Reports</a><br>
	</b><b><a href="#install">Installation</a><br>
	<a href="#mininstall">Minimum Install</a><br>
	<a href="#coding">Initializing Code and Connectioning to Databases</a><br>
	</b><font size="2"> &nbsp; <a href="#dsnsupport">Data Source Name (DSN) Support</a></font>  &nbsp;  <a href="#connect_ex">Connection Examples</a> <br>
	<b><a href="#speed">High Speed ADOdb - tuning tips</a></b><br>
	<b><a href="#hack">Hacking and Modifying ADOdb Safely</a><br>
	<a href="#php5">PHP5 Features</a></b><br>
	<font size="2"><a href="#php5iterators">foreach iterators</a> <a href="#php5exceptions">exceptions</a></font><br>
	<b> <a href="#drivers">Supported Databases</a></b><br>
	<b> <a href="#quickstart">Tutorials</a></b><br>
	<a href="#ex1">Example 1: Select</a><br>
	<a href="#ex2">Example 2: Advanced Select</a><br>
	<a href="#ex3">Example 3: Insert</a><br>
	<a href="#ex4">Example 4: Debugging</a> &nbsp;<a href="#exrs2html">rs2html 
	example</a><br>
	<a href="#ex5">Example 5: MySQL and Menus</a><br>
	<a href="#ex6">Example 6: Connecting to Multiple Databases at once</a> <br>
	<a href="#ex7">Example 7: Generating Update and Insert SQL</a> <br>
	<a href="#ex8">Example 8: Implementing Scrolling with Next and Previous</a><br>
	<a href="#ex9">Example 9: Exporting in CSV or Tab-Delimited Format</a> <br>
	<a href="#ex10">Example 10: Custom filters</a><br>
	<a href="#ex11">Example 11: Smart Transactions</a><br>
	<br>
	<b> <a href="#errorhandling">Using Custom Error Handlers and PEAR_Error</a><br>
	<a href="#DSN">Data Source Names</a><br>
	<a href="#caching">Caching</a><br>
	<a href="#pivot">Pivot Tables</a></b> 
</p><p><a href="#ref"><b>REFERENCE</b></a>
</p><p> <font size="2">Variables: <a href="#adodb_countrecs">$ADODB_COUNTRECS</a> 
<a href="#adodb_ansi_padding_off">$ADODB_ANSI_PADDING_OFF</a>
  <a href="#adodb_cache_dir">$ADODB_CACHE_DIR</a> <br>
  &nbsp; &nbsp; &nbsp; &nbsp;  <a href="#force_type">$ADODB_FORCE_TYPE</a> 
  <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> 
  <a href="#adodb_lang">$ADODB_LANG</a> <a href=#adodb_auto_quote>ADODB_QUOTE_FIELDNAMES</a> <br>
  Constants: </font><font size="2"><a href="#adodb_assoc_case">ADODB_ASSOC_CASE</a> 
  </font><br>
  <a href="#ADOConnection"><b> ADOConnection</b></a><br>
  <font size="2">Connections: <a href="#connect">Connect</a> <a href="#pconnect">PConnect</a> 
  <a href="#nconnect">NConnect</a> <a href="#isconnected">IsConnected</a><br>
  Executing SQL: <a href="#execute">Execute</a> <a href="#cacheexecute"><i>CacheExecute</i></a> 
  <a href="#selectlimit">SelectLimit</a> <a href="#cacheSelectLimit"><i>CacheSelectLimit</i></a> 
  <a href="#param">Param</a> <a href="#prepare">Prepare</a> <a href="#preparesp">PrepareSP</a> 
  <a href="#inparameter">InParameter</a> <a href="#outparameter">OutParameter</a> <a href="#autoexecute">AutoExecute</a>
  <br>
  &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#getone">GetOne</a> 
  <a href="#cachegetone"><i>CacheGetOne</i></a> <a href="#getrow">GetRow</a> <a href="#cachegetrow"><i>CacheGetRow</i></a> 
  <a href="#getall">GetAll</a> <a href="#cachegetall"><i>CacheGetAll</i></a> <a href="#getcol">GetCol</a> 
  <a href="#cachegetcol"><i>CacheGetCol</i></a> <a href="#getassoc1">GetAssoc</a> <a href="#cachegetassoc"><i>CacheGetAssoc</i></a> <a href="#replace">Replace</a> 
  <br>
  &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#executecursor">ExecuteCursor</a> 
  (oci8 only)<br>
  Generates SQL strings: <a href="#getupdatesql">GetUpdateSQL</a> <a href="#getinsertsql">GetInsertSQL</a> 
  <a href="#concat">Concat</a> <a href="#ifnull">IfNull</a> <a href="#length">length</a> <a href="#random">random</a> <a href="#substr">substr</a> 
  <a href="#qstr">qstr</a> <a href="#param">Param</a>  <a href="#OffsetDate">OffsetDate</a> <a href="#sqldate">SQLDate</a> 
  <a href="#dbdate">DBDate</a>  <a href="#dbtimestamp">DBTimeStamp</a>
  <a href="#binddate">BindDate</a>  <a href="#bindtimestamp">BindTimeStamp</a>
  <br>
  Blobs: <a href="#updateblob">UpdateBlob</a> <a href="#updateclob">UpdateClob</a> 
  <a href="#updateblobfile">UpdateBlobFile</a> <a href="#blobencode">BlobEncode</a> 
  <a href="#blobdecode">BlobDecode</a><br>
  Paging/Scrolling: <a href="#pageexecute">PageExecute</a> <a href="#cachepageexecute">CachePageExecute</a><br>
  Cleanup: <a href="#cacheflush">CacheFlush</a> <a href="#Close">Close</a><br>
  Transactions: <a href="#starttrans">StartTrans</a> <a href="#completetrans">CompleteTrans</a> 
  <a href="#failtrans">FailTrans</a> <a href="#hasfailedtrans">HasFailedTrans</a> 
  <a href="#begintrans">BeginTrans</a> <a href="#committrans">CommitTrans</a> 
  <a href="#rollbacktrans">RollbackTrans</a> <a href=#SetTransactionMode>SetTransactionMode</a><br>
  Fetching Data: </font> <font size="2"><a href="#setfetchmode">SetFetchMode</a><br>
  Strings: <a href="#concat">concat</a> <a href="#length">length</a>  <a href="#qstr">qstr</a> <a href="#quote">quote</a> <a href="#substr">substr</a><br>
  Dates: <a href="#dbdate">DBDate</a> <a href="#dbtimestamp">DBTimeStamp</a> <a href="#unixdate">UnixDate</a> 
  <a href="#binddate">BindDate</a>  <a href="#bindtimestamp">BindTimeStamp</a>
  <a href="#unixtimestamp">UnixTimeStamp</a> <a href="#OffsetDate">OffsetDate</a> 
  <a href="#SQLDate">SQLDate</a> <br>
  Row Management: <a href="#affected_rows">Affected_Rows</a> <a href="#inserted_id">Insert_ID</a>  <a href="#rowlock">RowLock</a>
  <a href="#genid">GenID</a> <a href="#createseq">CreateSequence</a> <a href="#dropseq">DropSequence</a> 
  <br>
  Error Handling: <a href="#errormsg">ErrorMsg</a> <a href="#errorno">ErrorNo</a> 
  <a href="#metaerror">MetaError</a> <a href="#metaerrormsg">MetaErrorMsg</a> <a href="#ignoreerrors">IgnoreErrors</a><br>
  Data Dictionary (metadata): <a href="#metadatabases">MetaDatabases</a> <a href="#metatables">MetaTables</a> 
  <a href="#metacolumns">MetaColumns</a> <a href="#metacolumnames">MetaColumnNames</a> 
  <a href="#metaprimarykeys">MetaPrimaryKeys</a> <a href="#metaforeignkeys">MetaForeignKeys</a> 
  <a href="#serverinfo">ServerInfo</a> <br>
  Statistics and Query-Rewriting: <a href="#logsql">LogSQL</a> <a href="#fnexecute">fnExecute 
  and fnCacheExecute</a><br>
  </font><font size="2">Deprecated: <a href="#bind">Bind</a> <a href="#blankrecordset">BlankRecordSet</a>
  <a href="#parameter">Parameter</a></font>
  <a href="#adorecordSet"><b><br>
  ADORecordSet</b></a><br>
  <font size="2">
  Returns one field: <a href="#fields">Fields</a><br>
 Returns one row:<a href="#fetchrow">FetchRow</a> <a href="#fetchinto">FetchInto</a> 
  <a href="#fetchobject">FetchObject</a> <a href="#fetchnextobject">FetchNextObject</a> 
  <a href="#fetchobj">FetchObj</a> <a href="#fetchnextobj">FetchNextObj</a>
 <a href="#getrowassoc">GetRowAssoc</a> <br>
  Returns all rows:<a href="#getarray">GetArray</a> <a href="#getrows">GetRows</a> 
  <a href="#getassoc">GetAssoc</a><br>
  Scrolling:<a href="#move">Move</a> <a href="#movenext">MoveNext</a> <a href="#movefirst">MoveFirst</a> 
  <a href="#movelast">MoveLast</a> <a href="#abspos">AbsolutePosition</a> <a href="#currentrow">CurrentRow</a> 
  <a href="#atfirstpage">AtFirstPage</a> <a href="#atlastpage">AtLastPage</a> 
  <a href="#absolutepage">AbsolutePage</a> </font> <font size="2"><br>
  Menu generation:<a href="#getmenu">GetMenu</a> <a href="#getmenu2">GetMenu2</a><br>
  Dates:<a href="#userdate">UserDate</a> <a href="#usertimestamp">UserTimeStamp</a> 
  <a href="#unixdate">UnixDate</a> <a href="#unixtimestamp">UnixTimeStamp<br>
  </a>Recordset Info:<a href="#recordcount">RecordCount</a> <a href="#po_recordcount">PO_RecordCount</a> 
  <a href="#nextrecordset">NextRecordSet</a><br>
  Field Info:<a href="#fieldcount">FieldCount</a> <a href="#fetchfield">FetchField</a> 
  <a href="#metatype">MetaType</a><br>
  Cleanup: <a href="#rsclose">Close</a></font>  
</p>
<p><font size="2"><a href="#rs2html"><b>rs2html</b></a>&nbsp; <a href="#exrs2html">example</a></font><br>
  <a href="#adodiff">Differences between ADOdb and ADO</a><br>
  <a href="#driverguide"><b>Database Driver Guide<br>
  </b></a><b><a href="#changes">Change Log</a></b><br>
</p>
<h2>Introduction<a name="intro"></a></h2>
<p>PHP's database access functions are not standardised. This creates a need for 
  a database class library to hide the differences between the different database 
  API's (encapsulate the differences) so we can easily switch databases. PHP 4.0.5 or later
  is now required (because we use array-based str_replace).</p>
<p>We currently support MySQL, Oracle, Microsoft SQL Server, Sybase, Sybase SQL Anywhere, Informix, 
  PostgreSQL, FrontBase,  SQLite, Interbase (Firebird and Borland variants), Foxpro, Access, ADO, DB2, SAP DB and ODBC. 
  We have had successful reports of connecting to Progress and CacheLite via ODBC. We hope more people 
  will contribute drivers to support other databases.</p>
<p>PHP4 supports session variables. You can store your session information using 
  ADOdb for true portability and scalability. See adodb-session.php for more information.</p>
<p>Also read <a href="http://phplens.com/lens/adodb/tips_portable_sql.htm">tips_portable_sql.htm</a> 
 for tips on writing 
  portable SQL.</p>
<h2>Unique Features of ADOdb<a name="features"></a></h2>
<ul>
  <li><b>Easy for Windows programmers</b> to adapt to because many of the conventions 
	are similar to Microsoft's ADO.</li>
  <li>Unlike other PHP database classes which focus only on select statements, 
	<b>we provide support code to handle inserts and updates which can be adapted 
	to multiple databases quickly.</b> Methods are provided for date handling, 
	string concatenation and string quoting characters for differing databases.</li>
  <li>A<b> metatype system </b>is built in so that we can figure out that types 
	such as CHAR, TEXT and STRING are equivalent in different databases.</li>
  <li><b>Easy to port</b> because all the database dependant code are stored in 
	stub functions. You do not need to port the core logic of the classes.</li>
  <li><b>Portable table and index creation</b> with the <a href="docs-datadict.htm">datadict</a> classes.
  </li><li><b>Database performance monitoring and SQL tuning</b> with the <a href="docs-perf.htm">performance monitoring</a> classes.
  </li><li><b>Database-backed sessions</b> with the <a href="docs-session.htm">session management</a> classes. Supports session expiry notification.
<li><b>Object-Relational Mapping</b> using <a href="docs-active-record.htm">ADOdb_Active_Record</a> classes.
</li></ul>
<h2>How People are using ADOdb<a name="users"></a></h2>
Here are some examples of how people are using ADOdb (for a much longer list, 
visit <a href="http://phplens.com/phpeverywhere/adodb-cool-apps">adodb-cool-apps</a>): 
<ul>
<li><a href="http://phplens.com/">PhpLens</a> is a commercial data grid
component that allows both cool Web designers and serious unshaved
programmers to develop and maintain databases on the Web easily.
Developed by the author of ADOdb.<p>

</p></li><li><a href="http://www.interakt.ro/phakt/">PHAkt: PHP Extension for DreamWeaver Ultradev</a> allows you to script PHP in the popular Web page editor. Database handling provided by ADOdb.<p>

</p></li><li><a href="http://www.andrew.cmu.edu/%7Erdanyliw/snort/snortacid.html">Analysis Console for Intrusion Databases</a>
(ACID): PHP-based analysis engine to search and process a database of
security incidents generated by security-related software such as IDSes
and firewalls (e.g. Snort, ipchains). By Roman Danyliw.<p>

</p></li><li><a href="http://www.postnuke.com/">PostNuke</a> is a very
popular free content management system and weblog system. It offers
full CSS support, HTML 4.01 transitional compliance throughout, an
advanced blocks system, and is fully multi-lingual enabled. <p>

</p></li><li><a href="http://www.auto-net.no/easypublish.php?page=index&amp;lang_id=2">EasyPublish CMS</a>
is another free content management system for managing information and
integrated modules on your internet, intranet- and extranet-sites. From
Norway.<p>

</p></li><li><a href="http://nola.noguska.com/">NOLA</a> is a full featured accounting, inventory, and job tracking application. It is licensed under the GPL, and developed by Noguska.
</li></ul><p>

</p><h2>Feature Requests and Bug Reports<a name="bugs"></a></h2>
<p>Feature requests and bug reports can be emailed to <a href="mailto:jlim#natsoft.com.my">jlim#natsoft.com.my</a> 
  or posted to the ADOdb Help forums at <a href="http://phplens.com/lens/lensforum/topics.php?id=4">http://phplens.com/lens/lensforum/topics.php?id=4</a>.</p>
<h2>Installation Guide<a name="install"></a></h2>
<p>Make sure you are running PHP 4.0.5 or later. 
  Unpack all the files into a directory accessible by your webserver.</p>
<p>To test, try modifying some of the tutorial examples. Make sure you customize 
  the connection settings correctly. You can debug using <i>$db-&gt;debug = true</i> as shown below:</p>
<pre>&lt;?php<br>	include('adodb/adodb.inc.php');<br>	$db = <a href="#adonewconnection">ADONewConnection</a>($dbdriver); # eg 'mysql' or 'postgres'<br>	$db-&gt;debug = true;<br>	$db-&gt;<a href="#connect">Connect</a>($server, $user, $password, $database);<br>	$rs = $db-&gt;<a href="#execute">Execute</a>('select * from some_small_table');<br>	print "&lt;pre&gt;";<br>	print_r($rs-&gt;<a href="#getrows">GetRows</a>());<br>	print "&lt;/pre&gt;";<br>?&gt;</pre>

 <h3>Minimum Install<a name="mininstall"></a></h3>
<p>For developers who want to release a minimal install of ADOdb, you will need:
</p><ul>
<li>adodb.inc.php
</li><li>adodb-lib.inc.php
</li><li>adodb-time.inc.php
</li><li>drivers/adodb-$database.inc.php
</li><li>license.txt (for legal reasons)
</li><li>adodb-php4.inc.php 
</li><li>adodb-iterator.inc.php  (php5 functionality)
</li></ul>
Optional:
<ul>
<li>adodb-error.inc.php and lang/adodb-$lang.inc.php (if you use MetaError())
</li><li>adodb-csvlib.inc.php (if you use cached recordsets - CacheExecute(), etc)
</li><li>adodb-exceptions.inc.php and adodb-errorhandler.inc.php (if you use adodb error handler or php5 exceptions).
<li>adodb-active-record.inc.php if you use <a href=docs-active-record.htm>Active Records</a>.
</li></ul>

<h3>Code Initialization Examples<a name="coding"></a></h3>
<p>When running ADOdb, at least two files are loaded. First is adodb/adodb.inc.php, 
 which contains all functions used by all database classes. The code specific 
 to a particular database is in the adodb/driver/adodb-????.inc.php file.</p>
 <a name="adonewconnection"></a>
<p>For example, to connect to a mysql database:</p>
<pre>include('/path/to/set/here/adodb.inc.php');<br>$conn = &amp;ADONewConnection('mysql');<br></pre>
<p>Whenever you need to connect to a database, you create a Connection object 
  using the <b>ADONewConnection</b>($driver) function. 
  <b>NewADOConnection</b>($driver) is an alternative name for the same function.</p>

<p>At this point, you are not connected to the database (no longer true if you pass in a <a href="#dsnsupport">dsn</a>). You will first need to decide
whether to use <i>persistent</i> or <i>non-persistent</i> connections. The advantage of <i>persistent</i>
connections is that they are faster, as the database connection is never closed (even 
when you call Close()). <i>Non-persistent </i>connections take up much fewer resources though,
reducing the risk of your database and your web-server becoming overloaded. 
</p><p>For persistent connections,
use $conn-&gt;<a href="#pconnect">PConnect()</a>,
 or $conn-&gt;<a href="#connect">Connect()</a> for non-persistent connections.
Some database drivers also support <a href="#nconnect">NConnect()</a>, which forces 
the creation of a new connection. 

<a name="connection_gotcha"></a>
</p><p><b>Connection Gotcha</b>:  If you create two connections, but both use the same userid and password,
PHP will share the same connection. This can cause problems if the connections are meant to 
different databases. The solution is to always use different userid's for different databases,
 or use NConnect().

 <a name="dsnsupport"></a>
 </p><h3>Data Source Name (DSN) Support</h3>
 <p> Since ADOdb 4.51, you can connect to a database by passing a dsn to NewADOConnection() (or ADONewConnection, which is
 the same function). The dsn format is:
</p><pre>	$driver://$username:$password@hostname/$database?options[=value]<br></pre><p>
NewADOConnection() calls Connect() or PConnect() internally for you. If the connection fails, false is returned.
</p><pre>	<font color="#008000"># non-persistent connection</font>
	$dsn = 'mysql://root:pwd@localhost/mydb'; 
	$db = NewADOConnection($dsn);
	if (!$db) die("Connection failed");   
	
	<font color="#008000"># no need to call connect/pconnect!</font>
	$arr = $db-&gt;GetArray("select * from table");
	
	<font color="#008000"># persistent connection</font>
	$dsn2 = 'mysql://root:pwd@localhost/mydb?persist'; 
</pre>
<p>
If you have special characters such as /:?_ in your dsn, then you need to rawurlencode them first:
</p><pre>	$pwd = rawurlencode($pwd);<br>	$dsn = "mysql://root:$pwd@localhost/mydb";
	$dsn2=rawurlencode("sybase_ase")."://user:pass@host/path?query";<br></pre>
<p>
Legal options are:
</p><p>
<table align="center" border="1"><tbody><tr><td>For all drivers</td><td>
	'persist', 'persistent', 'debug', 'fetchmode', 'new'
	</td></tr><tr><td>Interbase/Firebird
	</td><td>
					 'dialect','charset','buffers','role'
	</td></tr><tr><td>M'soft ADO</td><td>
					 'charpage'
					
		</td></tr><tr><td>MySQL</td><td>
					'clientflags'
</td></tr><tr><td>MySQLi</td><td>
	'port', 'socket', 'clientflags'
</td></tr><tr><td>Oci8</td><td>
 'nls_date_format','charset'
</td></tr></tbody></table>
</p><p>
For all drivers, when the options <i>persist</i> or <i>persistent</i> are set,  a persistent connection is forced; similarly, when <i>new</i> is set, then
a new connection will be created using NConnect if the underlying driver supports it. 
The <i>debug</i> option enables debugging. The <i>fetchmode</i> calls <a href="#setfetchmode">SetFetchMode()</a>.
If no value is defined for an option, then the value is set to 1.
</p><p>
ADOdb DSN's are compatible with version 1.0 of PEAR DB's DSN format.
<a name="connect_ex">
</a></p><h3><a name="connect_ex">Examples of Connecting to Databases</a></h3>
<h4><a name="connect_ex">MySQL and Most Other Database Drivers</a></h4>
<p><a name="connect_ex">MySQL connections are very straightforward, and the parameters are identical 
  to mysql_connect:</a></p>
<pre><a name="connect_ex">	$conn = &amp;ADONewConnection('mysql'); <br>	$conn-&gt;PConnect('localhost','userid','password','database');<br>	<br>	<font color="#008000"># or dsn </font>
	$dsn = 'mysql://user:pwd@localhost/mydb'; 
	$conn = ADONewConnection($dsn);  # no need for Connect()
	
	<font color="#008000"># or persistent dsn</font>
	$dsn = 'mysql://user:pwd@localhost/mydb?persist'; 
	$conn = ADONewConnection($dsn);  # no need for PConnect()
	
	<font color="#008000"># a more complex example:</font>
	$pwd = urlencode($pwd);
	$flags =  MYSQL_CLIENT_COMPRESS;
	$dsn = "mysql://user:$pwd@localhost/mydb?persist&amp;clientflags=$flags";
	$conn = ADONewConnection($dsn);  # no need for PConnect()
 </a></pre>
<p><a name="connect_ex"> For most drivers, you can use the standard function: Connect($server, $user, $password, $database), or
a </a><a href="dsnsupport">DSN</a> since ADOdb 4.51. Exceptions to this are listed below.
</p>
<a name=pdo>
<h4>PDO</h4>
<p>PDO, which only works with PHP5, accepts a driver specific connection string:
<pre>
	$conn =& NewADConnection('pdo');
	$conn->Connect('mysql:host=localhost',$user,$pwd,$mydb);
	$conn->Connect('mysql:host=localhost;dbname=mydb',$user,$pwd);
	$conn->Connect("mysql:host=localhost;dbname=mydb;username=$user;password=$pwd");
</pre>
<p>The DSN mechanism is also supported:
<pre>
	$conn =& NewADConnection("pdo_mysql://user:pwd@localhost/mydb?persist"); # persist is optional
</pre>
<h4>PostgreSQL</h4>
<p>PostgreSQL 7 and 8 accepts connections using: </p>
<p>a. the standard connection string:</p>
<pre>	$conn = &amp;ADONewConnection('postgres');  <br>	$conn-&gt;PConnect('host=localhost port=5432 dbname=mary');</pre>
<p> b. the classical 4 parameters:</p>
 <pre>	$conn-&gt;PConnect('localhost','userid','password','database');<br> </pre>
<p>c. dsn:
</p><pre>	$dsn = 'postgres://user:pwd@localhost/mydb?persist';  # persist is optional
	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
<a name="ldap"></a>

 <h4>LDAP</h4>
  <p>Here is an example of querying a LDAP server. Thanks to Josh Eldridge for the driver and this example:
</p><pre>
require('/path/to/adodb.inc.php');

/* Make sure to set this BEFORE calling Connect() */
$LDAP_CONNECT_OPTIONS = Array(
	Array ("OPTION_NAME"=>LDAP_OPT_DEREF, "OPTION_VALUE"=>2),
	Array ("OPTION_NAME"=>LDAP_OPT_SIZELIMIT,"OPTION_VALUE"=>100),
	Array ("OPTION_NAME"=>LDAP_OPT_TIMELIMIT,"OPTION_VALUE"=>30),
	Array ("OPTION_NAME"=>LDAP_OPT_PROTOCOL_VERSION,"OPTION_VALUE"=>3),
	Array ("OPTION_NAME"=>LDAP_OPT_ERROR_NUMBER,"OPTION_VALUE"=>13),
	Array ("OPTION_NAME"=>LDAP_OPT_REFERRALS,"OPTION_VALUE"=>FALSE),
	Array ("OPTION_NAME"=>LDAP_OPT_RESTART,"OPTION_VALUE"=>FALSE)
);
$host = 'ldap.baylor.edu';
$ldapbase = 'ou=People,o=Baylor University,c=US';

$ldap = NewADOConnection( 'ldap' );
$ldap->Connect( $host, $user_name='', $password='', $ldapbase );

echo "&lt;pre>";

print_r( $ldap->ServerInfo() );
$ldap->SetFetchMode(ADODB_FETCH_ASSOC);
$userName = 'eldridge';
$filter="(|(CN=$userName*)(sn=$userName*)(givenname=$userName*)(uid=$userName*))";

$rs = $ldap->Execute( $filter );
if ($rs)
	while ($arr = $rs->FetchRow()) {
	     print_r($arr);	
	}

$rs = $ldap->Execute( $filter );
if ($rs) 
	while (!$rs->EOF) {
 		print_r($rs->fields);	
		$rs->MoveNext();
	} 
	
print_r( $ldap->GetArray( $filter ) );
print_r( $ldap->GetRow( $filter ) );

$ldap->Close();
echo "&lt;/pre>";
</pre>
<p>Using DSN:
<pre>
$dsn = "ldap://ldap.baylor.edu/ou=People,o=Baylor University,c=US";
$db = NewADOConnection($dsn);
</pre>
<h4>Interbase/Firebird</h4>
You define the database in the $host parameter:
<pre>	$conn = &amp;ADONewConnection('ibase'); <br>	$conn-&gt;PConnect('localhost:c:\ibase\employee.gdb','sysdba','masterkey');<br></pre>
<p>Or dsn:
</p><pre>	$dsn = 'firebird://user:pwd@localhost/mydb?persist&amp;dialect=3';  # persist is optional<br>	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
<h4>SQLite</h4>
Sqlite will create the database file if it does not exist.
<pre>	$conn = &amp;ADONewConnection('sqlite');
	$conn-&gt;PConnect('c:\path\to\sqlite.db'); # sqlite will create if does not exist<br></pre>
<p>Or dsn:
</p><pre>	$path = urlencode('c:\path\to\sqlite.db');
	$dsn = "sqlite://$path/?persist";  # persist is optional
	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br></pre>
<h4>Oracle (oci8)</h4>
<p>With oci8, you can connect in multiple ways. Note that oci8 works fine with 
newer versions of the Oracle, eg. 9i and 10g.</p>
<p>a. PHP and Oracle reside on the same machine, use default SID.</p>
<pre>	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
<p>b. TNS Name defined in tnsnames.ora (or ONAMES or HOSTNAMES), eg. 'myTNS'</p>
<pre>	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
<p>or</p>
<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
<p>c. Host Address and SID</p>
<pre>
	$conn->connectSID = true;
	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
<p>d. Host Address and Service Name</p>
<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
<p>e. Oracle connection string:
</p><pre>	$cstr = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))<br>			(CONNECT_DATA=(SID=$sid)))";<br>	$conn-&gt;Connect($cstr, 'scott', 'tiger');<br></pre>
<p>f. ADOdb dsn:
</p><pre>	$dsn = 'oci8://user:pwd@tnsname/?persist';  # persist is optional<br>	$conn = ADONewConnection($dsn);  # no need for Connect/PConnect<br>	<br>	$dsn = 'oci8://user:pwd@host/sid';<br>	$conn = ADONewConnection($dsn);<br>	<br>	$dsn = 'oci8://user:pwd@/';   # oracle on local machine<br>	$conn = ADONewConnection($dsn);<br></pre>
<p>You can also set the charSet for Oracle 9.2 and later, supported since PHP 4.3.2, ADOdb 4.54:
</p><pre>	$conn-&gt;charSet = 'we8iso8859p1';<br>	$conn-&gt;Connect(...);<br>	<br>	# or<br>	$dsn = 'oci8://user:pwd@tnsname/?charset=WE8MSWIN1252';<br>	$db = ADONewConnection($dsn);<br></pre>
<a name="dsnless"></a>
<h4>DSN-less ODBC ( Access, MSSQL and DB2 examples)</h4>
<p>ODBC DSN's can be created in the ODBC control panel, or you can use a DSN-less 
  connection.To use DSN-less connections with ODBC you need PHP 4.3 or later. 
</p>
<p>For Microsoft Access:</p>
<pre>	$db =&amp; ADONewConnection('access');<br>	$dsn = <strong>"Driver={Microsoft Access Driver (*.mdb)};Dbq=d:\\northwind.mdb;Uid=Admin;Pwd=;";</strong>
	$db-&gt;Connect($dsn);
</pre>
For Microsoft SQL Server: 
<pre>	$db =&amp; ADONewConnection('odbc_mssql');<br>	$dsn = <strong>"Driver={SQL Server};Server=localhost;Database=northwind;"</strong>;<br>	$db-&gt;Connect($dsn,'userid','password');<br></pre>
or if you prefer to use the mssql extension (which is limited to mssql 6.5 functionality):
<pre>	$db =&amp; ADONewConnection('mssql');<br>	$db-&gt;Execute('localhost', 'userid', 'password', 'northwind');<br></pre>
For DB2:
<pre>
	$dbms = 'db2'; # or 'odbc_db2' if db2 extension not available
	$db =&amp; ADONewConnection($dbms);
	$dsn = "driver={IBM db2 odbc DRIVER};Database=sample;hostname=localhost;port=50000;protocol=TCPIP;".
				"uid=root; pwd=secret";<br>	$db-&gt;Connect($dsn);
</pre>
<b>DSN-less Connections with ADO</b><br>
If you are using versions of PHP earlier than PHP 4.3.0, DSN-less connections 
only work with Microsoft's ADO, which is Microsoft's COM based API. An example 
using the ADOdb library and Microsoft's ADO: 
<pre>&lt;?php<br>	include('adodb.inc.php'); <br>	$db = &amp;ADONewConnection("ado_mssql");<br>	print "&lt;h1&gt;Connecting DSN-less $db-&gt;databaseType...&lt;/h1&gt;";<br>		<br>	<b>$myDSN="PROVIDER=MSDASQL;DRIVER={SQL Server};"<br>		. "SERVER=flipper;DATABASE=ai;UID=sa;PWD=;"  ;</b>
	$db-&gt;Connect($myDSN);
	
	$rs = $db-&gt;Execute("select * from table");
	$arr = $rs-&gt;GetArray();
	print_r($arr);
?&gt;
</pre><a name="speed"></a>
<h2>High Speed ADOdb - tuning tips</h2>
<p>ADOdb is a big class library, yet it <a href="http://phplens.com/lens/adodb/">consistently beats</a> all other PHP class 
  libraries in performance. This is because it is designed in a layered fashion, 
  like an onion, with the fastest functions in the innermost layer. Stick to the 
  following functions for best performance:</p>
<table align="center" border="1" width="40%">
  <tbody><tr>
    <td><div align="center"><b>Innermost Layer</b></div></td>
  </tr>
  <tr> 
    <td><p align="center">Connect, PConnect, NConnect<br>
        Execute, CacheExecute<br>
        SelectLimit, CacheSelectLimit<br>
        MoveNext, Close <br>
		qstr, Affected_Rows, Insert_ID</p></td>
  </tr>
</tbody></table>
<p>The fastest way to access the field data is by accessing the array $recordset-&gt;fields 
  directly. Also set the global variables <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a> 
  = ADODB_FETCH_NUM, and (for oci8, ibase/firebird and odbc) <a href="#adodb_countrecs">$ADODB_COUNTRECS</a> = false 
  before you connect to your database.</p>
<p>Consider using bind parameters if your database supports it, as it improves 
  query plan reuse. Use ADOdb's performance tuning system to identify bottlenecks 
  quickly. At the time of writing (Dec 2003), this means oci8 and odbc drivers.</p>
 <p>Lastly make sure you have a PHP accelerator cache installed such as APC, Turck 
  MMCache, Zend Accelerator or ionCube.</p>
 <p>Some examples:</p>
 <table align="center" border="1"><tbody><tr><td><b>Fastest data retrieval using PHP</b></td><td><b>Fastest data retrieval using ADOdb extension</b></td></tr>
<tr><td>
<pre>$rs =&amp; $rs-&gt;Execute($sql);<br>while (!$rs-&gt;EOF) {<br>	var_dump($rs-&gt;fields);<br>	$rs-&gt;MoveNext();<br>}</pre></td><td>
<pre>$rs =&amp; $rs-&gt;Execute($sql);<br>$array = adodb_getall($rs);<br>var_dump($array);<br><br><br></pre></td></tr></tbody></table>
 <p><b>Advanced Tips</b>
 </p><p>If you have the <a href="http://adodb.sourceforge.net/#extension">ADOdb C extension</a> installed, 
 you can replace your calls to $rs-&gt;MoveNext() with adodb_movenext($rs). 
 This doubles the speed of this operation. For retrieving entire recordsets at once,
use GetArray(), which uses the high speed extension function adodb_getall($rs) internally.
 </p><p>Execute() is the default way to run queries. You can use the low-level functions _Execute() and _query()
to reduce query overhead.  Both these functions share the same parameters as Execute().
</p><p>If you do not have any bind parameters or your database supports
binding (without emulation),
then you can call _Execute() directly. Calling this function bypasses
bind emulation. Debugging is still supported in _Execute().
</p><p>If you do not require debugging facilities nor emulated
binding, and do not require a recordset to be returned, then you can
call _query. This is great for inserts, updates and deletes. Calling
this function
bypasses emulated binding, debugging, and recordset handling. Either
the resultid, true or false are returned by _query(). </p><p>For Informix, you can disable scrollable cursors with $db-&gt;cursorType = 0.
</p><p><a name="hack"></a> </p>
<h2>Hacking ADOdb Safely</h2>
<p>You might want to modify ADOdb for your own purposes. Luckily you can
still maintain backward compatibility by sub-classing ADOdb and using the $ADODB_NEWCONNECTION
variable. $ADODB_NEWCONNECTION allows you to override the behaviour of ADONewConnection().
ADOConnection() checks for this variable and will call
the function-name stored in this variable if it is defined.
</p><p>In the following example, new functionality for the connection object 
is placed in the <i>hack_mysql</i> and <i>hack_postgres7</i> classes. The recordset class naming convention
can be controlled using $rsPrefix. Here we set it to 'hack_rs_', which will make ADOdb use
<i>hack_rs_mysql</i> and <i>hack_rs_postgres7</i> as the recordset classes.


</p><pre>class hack_mysql extends adodb_mysql {<br>var $rsPrefix = 'hack_rs_';<br>  /* Your mods here */<br>}<br><br>class hack_rs_mysql extends ADORecordSet_mysql {<br>	 /* Your mods here */<br>}<br><br>class hack_postgres7 extends adodb_postgres7 {<br>var $rsPrefix = 'hack_rs_';<br>  /* Your mods here */<br>}<br><br>class hack_rs_postgres7 extends ADORecordSet_postgres7 {<br> /* Your mods here */<br>}<br><br>$ADODB_NEWCONNECTION = 'hack_factory';<br><br>function&amp; hack_factory($driver)<br>{<br>	if ($driver !== 'mysql' &amp;&amp; $driver !== 'postgres7') return false;<br>	<br>	$driver = 'hack_'.$driver;<br>	$obj = new $driver();<br>	return $obj;<br>}<br><br>include_once('adodb.inc.php');<br></pre>
<p></p><p>Don't forget to call the constructor of the parent class in
your constructor. If you want to use the default ADOdb drivers return
false in the above hack_factory() function.
<a name="php5"></a>
</p><h2>PHP5 Features</h2>
 ADOdb 4.02 or later will transparently determine which version of PHP you are using.
If PHP5 is detected, the following features become available:
<ul>

<li><b>PDO</b>: PDO drivers are available. See the <a href=#pdo>connection examples</a>. Currently PDO drivers are
 not as powerful as native drivers, and should be treated as experimental.<br><br>
<a name="php5iterators"></a>
<li><b>Foreach iterators</b>: This is a very natural way of going through a recordset:
<pre>	$ADODB_FETCH_MODE = ADODB_FETCH_NUM;<br>	$rs = $db-&gt;Execute($sql);<br>	foreach($rs as $k =&gt; $row) {<br>		echo "r1=".$row[0]." r2=".$row[1]."&lt;br&gt;";<br>	}<br></pre>
<p>
<a name="php5exceptions"></a>
</p></li><li><b>Exceptions</b>: Just include <i>adodb-exceptions.inc.php</i> and you can now 
catch exceptions on errors as they occur.
<pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8"); <br>		$db-&gt;Connect('','scott','bad-password'); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
<p>Note that reaching EOF is <b>not</b> considered an error nor an exception.
</p></li></ul> 
<h3><a name="drivers"></a>Databases Supported</h3>
The <i>name</i> below is the value you pass to NewADOConnection($name) to create a  connection object for that database.
<p>
</p><p> 
</p><table border="1" width="100%">
  <tbody><tr valign="top"> 
    <td><b>Name</b></td>
    <td><b>Tested</b></td>
    <td><b>Database</b></td>
    <td><b><font size="2">RecordCount() usable</font></b></td>
    <td><b>Prerequisites</b></td>
    <td><b>Operating Systems</b></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">access</font></b></td>
    <td><font size="2">B</font></td>
    <td><font size="2">Microsoft Access/Jet. You need to create an ODBC DSN.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ODBC </font></td>
    <td><font size="2">Windows only</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">ado</font></b></td>
    <td><font size="2">B</font></td>
    <td><p><font size="2">Generic ADO, not tuned for specific databases. Allows 
        DSN-less connections. For best performance, use an OLEDB provider. This 
        is the base class for all ado drivers.</font></p>
      <p><font size="2">You can set $db-&gt;codePage before connecting.</font></p></td>
    <td><font size="2">? depends on database</font></td>
    <td><font size="2">ADO or OLEDB provider</font></td>
    <td><font size="2">Windows only</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">ado_access</font></b></td>
    <td><font size="2">B</font></td>
    <td><font size="2">Microsoft Access/Jet using ADO. Allows DSN-less connections. 
      For best performance, use an OLEDB provider.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ADO or OLEDB provider</font></td>
    <td><font size="2">Windows only</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">ado_mssql</font></b></td>
    <td><font size="2">B</font></td>
    <td><font size="2">Microsoft SQL Server using ADO. Allows DSN-less connections. 
      For best performance, use an OLEDB provider.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ADO or OLEDB provider</font></td>
    <td><font size="2">Windows only</font></td>
  </tr>
    <tr valign="top"> 
    <td height="54"><b><font size="2">db2</font></b></td>
    <td height="54"><font size="2">C</font></td>
    <td height="54"><font size="2">Uses PHP's db2-specific extension for better performance.</font></td>
    <td height="54"><font size="2">Y/N</font></td>
    <td height="54"><font size="2">DB2 CLI/ODBC interface</font></td>
    <td height="54"> <p><font size="2">Unix and Windows. Requires IBM DB2 Universal Database client.</font></p></td>
  </tr>
  <tr valign="top"> 
    <td height="54"><b><font size="2">odbc_db2</font></b></td>
    <td height="54"><font size="2">C</font></td>
    <td height="54"><font size="2">Connects to DB2 using generic ODBC extension.</font></td>
    <td height="54"><font size="2">Y/N</font></td>
    <td height="54"><font size="2">DB2 CLI/ODBC interface</font></td>
    <td height="54"> <p><font size="2">Unix and Windows. <a href="http://www.faqts.com/knowledge_base/view.phtml/aid/6283/fid/14">Unix 
        install hints</a>. I have had reports that the $host and $database params have to be reversed in Connect() when using the CLI interface.</font></p></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">vfp</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">Microsoft Visual FoxPro. You need to create an ODBC DSN.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ODBC</font></td>
    <td><font size="2">Windows only</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">fbsql</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">FrontBase. </font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">?</font></td>
    <td> <p><font size="2">Unix and Windows</font></p></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">ibase</font></b></td>
    <td><font size="2">B</font></td>
    <td><font size="2">Interbase 6 or earlier. Some users report you might need 
      to use this<br>
      $db-&gt;PConnect('localhost:c:/ibase/employee.gdb', "sysdba", "masterkey") 
      to connect. Lacks Affected_Rows currently.<br>
      <br>
      You can set $db-&gt;role, $db-&gt;dialect, $db-&gt;buffers and $db-&gt;charSet before connecting.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Interbase client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><i><font size="2">firebird</font></i></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Firebird version of interbase.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Interbase client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><i><font size="2">borland_ibase</font></i></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Borland version of Interbase 6.5 or later. Very sad that 
      the forks differ.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Interbase client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>

  <tr valign="top"> 
    <td><b><font size="2">informix</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Generic informix driver. Use this if you are using Informix 7.3 or later.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Informix client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">informix72</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2"> Informix databases before Informix 7.3 that do no support 
      SELECT FIRST.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Informix client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">ldap</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">LDAP driver. See this example for usage information.</font></td>
    <td>&nbsp;</td>
    <td><font size="2">LDAP extension</font></td>
    <td><font size="2">?</font></td>
  </tr>
  <tr valign="top"> 
    <td height="73"><b><font size="2">mssql</font></b></td>
    <td height="73"><font size="2">A</font></td>
    <td height="73"> <p><font size="2">Microsoft SQL Server 7 and later. Works 
        with Microsoft SQL Server 2000 also. Note that date formating is problematic 
        with this driver. For example, the PHP mssql extension does not return 
        the seconds for datetime!</font></p></td>
    <td height="73"><font size="2">Y/N</font></td>
    <td height="73"><font size="2">Mssql client</font></td>
    <td height="73"> <p><font size="2">Unix and Windows. <br>
        <a href="http://phpbuilder.com/columns/alberto20000919.php3">Unix install 
        howto</a> and <a href="http://linuxjournal.com/article.php?sid=6636&amp;mode=thread&amp;order=0">another 
        one</a>. </font></p></td>
  </tr>
  <tr valign="top"> 
    <td height="73"><b><font size="2">mssqlpo</font></b></td>
    <td height="73"><font size="2">A</font></td>
    <td height="73"> <p><font size="2">Portable mssql driver. Identical to above 
        mssql driver, except that '||', the concatenation operator, is converted 
        to '+'. Useful for porting scripts from most other sql variants that use 
        ||.</font></p></td>
    <td height="73"><font size="2">Y/N</font></td>
    <td height="73"><font size="2">Mssql client</font></td>
    <td height="73"> <p><font size="2">Unix and Windows. <a href="http://phpbuilder.com/columns/alberto20000919.php3"><br>
        Unix install howto</a>.</font></p></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">mysql</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">MySQL without transaction support. You can also set $db-&gt;clientFlags 
      before connecting.</font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">MySQL client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><font size="2"><b>mysqlt</b> or <b>maxsql</b></font></td>
    <td><font size="2">A</font></td>
    <td> <p><font size="2">MySQL with transaction support. We recommend using 
        || as the concat operator for best portability. This can be done by running 
        MySQL using: <br>
        <i>mysqld --ansi</i> or <i>mysqld --sql-mode=PIPES_AS_CONCAT</i></font></p></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">MySQL client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">oci8</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">Oracle 8/9. Has more functionality than <i>oracle</i> driver 
      (eg. Affected_Rows). You might have to putenv('ORACLE_HOME=...') before 
      Connect/PConnect. </font> <p><font size="2"> There are 2 ways of connecting 
        - with server IP and service name: <br>
        <i>PConnect('serverip:1521','scott','tiger','service'</i>)<br>
        or using an entry in TNSNAMES.ORA or ONAMES or HOSTNAMES: <br>
        <i>PConnect(false, 'scott', 'tiger', $oraname)</i>. </font> 
      </p><p><font size="2">Since 2.31, we support Oracle REF cursor variables directly 
        (see <a href="#executecursor">ExecuteCursor</a>).</font> </p></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Oracle client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">oci805</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Supports reduced Oracle functionality for Oracle 8.0.5. 
      SelectLimit is not as efficient as in the oci8 or oci8po drivers.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Oracle client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">oci8po</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">Oracle 8/9 portable driver. This is nearly identical with 
      the oci8 driver except (a) bind variables in Prepare() use the ? convention, 
      instead of :bindvar, (b) field names use the more common PHP convention 
      of lowercase names. </font> <p><font size="2">Use this driver if porting 
        from other databases is important. Otherwise the oci8 driver offers better 
        performance. </font> </p></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Oracle client</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">odbc</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">Generic ODBC, not tuned for specific databases. To connect, 
      use <br>
      PConnect('DSN','user','pwd'). This is the base class for all odbc derived 
      drivers.</font></td>
    <td><font size="2">? depends on database</font></td>
    <td><font size="2">ODBC</font></td>
    <td><font size="2">Unix and Windows. <a href="http://phpbuilder.com/columns/alberto20000919.php3?page=4">Unix 
      hints.</a></font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">odbc_mssql</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Uses ODBC to connect to MSSQL</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ODBC</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">odbc_oracle</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Uses ODBC to connect to Oracle</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">ODBC</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
    
  <tr valign="top"> 
    <td><b><font size="2">odbtp</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Generic odbtp driver. <a href="http://odbtp.sourceforge.net/">Odbtp</a> is a software for
	accessing Windows ODBC data sources from other operating systems.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">odbtp</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">odbtp_unicode</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Odtbp with unicode support</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">odbtp</font></td>
    <td><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td height="34"><b><font size="2">oracle</font></b></td>
    <td height="34"><font size="2">C</font></td>
    <td height="34"><font size="2">Implements old Oracle 7 client API. Use oci8 
      driver if possible for better performance.</font></td>
    <td height="34"><font size="2">Y/N</font></td>
    <td height="34"><font size="2">Oracle client</font></td>
    <td height="34"><font size="2">Unix and Windows</font></td>
  </tr>
  <tr valign="top"> 
    <td height="34"><b><font size="2">netezza</font></b></td>
    <td height="34"><font size="2">C</font></td>
    <td height="34"><font size="2">Netezza driver. Netezza is based on postgres code-base.</font></td>
    <td height="34"><font size="2">Y</font></td>
    <td height="34"><font size="2">?</font></td>
    <td height="34"><font size="2">?</font></td>
  </tr>
     <tr valign="top"> 
    <td><b><font size="2">pdo</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Generic PDO driver for PHP5. </font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">PDO extension and database specific drivers</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">postgres</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">Generic PostgreSQL driver. Currently identical to postgres7 
      driver.</font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">PostgreSQL client</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">postgres64</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">For PostgreSQL 6.4 and earlier which does not support LIMIT 
      internally.</font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">PostgreSQL client</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">postgres7</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">PostgreSQL which supports LIMIT and other version 7 functionality.</font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">PostgreSQL client</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
    <tr valign="top"> 
    <td><b><font size="2">postgres8</font></b></td>
    <td><font size="2">A</font></td>
    <td><font size="2">PostgreSQL which supports version 8 functionality.</font></td>
    <td><font size="2">Y</font></td>
    <td><font size="2">PostgreSQL client</font></td>
    <td><font size="2">Unix and Windows. </font></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">sapdb</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">SAP DB. Should work reliably as based on ODBC driver.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">SAP ODBC client</font></td>
    <td> <p><font size="2">?</font></p></td>
  </tr>
  <tr valign="top"> 
    <td><b><font size="2">sqlanywhere</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Sybase SQL Anywhere. Should work reliably as based on ODBC 
      driver.</font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">SQL Anywhere ODBC client</font></td>
    <td> <p><font size="2">?</font></p></td>
  </tr>
  <tr valign="top"> 
    <td height="54"><b><font size="2">sqlite</font></b></td>
    <td height="54"><font size="2">B</font></td>
    <td height="54"><font size="2">SQLite.</font></td>
    <td height="54"><font size="2">Y</font></td>
    <td height="54"><font size="2">-</font></td>
    <td height="54"> <p><font size="2">Unix and Windows.</font></p></td>
  </tr>
    <tr valign="top"> 
    <td height="54"><b><font size="2">sqlitepo</font></b></td>
    <td height="54"><font size="2">B</font></td>
    <td height="54"><font size="2">Portable SQLite driver.  This is because assoc mode does not work like other drivers in sqlite.
   Namely, when selecting (joining) multiple tables, the table
   	  names are included in the assoc keys in the "sqlite" driver.</font><p>
<font size="2">	  In "sqlitepo" driver, the table names are stripped from the returned column names. 
	  When this results in a conflict,  the first field get preference.
	  </font></p></td>
    <td height="54"><font size="2">Y</font></td>
    <td height="54"><font size="2">-</font></td>
    <td height="54"> <p><font size="2">Unix and Windows.</font></p></td>
  </tr>
 
	  
  <tr valign="top"> 
    <td><b><font size="2">sybase</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Sybase. </font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Sybase client</font></td>
    <td> <p><font size="2">Unix and Windows.</font></p></td>
  </tr>
  
    <tr valign="top"> 
    <td><b><font size="2">sybase_ase</font></b></td>
    <td><font size="2">C</font></td>
    <td><font size="2">Sybase ASE. </font></td>
    <td><font size="2">Y/N</font></td>
    <td><font size="2">Sybase client</font></td>
    <td> <p><font size="2">Unix and Windows.</font></p></td>
  </tr>
  </tbody></table>

<p></p><p>The "Tested" column indicates how extensively the code has been tested 
  and used. <br>
  A = well tested and used by many people<br>
  B = tested and usable, but some features might not be implemented<br>
  C = user contributed or experimental driver. Might not fully support all of 
  the latest features of ADOdb. </p>
<p>The column "RecordCount() usable" indicates whether RecordCount() 
  return the number of rows, or returns -1 when a SELECT statement is executed. 
  If this column displays Y/N then the RecordCount() is emulated when the global 
  variable $ADODB_COUNTRECS=true (this is the default). Note that for large recordsets, 
  it might be better to disable RecordCount() emulation because substantial amounts 
  of memory are required to cache the recordset for counting. Also there is a 
  speed penalty of 40-50% if emulation is required. This is emulated in most databases 
  except for PostgreSQL and MySQL. This variable is checked every time a query 
  is executed, so you can selectively choose which recordsets to count.</p>
<p> 
</p><hr />
<h1>Tutorials<a name="quickstart"></a></h1>
<h3>Example 1: Select Statement<a name="ex1"></a></h3>
<p>Task: Connect to the Access Northwind DSN, display the first 2 columns of each 
  row.</p>
<p>In this example, we create a ADOConnection object, which represents the connection 
  to the database. The connection is initiated with <a href="#pconnect"><font face="Courier New, Courier, mono">PConnect</font></a>, 
  which is a persistent connection. Whenever we want to query the database, we 
  call the <font face="Courier New, Courier, mono">ADOConnection.<a href="#execute">Execute</a>()</font> 
  function. This returns an ADORecordSet object which is actually a cursor that 
  holds the current row in the array <font face="Courier New, Courier, mono">fields[]</font>. 
  We use <font face="Courier New, Courier, mono"><a href="#movenext">MoveNext</a>()</font> 
  to move from row to row.</p>
<p>NB: A useful function that is not used in this example is <font face="Courier New, Courier, mono"><a href="#selectlimit">SelectLimit</a></font>, 
  which allows us to limit the number of rows shown. 
</p><pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind DSN<br>$<font color="#660000">recordSet</font> = &amp;$<font color="#660000">conn</font>-&gt;Execute('select * from products');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">

$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
?&gt;
</pre>
<p>The $<font face="Courier New, Courier, mono">recordSet</font> returned stores 
  the current row in the <font face="Courier New, Courier, mono">$recordSet-&gt;fields</font> 
  array, indexed by column number (starting from zero). We use the <font face="Courier New, Courier, mono"><a href="#movenext">MoveNext</a>()</font> 
  function to move to the next row. The <font face="Courier New, Courier, mono">EOF</font> 
  property is set to true when end-of-file is reached. If an error occurs in Execute(), 
  we return false instead of a recordset.</p>
<p>The <code>$recordSet-&gt;fields[]</code> array is generated by the PHP database 
  extension. Some database extensions only index by number and do not index the 
  array by field name. To force indexing by name - that is associative arrays 
  - use the SetFetchMode function. Each recordset saves and uses whatever fetch 
  mode was set when the recordset was created in Execute() or SelectLimit(). 
</p><pre>	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i>
</pre>
<p> </p>
<p>To get the number of rows in the select statement, you can use <font face="Courier New, Courier, mono">$recordSet-&gt;<a href="#recordcount">RecordCount</a>()</font>. 
  Note that it can return -1 if the number of rows returned cannot be determined.</p>
<h3>Example 2: Advanced Select with Field Objects<a name="ex2"></a></h3>
<p>Select a table, display the first two columns. If the second column is a date 
  or timestamp, reformat the date to US format.</p>
<pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">recordSet</font> = &amp;$<font color="#660000">conn</font>-&gt;Execute('select CustomerID,OrderDate from Orders');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	$<font color="#660000">fld</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;FetchField</b></font><font color="#006600">(</font>1<font color="#006600">);</font>
	$<font color="#660000">type</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;MetaType</b></font>($fld-&gt;type);<br><br>	<b>if</b> ( $<font color="#660000">type</font> == 'D' || $<font color="#660000">type</font> == 'T') <br>		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.<br>			<b><font color="#336600">$</font></b><font color="#660000">recordSet</font><b><font color="#336600">-&gt;UserDate</font></b>($<font color="#660000">recordSet</font>-&gt;fields[1],'<b>m/d/Y</b>').'&lt;BR&gt;';<br>	<b>else </b>
		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br><br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">
$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
?&gt;
</pre>
<p>In this example, we check the field type of the second column using <font face="Courier New, Courier, mono"><a href="#fetchfield">FetchField</a>().</font> 
  This returns an object with at least 3 fields.</p>
<ul>
  <li><b>name</b>: name of column</li>
  <li> <b>type</b>: native field type of column</li>
  <li> <b>max_length</b>: maximum length of field. Some databases such as MySQL 
    do not return the maximum length of the field correctly. In these cases max_length 
    will be set to -1.</li>
</ul>
<p>We then use <font face="Courier New, Courier, mono"><a href="#metatype">MetaType</a>()</font> 
  to translate the native type to a <i>generic</i> type. Currently the following 
  <i>generic</i> types are defined:</p>
<ul>
  <li><b>C</b>: character fields that should be shown in a &lt;input type="text"&gt; 
    tag.</li>
  <li><b>X</b>: TeXt, large text fields that should be shown in a &lt;textarea&gt;</li>
  <li><b>B</b>: Blobs, or Binary Large Objects. Typically images. 
  </li><li><b>D</b>: Date field</li>
  <li><b>T</b>: Timestamp field</li>
  <li><b>L</b>: Logical field (boolean or bit-field)</li>
  <li><b>I</b>:&nbsp; Integer field</li>
  <li><b>N</b>: Numeric field. Includes autoincrement, numeric, floating point, 
    real and integer. </li>
  <li><b>R</b>: Serial field. Includes serial, autoincrement integers. This works 
    for selected databases. </li>
</ul>
<p>If the metatype is of type date or timestamp, then we print it using the user 
  defined date format with <font face="Courier New, Courier, mono"><a href="#userdate">UserDate</a>(),</font> 
  which converts the PHP SQL date string format to a user defined one. Another 
  use for <font face="Courier New, Courier, mono"><a href="#metatype">MetaType</a>()</font> 
  is data validation before doing an SQL insert or update.</p>
<h3>Example 3: Inserting<a name="ex3"></a></h3>
<p>Insert a row to the Orders table containing dates and strings that need to 
  be quoted before they can be accepted by the database, eg: the single-quote 
  in the word <i>John's</i>.</p>
<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br><br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">shipto</font> = <font color="#006600"><b>$conn-&gt;qstr</b></font>("<i>John's Old Shoppe</i>");<br><br>$<font color="#660000">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#660000">sql</font> .= "values ('ANATR',2,".<b><font color="#006600">$conn-&gt;DBDate(</font>time()<font color="#006600">)</font></b><font color="#006600">.</font>",$<font color="#660000">shipto</font>)";<br><br><b>if</b> ($<font color="#660000">conn</font>-&gt;Execute($<font color="#660000">sql</font>) <font color="#336600"><b>=== false</b></font>) {<br>	<b>print</b> 'error inserting: '.<font color="#336600"><b>$conn-&gt;ErrorMsg()</b></font>.'&lt;BR&gt;';<br>}<br>?&gt;<br></pre>
<p>In this example, we see the advanced date and quote handling facilities of 
  ADOdb. The unix timestamp (which is a long integer) is appropriately formated 
  for Access with <font face="Courier New, Courier, mono"><a href="#dbdate">DBDate</a>()</font>, 
  and the right escape character is used for quoting the <i>John's Old Shoppe</i>, 
  which is<b> </b><i>John'<b>'</b>s Old Shoppe</i> and not PHP's default <i>John<b>'</b>s 
  Old Shoppe</i> with <font face="Courier New, Courier, mono"><a href="#qstr">qstr</a>()</font>. 
</p>
<p>Observe the error-handling of the Execute statement. False is returned by<font face="Courier New, Courier, mono"> 
  <a href="#execute">Execute</a>() </font>if an error occured. The error message 
  for the last error that occurred is displayed in <font face="Courier New, Courier, mono"><a href="#errormsg">ErrorMsg</a>()</font>. 
  Note: <i>php_track_errors</i> might have to be enabled for error messages to 
  be saved.</p>
<h3> Example 4: Debugging<a name="ex4"></a></h3>
<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br><font>$<font color="#663300">shipto</font> = <b>$conn-&gt;qstr</b>("John's Old Shoppe");<br>$<font color="#663300">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#663300">sql</font> .= "values ('ANATR',2,".$<font color="#663300">conn</font>-&gt;FormatDate(time()).",$shipto)";<br><b><font color="#336600">$<font color="#663300">conn</font>-&gt;debug = true;</font></b>
<b>if</b> ($<font color="#663300">conn</font>-&gt;Execute($sql) <b>=== false</b>) <b>print</b> 'error inserting';</font>
?&gt;
</pre>
<p>In the above example, we have turned on debugging by setting <b>debug = true</b>. 
  This will display the SQL statement before execution, and also show any error 
  messages. There is no need to call <font face="Courier New, Courier, mono"><a href="#errormsg">ErrorMsg</a>()</font> 
  in this case. For displaying the recordset, see the <font face="Courier New, Courier, mono"><a href="#exrs2html">rs2html</a>() 
  </font>example.</p>
<p>Also see the section on <a href="#errorhandling">Custom Error Handlers</a>.</p>
<h3>Example 5: MySQL and Menus<a name="ex5"></a></h3>
<p>Connect to MySQL database <i>agora</i>, and generate a &lt;select&gt; menu 
  from an SQL statement where the &lt;option&gt; captions are in the 1st column, 
  and the value to send back to the server is in the 2nd column.</p>
<pre>&lt;?<br><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;Execute($sql);<br><b>print</b> <b><font color="#336600">$<font color="#663300">rs</font>-&gt;GetMenu('GetCust','Mary Rosli');<br>?&gt;</font></b></font></pre>
<p>Here we define a menu named GetCust, with the menu option 'Mary Rosli' selected. 
  See <a href="#getmenu"><font face="Courier New, Courier, mono">GetMenu</font></a><font face="Courier New, Courier, mono">()</font>. 
  We also have functions that return the recordset as an array: <font face="Courier New, Courier, mono"><a href="#getarray">GetArray</a>()</font>, 
  and as an associative array with the key being the first column: <a href="#getassoc1">GetAssoc</a>().</p>
<h3>Example 6: Connecting to 2 Databases At Once<a name="ex6"></a></h3>
<pre>&lt;?<br><b>include</b>('adodb.inc.php');	 # load code common to ADOdb<br>$<font color="#663300">conn1</font> = &amp;ADONewConnection('mysql');  # create a mysql connection<br>$<font color="#663300">conn2</font> = &amp;ADONewConnection('oracle');  # create a oracle connection<br><br>$conn1-&gt;PConnect($server, $userid, $password, $database);<br>$conn2-&gt;PConnect(false, $ora_userid, $ora_pwd, $oraname);<br><br>$conn1-&gt;Execute('insert ...');<br>$conn2-&gt;Execute('update ...');<br>?&gt;</pre>
<p> 
</p><h3>Example 7: Generating Update and Insert SQL<a name="ex7"></a></h3>
<p>Since ADOdb 4.56, we support <a href="reference.functions.getupdatesql.html#autoexecute">AutoExecute()</a>, 
which simplifies things by providing an advanced wrapper for GetInsertSQL() and GetUpdateSQL(). For example,
an INSERT can be carried out with:

<pre>
    $record["firstname"] = "Bob"; 
    $record["lastname"] = "Smith"; 
    $record["created"] = time(); 
    $insertSQL = $conn->AutoExecute($rs, $record, 'INSERT'); 
</pre>

and an UPDATE with:
<pre>
    $record["firstname"] = "Caroline"; 
    $record["lastname"] = "Smith"; # Update Caroline's lastname from Miranda to Smith 
    $insertSQL = $conn->AutoExecute($rs, $record, 'UPDATE', 'id = 1'); 
</pre>
<p>
The rest of this section is out-of-date:
<p>ADOdb 1.31 and later supports two new recordset functions: GetUpdateSQL( ) and 
GetInsertSQL( ). This allow you to perform a "SELECT * FROM table query WHERE...", 
make a copy of the $rs-&gt;fields, modify the fields, and then generate the SQL to 
update or insert into the table automatically. 
<p> We show how the functions can be used when accessing a table with the following 
  fields: (ID, FirstName, LastName, Created). 
</p><p> Before these functions can be called, you need to initialize the recordset 
  by performing a select on the table. Idea and code by Jonathan Younger jyounger#unilab.com. 
 Since ADOdb 2.42, you can pass a  table name instead of a recordset into 
GetInsertSQL (in $rs), and it will generate an insert statement for that table.
</p><p> 
</p><pre>&lt;?<br>#==============================================<br># SAMPLE GetUpdateSQL() and GetInsertSQL() code<br>#==============================================<br>include('adodb.inc.php');<br>include('tohtml.inc.php');<br><br>#==========================<br># This code tests an insert<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = -1"; <br># Select an empty record from the database<br><br>$conn = &amp;ADONewConnection("mysql");  # create a connection<br>$conn-&gt;debug=1;<br>$conn-&gt;PConnect("localhost", "admin", "", "test"); # connect to MySQL, testdb<br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the empty recordset<br><br>$record = array(); # Initialize an array to hold the record data to insert<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Bob";<br>$record["lastNamE"] = "Smith";<br>$record["creaTed"] = time();<br><br># Pass the empty recordset and the array containing the data to insert<br># into the GetInsertSQL function. The function will process the data and return<br># a fully formatted insert sql statement.<br>$insertSQL = $conn-&gt;GetInsertSQL($rs, $record);<br><br>$conn-&gt;Execute($insertSQL); # Insert the record into the database<br><br>#==========================<br># This code tests an update<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = 1"; <br># Select a record to update<br><br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the existing record to update<br><br>$record = array(); # Initialize an array to hold the record data to update<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Caroline";<br>$record["LasTnAme"] = "Smith"; # Update Caroline's lastname from Miranda to Smith<br><br># Pass the single record recordset and the array containing the data to update<br># into the GetUpdateSQL function. The function will process the data and return<br># a fully formatted update sql statement with the correct WHERE clause.<br># If the data has not changed, no recordset is returned<br>$updateSQL = $conn-&gt;GetUpdateSQL($rs, $record);<br><br>$conn-&gt;Execute($updateSQL); # Update the record in the database<br>$conn-&gt;Close();<br>?&gt;<br></pre>
<a name="ADODB_FORCE_TYPE"></a>
<b>$ADODB_FORCE_TYPE</b><p>
The behaviour of AutoExecute(), GetUpdateSQL() and GetInsertSQL()  
when converting empty or null PHP variables to SQL is controlled by the
 global $ADODB_FORCE_TYPE variable. Set it to one of the values below. Default
  is ADODB_FORCE_VALUE (3):
</p><pre>0 = ignore empty fields. All empty fields in array are ignored.<br>1 = force null. All empty, php null and string 'null' fields are changed to sql NULL values.<br>2 = force empty. All empty, php null and string 'null' fields are changed to sql empty '' or 0 values.<br>3 = force value. Value is left as it is. Php null and string 'null' are set to sql NULL values and <br>    empty fields '' are set to empty '' sql values.<br><br>define('ADODB_FORCE_IGNORE',0);<br>define('ADODB_FORCE_NULL',1);<br>define('ADODB_FORCE_EMPTY',2);<br>define('ADODB_FORCE_VALUE',3);<br></pre>
<p>
Thanks to Niko (nuko#mbnet.fi) for the $ADODB_FORCE_TYPE code.
</p><p>
Note: the constant ADODB_FORCE_NULLS is obsolete since 4.52 and is ignored. Set $ADODB_FORCE_TYPE = ADODB_FORCE_NULL
for equivalent behaviour.
<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
</p><h3>Example 8: Implementing Scrolling with Next and Previous<a name="ex8"></a></h3>
<p> The following code creates a very simple recordset pager, where you can scroll 
  from page to page of a recordset.</p>
<pre>include_once('../adodb.inc.php');<br>include_once('../adodb-pager.inc.php');<br>session_start();<br><br>$db = NewADOConnection('mysql');<br><br>$db-&gt;Connect('localhost','root','','xphplens');<br><br>$sql = "select * from adoxyz ";<br><br>$pager = new ADODB_Pager($db,$sql);<br>$pager-&gt;Render($rows_per_page=5);</pre>
<p>This will create a basic record pager that looks like this: <a name="scr"></a> 
</p><p> 
<table bgcolor="beige" border="1">
  <tbody><tr> 
    <td> <a href="#scr"><code>|&lt;</code></a> &nbsp; <a href="#scr"><code>&lt;&lt;</code></a> 
      &nbsp; <a href="#scr"><code>&gt;&gt;</code></a> &nbsp; <a href="#scr"><code>&gt;|</code></a> 
      &nbsp; </td>
  </tr>
  <tr>
    <td><table bgcolor="white" border="1" cols="4" width="100%">
        <tbody><tr><th>ID</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Date Created</th>
        </tr><tr> 
          <td align="right">36&nbsp;</td>
          <td>Alan&nbsp;</td>
          <td>Turing&nbsp;</td>
          <td>Sat 06, Oct 2001&nbsp;</td>
        </tr>
        <tr> 
          <td align="right">37&nbsp;</td>
          <td>Serena&nbsp;</td>
          <td>Williams&nbsp;</td>
          <td>Sat 06, Oct 2001&nbsp;</td>
        </tr>
        <tr> 
          <td align="right">38&nbsp;</td>
          <td>Yat Sun&nbsp;</td>
          <td>Sun&nbsp;</td>
          <td>Sat 06, Oct 2001&nbsp;</td>
        </tr>
        <tr> 
          <td align="right">39&nbsp;</td>
          <td>Wai Hun&nbsp;</td>
          <td>See&nbsp;</td>
          <td>Sat 06, Oct 2001&nbsp;</td>
        </tr>
        <tr> 
          <td align="right">40&nbsp;</td>
          <td>Steven&nbsp;</td>
          <td>Oey&nbsp;</td>
          <td>Sat 06, Oct 2001&nbsp;</td>
        </tr>
      </tbody></table></td>
  </tr>
  <tr>
    <td><font size="-1">Page 8/10</font></td>
  </tr>
</tbody></table>
</p><p>The number of rows to display at one time is controled by the Render($rows) 
  method. If you do not pass any value to Render(), ADODB_Pager will default to 
  10 records per page. 
</p><p>You can control the column titles by modifying your SQL (supported by most 
  databases): 
</p><pre>$sql = 'select id as "ID", firstname as "First Name", <br>		  lastname as "Last Name", created as "Date Created" <br>		from adoxyz';</pre>
<p>The above code can be found in the <i>adodb/tests/testpaging.php</i> example 
  included with this release, and the class ADODB_Pager in <i>adodb/adodb-pager.inc.php</i>. 
  The ADODB_Pager code can be adapted by a programmer so that the text links can 
  be replaced by images, and the dull white background be replaced with more interesting 
  colors. 
</p><p>You can also allow display of html by setting $pager-&gt;htmlSpecialChars = false. 
</p><p>Some of the code used here was contributed by Iv&aacute;n Oliva and Cornel 
  G. </p>
<h3><a name="ex9"></a>Example 9: Exporting in CSV or Tab-Delimited Format</h3>
<p>We provide some helper functions to export in comma-separated-value (CSV) and 
  tab-delimited formats:</p>
<pre><b>include_once('/path/to/adodb/toexport.inc.php');</b><br>include_once('/path/to/adodb/adodb.inc.php');<br>
$db = &amp;NewADOConnection('mysql');<br>$db-&gt;Connect($server, $userid, $password, $database);<br><br>$rs = $db-&gt;Execute('select fname as "First Name", surname as "Surname" from table');<br><br>print "&lt;pre&gt;";<br>print <b>rs2csv</b>($rs); # return a string, CSV format<p>print '&lt;hr&gt;';<br><br>$rs-&gt;MoveFirst(); # note, some databases do not support MoveFirst<br>print <b>rs2tab</b>($rs,<i>false</i>); # return a string, tab-delimited<br>						 # false == suppress field names in first line</p>print '&lt;hr&gt;';<br>$rs-&gt;MoveFirst();<br><b>rs2tabout</b>($rs); # send to stdout directly (there is also an rs2csvout function)<br>print "&lt;/pre&gt;";<br><br>$rs-&gt;MoveFirst();<br>$fp = fopen($path, "w");<br>if ($fp) {<br>  <b>rs2csvfile</b>($rs, $fp); # write to file (there is also an rs2tabfile function)<br>  fclose($fp);<br>}<br></pre>
<p> Carriage-returns or newlines are converted to spaces. Field names are returned 
  in the first line of text. Strings containing the delimiter character are quoted 
  with double-quotes. Double-quotes are double-quoted again. This conforms to 
  Excel import and export guide-lines. 
</p><p>All the above functions take as an optional last parameter, $addtitles which 
  defaults to <i>true</i>. When set to <i>false</i> field names in the first line 
  are suppressed. <br>
</p><h3>Example 10: Recordset Filters<a name="ex10"></a></h3>
<p>Sometimes we want to pre-process all rows in a recordset before we use it. 
  For example, we want to ucwords all text in recordset. 
</p><pre>include_once('adodb/rsfilter.inc.php');<br>include_once('adodb/adodb.inc.php');<br><br>// ucwords() every element in the recordset<br>function do_ucwords(&amp;$arr,$rs)<br>{<br>	foreach($arr as $k =&gt; $v) {<br>		$arr[$k] = ucwords($v);<br>	}<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;PConnect('server','user','pwd','db');<br><br>$rs = $db-&gt;Execute('select ... from table');<br>$rs = <b>RSFilter</b>($rs,'do_ucwords');<br></pre>
<p>The <i>RSFilter</i> function takes 2 parameters, the recordset, and the name 
  of the <i>filter</i> function. It returns the processed recordset scrolled to 
  the first record. The <i>filter</i> function takes two parameters, the current 
  row as an array, and the recordset object. For future compatibility, you should 
  not use the original recordset object. </p>
<h3>Example 11:<a name="ex11"></a> Smart Transactions</h3>
The old way of doing transactions required you to use 
<pre>$conn-&gt;<b>BeginTrans</b>();<br>$ok = $conn-&gt;Execute($sql);<br>if ($ok) $ok = $conn-&gt;Execute($sql2);<br>if (!$ok) $conn-&gt;<b>RollbackTrans</b>();<br>else $conn-&gt;<b>CommitTrans</b>();<br></pre>
This is very complicated for large projects because you have to track the error 
status. Smart Transactions is much simpler. You start a smart transaction by calling 
StartTrans(): 
<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
CompleteTrans() detects when an SQL error occurs, and will Rollback/Commit as 
appropriate. To specificly force a rollback even if no error occured, use FailTrans(). 
Note that the rollback is done in CompleteTrans(), and not in FailTrans(). 
<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>if (!CheckRecords()) $conn-&gt;<strong>FailTrans</strong>();<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
<p>You can also check if a transaction has failed, using HasFailedTrans(), which 
  returns true if FailTrans() was called, or there was an error in the SQL execution. 
  Make sure you call HasFailedTrans() before you call CompleteTrans(), as it is 
  only works between StartTrans/CompleteTrans.
</p><p>Lastly, StartTrans/CompleteTrans is nestable, and only the outermost block 
  is executed. In contrast, BeginTrans/CommitTrans/RollbackTrans is NOT nestable. 
</p><pre>$conn-&gt;<strong>StartTrans</strong>();<br>$conn-&gt;Execute($sql);<br>  $conn-&gt;<strong>StartTrans</strong>();    <font color="#006600"># ignored</font>
  if (!CheckRecords()) $conn-&gt;FailTrans();
  $conn-&gt;<strong>CompleteTrans</strong>(); <font color="#006600"># ignored</font>
$conn-&gt;Execute($Sql2);
$conn-&gt;<strong>CompleteTrans</strong>();<br></pre>
<p>Note: Savepoints are currently not supported. 
</p><h2><a name="errorhandling"></a>Using Custom Error Handlers and PEAR_Error</h2>
<p>ADOdb supports PHP5 exceptions.  Just include <i>adodb-exceptions.inc.php</i> and you can now 
catch exceptions on errors as they occur.
</p><pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8://scott:bad-password@mytns/"); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
<p> ADOdb also provides two custom handlers which you can modify for your needs. The 
  first one is in the <b>adodb-errorhandler.inc.php</b> file. This makes use of 
  the standard PHP functions <a href="http://php.net/error_reporting">error_reporting</a> 
  to control what error messages types to display, and <a href="http://php.net/trigger_error">trigger_error</a> 
  which invokes the default PHP error handler. 
</p><p> Including the above file will cause <i>trigger_error($errorstring,E_USER_ERROR)</i> 
  to be called when<br>
  (a) Connect() or PConnect() fails, or <br>
  (b) a function that executes SQL statements such as Execute() or SelectLimit() 
  has an error.<br>
  (c) GenID() appears to go into an infinite loop. 
</p><p> The $errorstring is generated by ADOdb and will contain useful debugging information 
  similar to the error.log data generated below. This file adodb-errorhandler.inc.php 
  should be included before you create any ADOConnection objects. 
</p><p> If you define error_reporting(0), no errors will be passed to the error handler. 
  If you set error_reporting(E_ALL), all errors will be passed to the error handler. 
  You still need to use <b>ini_set("display_errors", "0" or "1")</b> to control 
  the display of errors. 
</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # pass any error messages triggered to error handler<br>include('adodb-errorhandler.inc.php');</b>
include('adodb.inc.php');
include('tohtml.inc.php');
$c = NewADOConnection('mysql');
$c-&gt;PConnect('localhost','root','','northwind');
$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
if ($rs) rs2html($rs);
?&gt;
</pre>
<p> If you want to log the error message, you can do so by defining the following 
  optional constants ADODB_ERROR_LOG_TYPE and ADODB_ERROR_LOG_DEST. ADODB_ERROR_LOG_TYPE 
  is the error log message type (see <a href="http://php.net/error_log">error_log</a> 
  in the PHP manual). In this case we set it to 3, which means log to the file 
  defined by the constant ADODB_ERROR_LOG_DEST. 
</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # report all errors<br>ini_set("display_errors", "0"); # but do not echo the errors<br>define('ADODB_ERROR_LOG_TYPE',3);<br>define('ADODB_ERROR_LOG_DEST','C:/errors.log');<br>include('adodb-errorhandler.inc.php');</b>
include('adodb.inc.php');
include('tohtml.inc.php');

$c = NewADOConnection('mysql');
$c-&gt;PConnect('localhost','root','','northwind');
$rs=$c-&gt;Execute('select * from productsz'); ## invalid table productsz
if ($rs) rs2html($rs);
?&gt;
</pre>
The following message will be logged in the error.log file: 
<pre>(2001-10-28 14:20:38) mysql error: [1146: Table 'northwind.productsz' doesn't exist] in<br> EXECUTE("select * from productsz")<br></pre>
<h3>PEAR_ERROR</h3>
The second error handler is <b>adodb-errorpear.inc.php</b>. This will create a 
PEAR_Error derived object whenever an error occurs. The last PEAR_Error object 
created can be retrieved using ADODB_Pear_Error(). 
<pre>&lt;?php<br><b>include('adodb-errorpear.inc.php');</b>
include('adodb.inc.php');
include('tohtml.inc.php');
$c = NewADOConnection('mysql');
$c-&gt;PConnect('localhost','root','','northwind');
$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
if ($rs) rs2html($rs);
else {
	<b>$e = ADODB_Pear_Error();<br>	echo '&lt;p&gt;',$e-&gt;message,'&lt;/p&gt;';</b>
}
?&gt;
</pre>
<p> You can use a PEAR_Error derived class by defining the constant ADODB_PEAR_ERROR_CLASS 
  before the adodb-errorpear.inc.php file is included. For easy debugging, you 
  can set the default error handler in the beginning of the PHP script to PEAR_ERROR_DIE, 
  which will cause an error message to be printed, then halt script execution: 
</p><pre>include('PEAR.php');<br>PEAR::setErrorHandling('PEAR_ERROR_DIE');<br></pre>
<p> Note that we do not explicitly return a PEAR_Error object to you when an error 
  occurs. We return false instead. You have to call ADODB_Pear_Error() to get 
  the last error or use the PEAR_ERROR_DIE technique. 
</p>
<h3>MetaError and MetaErrMsg</h3>
 <p>If you need error messages that work across multiple databases, then use <a href="#metaerror">MetaError()</a>, which returns a virtualized error number, based on PEAR DB's error number system, and <a href=<a href="#metaerrmsg">MetaErrMsg()</a>.

<h4>Error Messages</h4>
<p>Error messages are outputted using the static method ADOConnnection::outp($msg,$newline=true). 
  By default, it sends the messages to the client. You can override this to perform 
  error-logging. 
</p><h2><a name="dsn"></a> Data Source Names</h2>
<p>We now support connecting using PEAR style DSN's. A DSN is a connection string 
  of the form:</p>
<p>$dsn = <i>"$driver://$username:$password@$hostname/$databasename"</i>;</p>
<p>An example:</p>
<pre>   $username = 'root';<br>   $password = '';<br>   $hostname = 'localhost';<br>   $databasename = 'xphplens';<br>   $driver = 'mysql';<br>   $dsn = "$driver://$username:$password@$hostname/$databasename"<br>   $db = NewADOConnection(); <br>   # DB::Connect($dsn) also works if you include 'adodb/adodb-pear.inc.php' at the top<br>   $rs = $db-&gt;query('select firstname,lastname from adoxyz');<br>   $cnt = 0;<br>   while ($arr = $rs-&gt;fetchRow()) {<br>		print_r($arr); print "&lt;br&gt;";<br>   }</pre>
   <p></p>
<p>   <a href="#dsnsupport">More info and connection examples</a> on the DSN format.

</p><h2><a name="pear"></a>PEAR Compatibility</h2>
  We support DSN's (see above), and the following functions:
 <pre><b> DB_Common</b>
 	query - returns PEAR_Error on error
	limitQuery - return PEAR_Error on error
	prepare - does not return PEAR_Error on error
	execute - does not return PEAR_Error on error
	setFetchMode - supports ASSOC and ORDERED
	errorNative
	quote
	nextID
	disconnect
	
	getOne
	getAssoc
	getRow
	getCol
	
<b> DB_Result</b>
 	numRows - returns -1 if not supported
	numCols
	fetchInto - does not support passing of fetchmode
	fetchRows - does not support passing of fetchmode
	free
</pre>
<h2><a name="caching"></a>Caching of Recordsets</h2>
<p>ADOdb now supports caching of recordsets using the CacheExecute( ), CachePageExecute( 
  ) and CacheSelectLimit( ) functions. There are similar to the non-cache functions, 
  except that they take a new first parameter, $secs2cache. 
</p><p> An example: 
</p><pre><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$ADODB_CACHE_DIR = '/usr/ADODB_cache';<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;CacheExecute(15,$sql);</font></pre>
<p><font> The first parameter is the number of seconds to cache 
  the query. Subsequent calls to that query will used the cached version stored 
  in $ADODB_CACHE_DIR. To force a query to execute and flush the cache, call CacheExecute() 
  with the first parameter set to zero. Alternatively, use the CacheFlush($sql) 
  call. </font></p>
<p><font>For the sake of security, we recommend you set <i>register_globals=off</i> 
  in php.ini if you are using $ADODB_CACHE_DIR.</font></p>
<p>In ADOdb 1.80 onwards, the secs2cache parameter is optional in CacheSelectLimit() 
  and CacheExecute(). If you leave it out, it will use the $connection-&gt;cacheSecs 
  parameter, which defaults to 60 minutes. 
</p><pre>	$conn-&gt;Connect(...);<br>	$conn-&gt;cacheSecs = 3600*24; # cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></pre>
<p>Please note that magic_quotes_runtime should be turned off. <a href="http://phplens.com/lens/lensforum/msgs.php?LeNs#LensBM_forummsg">More 
  info</a>, and do not change $ADODB_FETCH_MODE (or SetFetchMode) 
  as the cached recordset will use the $ADODB_FETCH_MODE set when the query was executed. <font> 
<h2><a name="pivot"></a>Pivot Tables</h2>
</font> </p><p><font>Since ADOdb 2.30, we support the generation of 
SQL to create pivot tables, also known as cross-tabulations. For further explanation 
read this DevShed <a href="http://www.devshed.com/Server_Side/MySQL/MySQLWiz/">Cross-Tabulation 
tutorial</a>. We assume that your database supports the SQL case-when expression. </font></p> 
<font> 
<p>In this example, we will use the Northwind database from Microsoft. In the 
  database, we have a products table, and we want to analyze this table by <i>suppliers 
  versus product categories</i>. We will place the suppliers on each row, and 
  pivot on categories. So from the table on the left, we generate the pivot-table 
  on the right:</p>
</font> 
<table align="center" border="0" cellpadding="2" cellspacing="2">
  <tbody><tr>
	<td>
	  <table align="center" border="1" cellpadding="2" cellspacing="2" width="142">
		<tbody><tr> 
		  <td><i>Supplier</i></td>
		  <td><i>Category</i></td>
		</tr>
		<tr> 
		  <td>supplier1</td>
		  <td>category1</td>
		</tr>
		<tr> 
		  <td>supplier2</td>
		  			<td>category1</td>
		</tr>
		<tr> 
		  			<td>supplier2</td>
		  <td>category2</td>
		</tr>
	  </tbody></table>
	</td>
	<td> <font face="Courier New, Courier, mono">--&gt;</font></td>
	<td>
	  <table align="center" border="1" cellpadding="2" cellspacing="2">
		<tbody><tr> 
		  <td>&nbsp;</td>
		  <td><i>category1</i></td>
		  <td><i>category2</i></td>
		  <td><i>total</i></td>
		</tr>
		<tr> 
		  <td><i>supplier1</i></td>
		  <td align="right">1</td>
		  <td align="right">0</td>
		  <td align="right">1</td>
		</tr>
		<tr> 
		  <td><i>supplier2</i></td>
		  <td align="right">1</td>
		  <td align="right">1</td>
		  <td align="right">2</td>
		</tr>
	  </tbody></table>
	</td>
  </tr>
</tbody></table>
<font> 
</font><p><font>The following code will generate the SQL for a cross-tabulation: 
</font></p><pre><font># Query the main "product" table<br># Set the rows to SupplierName<br># and the columns to the values of Categories<br># and define the joins to link to lookup tables <br># "categories" and "suppliers"<br>#<br> include "adodb/pivottable.inc.php";<br> $sql = PivotTableSQL(<br> 	$gDB,                                      # adodb connection<br> 	'products p ,categories c ,suppliers s',   # tables<br>	'SupplierName',                             # rows (multiple fields allowed)<br>	'CategoryName',                            # column to pivot on <br>	'p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID' # joins/where<br>);<br></font></pre>
 
<p><font> This will generate the following SQL:</font></p>
<p><code><font size="2">SELECT SupplierName, <br>
  SUM(CASE WHEN CategoryName='Beverages' THEN 1 ELSE 0 END) AS "Beverages", 
  <br>
  SUM(CASE WHEN CategoryName='Condiments' THEN 1 ELSE 0 END) AS "Condiments", 
  <br>
  SUM(CASE WHEN CategoryName='Confections' THEN 1 ELSE 0 END) AS "Confections", 
  <br>
  SUM(CASE WHEN CategoryName='Dairy Products' THEN 1 ELSE 0 END) AS "Dairy 
  Products", <br>
  SUM(CASE WHEN CategoryName='Grains/Cereals' THEN 1 ELSE 0 END) AS "Grains/Cereals", 
  <br>
  SUM(CASE WHEN CategoryName='Meat/Poultry' THEN 1 ELSE 0 END) AS "Meat/Poultry", 
  <br>
  SUM(CASE WHEN CategoryName='Produce' THEN 1 ELSE 0 END) AS "Produce", 
  <br>
  SUM(CASE WHEN CategoryName='Seafood' THEN 1 ELSE 0 END) AS "Seafood", 
  <br>
  SUM(1) as Total <br>
  FROM products p ,categories c ,suppliers s WHERE p.CategoryID = c.CategoryID 
  and s.SupplierID= p.SupplierID <br>
  GROUP BY SupplierName</font></code></p>
<p> You can also pivot on <i>numerical columns</i> and <i>generate totals</i> 
	by using ranges. <font>This code was revised in ADODB 2.41 
	and is not backward compatible.</font> The second example shows this:</p>
<pre> $sql = PivotTableSQL(<br> 	$gDB,                                       # adodb connection<br> 	'products p ,categories c ,suppliers s',    # tables<br>	'SupplierName',                              #<font> rows (multiple fields allowed)</font>
   array(                                       # column ranges
	' 0 '      =&gt; 'UnitsInStock &lt;= 0',
	"1 to 5"   =&gt; '0 &lt; UnitsInStock and UnitsInStock &lt;= 5',
	"6 to 10"  =&gt; '5 &lt; UnitsInStock and UnitsInStock &lt;= 10',
	"11 to 15" =&gt; '10 &lt; UnitsInStock and UnitsInStock &lt;= 15',
	"16+"      =&gt; '15 &lt; UnitsInStock'
	),
	' p.CategoryID = c.CategoryID and s.SupplierID= p.SupplierID', # joins/where
	'UnitsInStock',                             # sum this field
	'Sum '                                      # sum label prefix
);
</pre> 
<p>Which generates: </p>
<p> <code> <font size="2">SELECT SupplierName, <br>
	SUM(CASE WHEN UnitsInStock &lt;= 0 THEN UnitsInStock ELSE 0 END) AS "Sum 
	0 ", <br>
	SUM(CASE WHEN 0 &lt; UnitsInStock and UnitsInStock &lt;= 5 THEN UnitsInStock 
	ELSE 0 END) AS "Sum 1 to 5",<br>
	SUM(CASE WHEN 5 &lt; UnitsInStock and UnitsInStock &lt;= 10 THEN UnitsInStock 
	ELSE 0 END) AS "Sum 6 to 10",<br>
	SUM(CASE WHEN 10 &lt; UnitsInStock and UnitsInStock &lt;= 15 THEN UnitsInStock 
	ELSE 0 END) AS "Sum 11 to 15", <br>
	SUM(CASE WHEN 15 &lt; UnitsInStock THEN UnitsInStock ELSE 0 END) AS "Sum 
	16+", <br>
	SUM(UnitsInStock) AS "Sum UnitsInStock", <br>
	SUM(1) as Total,<br>
	FROM products p ,categories c ,suppliers s WHERE p.CategoryID = c.CategoryID 
	and s.SupplierID= p.SupplierID <br>
	GROUP BY SupplierName</font></code><font size="2"><br>
	</font> </p>
<font><hr />
<h1>Class Reference<a name="ref"></a></h1>
<p>Function parameters with [ ] around them are optional.</p>
</font> 
<h2>Global Variables</h2>
<h3><font><a name="adodb_countrecs"></a></font>$ADODB_COUNTRECS</h3>
<p>If the database driver API does not support counting the number of records 
	returned in a SELECT statement, the function RecordCount() is emulated when 
	the global variable $ADODB_COUNTRECS is set to true, which is the default. 
	We emulate this by buffering the records, which can take up large amounts 
	of memory for big recordsets. Set this variable to false for the best performance. 
	This variable is checked every time a query is executed, so you can selectively 
	choose which recordsets to count.</p>
<h3><font><a name="adodb_cache_dir"></a>$ADODB_CACHE_DIR</font></h3>
<font> 
<p>If you are using recordset caching, this is the directory to save your recordsets 
  in. Define this before you call any caching functions such as CacheExecute( 
  ). We recommend setting <i>register_globals=off</i> in php.ini if you use this 
  feature for security reasons.</p>
<p>If you are using Unix and apache, you might need to set your cache directory 
  permissions to something similar to the following:</p>
</font> 
<p>chown -R apache /path/to/adodb/cache<br>
  chgrp -R apache /path/to/adodb/cache </p>
<h3><font><a name="adodb_ansi_padding_off"></a>$ADODB_ANSI_PADDING_OFF</font></h3>
<p><font>Determines whether to right trim CHAR fields (and also VARCHAR for ibase/firebird).
Set to true to trim. Default is false. Currently works for oci8po, ibase and firebird 
drivers. Added in ADOdb 4.01.
</font></p><h3><font><a name="adodb_lang"></a>$ADODB_LANG</font></h3>
<p><font>Determines the language used in MetaErrorMsg(). The default is 'en', for English. 
To find out what languages are supported, see the files 
in adodb/lang/adodb-$lang.inc.php, where $lang is the supported langauge.
</font></p><h3><font><a name="adodb_fetch_mode"></a>$ADODB_FETCH_MODE</font></h3>
<p><font>This is a global variable that determines how arrays are retrieved by recordsets. 
  The recordset saves this value on creation (eg. in Execute( ) or SelectLimit( 
  )), and any subsequent changes to $ADODB_FETCH_MODE have no affect on existing 
  recordsets, only on recordsets created in the future.</font></p>
 <p><font>The following constants are defined:</font></p>
 <p><font>define('ADODB_FETCH_DEFAULT',0);<br>
  define('ADODB_FETCH_NUM',1);<br>
  define('ADODB_FETCH_ASSOC',2);<br>
  define('ADODB_FETCH_BOTH',3); </font></p>
<font> 
</font><p><font> An example: 
</font></p><pre><font>	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_NUM;<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_ASSOC;<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i>
</font></pre>
<p><font> As you can see in the above example, both recordsets store and use different 
	fetch modes based on the $ADODB_FETCH_MODE setting when the recordset was 
	created by Execute().</font></p>
<p><font>If no fetch mode is predefined, the fetch mode defaults to ADODB_FETCH_DEFAULT. 
	The behaviour of this default mode varies from driver to driver, so do not 
	rely on ADODB_FETCH_DEFAULT. For portability, we recommend sticking to ADODB_FETCH_NUM 
	or ADODB_FETCH_ASSOC. Many drivers do not support ADODB_FETCH_BOTH.</font></p>
<p><font><strong>SetFetchMode Function</strong></font></p>
<p><font>If you have multiple connection objects, and want to have different fetch modes for each 
connection, then use <a href="#setfetchmode">SetFetchMode</a>. 
	Once this function is called for a connection object, that connection object 
	will ignore the global variable $ADODB_FETCH_MODE and will use the internal 
	fetchMode property exclusively.</font></p>
<pre><font>	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i></font></pre>
<p><font>To retrieve the previous fetch mode, you can use check the $db-&gt;fetchMode 
	property, or use the return value of SetFetchMode( ). 
</font></p><p><font><strong><a name="adodb_assoc_case"></a>ADODB_ASSOC_CASE</strong></font></p>
<p><font>You can control the associative fetch case for certain drivers which behave 
	differently. For the sybase, oci8po, mssql, odbc and ibase drivers and all 
	drivers derived from them, ADODB_ASSOC_CASE will by default generate recordsets 
	where the field name keys are lower-cased. Use the constant ADODB_ASSOC_CASE 
	to change the case of the keys. There are 3 possible values:</font></p>
<p><font>0 = assoc lowercase field names. $rs-&gt;fields['orderid']<br>
	1 = assoc uppercase field names. $rs-&gt;fields['ORDERID']<br>
	2 = use native-case field names. $rs-&gt;fields['OrderID'] -- this is the 
	default since ADOdb 2.90</font></p>
<p><font>To use it, declare it before you incldue adodb.inc.php.</font></p>
<p><font>define('ADODB_ASSOC_CASE', 2); # use native-case for ADODB_FETCH_ASSOC<br>
	include('adodb.inc.php'); </font></p>
<h3><font><a name="force_type"></a>$ADODB_FORCE_TYPE</font></h3>
<p><font>See the <a href="#ADODB_FORCE_TYPE">GetUpdateSQL tutorial</a>.
</font></p>
<h3><font><a name="adodb_auto_quote"></a>$ADODB_QUOTE_FIELDNAMES</font></h3>
<p><font>Auto-quotes field names when using AutoExecute() when set to true. </font>
<p>&nbsp;</p>
<hr />
<h2><font>ADOConnection<a name="adoconnection"></a></font></h2>
<p><font>Object that performs the connection to the database, executes SQL statements 
	and has a set of utility functions for standardising the format of SQL statements 
	for issues such as concatenation and date formats.</font></p>
<h3><font>ADOConnection Fields</font></h3>
<p><font><b>databaseType</b>: Name of the database system we are connecting to. Eg. 
	<b>odbc</b> or <b>mssql</b> or <b>mysql</b>.</font></p>
<p><font><b>dataProvider</b>: The underlying mechanism used to connect to the database. 
	Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</font></p>
<p><font><b>host: </b>Name of server or data source name (DSN) to connect to.</font></p>
<p><font><b>database</b>: Name of the database or to connect to. If ado is used, it 
	will hold the ado data provider.</font></p>
<p><font><b>user</b>: Login id to connect to database. Password is not saved for security 
	reasons.</font></p>
<p><font><b>raiseErrorFn</b>: Allows you to define an error handling function. See adodb-errorhandler.inc.php 
	for an example.</font></p>
<p><font><b>debug</b>: Set to <i>true</i> to make debug statements to appear.</font></p>
<p><font><b>concat_operator</b>: Set to '+' or '||' normally. The operator used to concatenate 
	strings in SQL. Used by the <b><a href="#concat">Concat</a></b> function.</font></p>
<p><font><b>fmtDate</b>: The format used by the <b><a href="#dbdate">DBDate</a></b> 
	function to send dates to the database. is '#Y-m-d#' for Microsoft Access, 
	and ''Y-m-d'' for MySQL.</font></p>
<p><font><b>fmtTimeStamp: </b>The format used by the <b><a href="#dbtimestamp">DBTimeStamp</a></b> 
	function to send timestamps to the database. </font></p>
<p><font><b>true</b>: The value used to represent true.Eg. '.T.'. for Foxpro, '1' for 
	Microsoft SQL.</font></p>
<p><font><b>false: </b> The value used to represent false. Eg. '.F.'. for Foxpro, '0' 
	for Microsoft SQL.</font></p>
<p><font><b>replaceQuote</b>: The string used to escape quotes. Eg. double single-quotes 
	for Microsoft SQL, and backslash-quote for MySQL. Used by <a href="#qstr">qstr</a>.</font></p>
<p><font><b>autoCommit</b>: indicates whether automatic commit is enabled. Default is 
	true.</font></p>
<p><font><b>charSet</b>: set the default charset to use. Currently only interbase/firebird supports 
	this.</font></p>
<p><font><b>dialect</b>: set the default sql dialect to use. Currently only interbase/firebird 
	supports this.</font></p>
	<p><font><b>role</b>: set the role. Currently only interbase/firebird 
	supports this.</font></p>
<p><font><b>metaTablesSQL</b>: SQL statement to return a list of available tables. Eg. 
	<i>SHOW TABLES</i> in MySQL.</font></p>
<p><font><b>genID</b>: The latest id generated by GenID() if supported by the database.</font></p>
<p><font><b>cacheSecs</b>: The number of seconds to cache recordsets if CacheExecute() 
	or CacheSelectLimit() omit the $secs2cache parameter. Defaults to 60 minutes.</font></p>
<p><font><b>sysDate</b>: String that holds the name of the database function to call 
	to get the current date. Useful for inserts and updates.</font></p>
<p><font><b>sysTimeStamp</b>: String that holds the name of the database function to 
	call to get the current timestamp/datetime value.</font></p>
<p><font><b>leftOuter</b>: String that holds operator for left outer join, if known. 
	Otherwise set to false.</font></p>
<p><font><b>rightOuter</b>: String that holds operator for left outer join, if known. 
	Otherwise set to false.</font></p>
<p><font><b>ansiOuter</b>: Boolean that if true indicates that ANSI style outer joins 
	are permitted. Eg. <i>select * from table1 left join table2 on p1=p2.</i></font></p>
<p><font><b>connectSID</b>: Boolean that indicates whether to treat the $database parameter 
	in connects as the SID for the oci8 driver. Defaults to false. Useful for 
	Oracle 8.0.5 and earlier.</font></p>
<p><font><b>autoRollback</b>: Persistent connections are auto-rollbacked in PConnect( 
	) if this is set to true. Default is false.</font></p>
<hr />
<h3><font>ADOConnection Main Functions</font></h3>
<p><font><b>ADOConnection( )</b></font></p>
<p><font>Constructor function. Do not call this directly. Use ADONewConnection( ) instead.</font></p>
<p><font><b>Connect<a name="connect"></a>($host,[$user],[$password],[$database])</b></font></p>
<p><font>Non-persistent connect to data source or server $<b>host</b>, using userid 
	$<b>user </b>and password $<b>password</b>. If the server supports multiple 
	databases, connect to database $<b>database</b>. </font></p>
<p><font>Returns true/false depending on connection success. Since 4.23, null is returned if the extension is not loaded.</font></p>
<p><font>ADO Note: If you are using a Microsoft ADO and not OLEDB, you can set the $database 
	parameter to the OLEDB data provider you are using.</font></p>
<p><font>PostgreSQL: An alternative way of connecting to the database is to pass the 
	standard PostgreSQL connection string in the first parameter $host, and the 
	other parameters will be ignored.</font></p>
<p><font>For Oracle and Oci8, there are two ways to connect. First is to use the TNS 
	name defined in your local tnsnames.ora (or ONAMES or HOSTNAMES). Place the 
	name in the $database field, and set the $host field to false. Alternatively, 
	set $host to the server, and $database to the database SID, this bypassed 
	tnsnames.ora. 
</font></p><p><font>Examples: 
</font></p><pre><font> # $oraname in tnsnames.ora/ONAMES/HOSTNAMES<br> $conn-&gt;Connect(false, 'scott', 'tiger', $oraname); <br> $conn-&gt;Connect('server:1521', 'scott', 'tiger', 'ServiceName'); # bypass tnsnames.ora</font></pre>
<p><font>There are many examples of connecting to a database.
See  <a href="#connect_ex">Connection Examples</a> for many examples.

</font></p><p><font><b>PConnect<a name="pconnect"></a>($host,[$user],[$password],[$database])</b></font></p>
<p><font>Persistent connect to data source or server $<b>host</b>, using userid $<b>user</b> 
	and password $<b>password</b>. If the server supports multiple databases, 
	connect to database $<b>database</b>.</font></p>
<p><font>We now perform a rollback on persistent connection for selected databases since 
	2.21, as advised in the PHP manual. See change log or source code for which 
	databases are affected. 
</font></p><p><font>Returns true/false depending on connection. Since 4.23, 0 is returned if the extension is not loaded.
See Connect( ) above for more info.</font></p>
<p><font>Since ADOdb 2.21, we also support autoRollback. If you set:</font></p>
 
<pre> $conn = &amp;NewADOConnection('mysql');<br> $conn-&gt;autoRollback = true; # default is false<br> $conn-&gt;PConnect(...); # rollback here</pre>
<p> Then when doing a persistent connection with PConnect( ), ADOdb will 
  perform a rollback first. This is because it is documented that PHP is 
  not guaranteed to rollback existing failed transactions when 
  persistent connections are used. This is implemented in Oracle, 
  MySQL, PgSQL, MSSQL, ODBC currently. 
</p><p>Since ADOdb 3.11, you can force non-persistent 
connections even if PConnect is called by defining the constant 
ADODB_NEVER_PERSIST  before you call PConnect.
</p><p>
Since 4.23, null is returned if the extension is not loaded.
</p><p><b>NConnect<a name="nconnect"></a>($host,[$user],[$password],[$database])</b></p>
<p>Always force a new connection. In contrast, PHP sometimes reuses connections 
	when you use Connect() or PConnect(). Currently works only on mysql (PHP 4.3.0 
	or later), postgresql and oci8-derived drivers. For other drivers, NConnect() works like 
	Connect().</p>
<p><font><b>IsConnected( )<a name="isconnected"></a></b></font></p>
<p>
<font>Returns true if connected to database. Added in 4.53.

</font></p><p><font><b>Execute<a name="execute"></a>($sql,$inputarr=false)</b></font></p>
<p><font>Execute SQL statement $<b>sql</b> and return derived class of ADORecordSet 
	if successful. Note that a record set is always returned on success, even 
	if we are executing an insert or update statement. You can also pass in $sql a statement prepared 
	in <a href="#prepare">Prepare()</a>.</font></p>
<p><font>Returns derived class of ADORecordSet. Eg. if connecting via mysql, then ADORecordSet_mysql 
	would be returned. False is returned if there was an error in executing the 
	sql.</font></p>
<p><font>The $inputarr parameter can be used for binding variables to parameters. Below 
	is an Oracle example:</font></p>
<pre><font> $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=:val", array('val'=&gt; $val));<br> </font></pre>
<p><font>Another example, using ODBC,which uses the ? convention:</font></p>
<pre><font>  $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=?", array($val));<br></font></pre>
<font><a name="binding"></a>
<i>Binding variables</i></font><p>
<font>Variable binding speeds the compilation and caching of SQL statements, leading 
to higher performance. Currently Oracle, Interbase and ODBC supports variable binding. 
Interbase/ODBC style ? binding is emulated in databases that do not support binding. 
Note that you do not have to quote strings if you use binding.
</font></p><p><font> Variable binding in the odbc, interbase and oci8po drivers. 
</font></p><pre><font>$rs = $db-&gt;Execute('select * from table where val=?', array('10'));<br></font></pre>
<font>Variable binding in the oci8 driver: 
</font><pre><font>$rs = $db-&gt;Execute('select name from table where val=:key', <br>  array('key' =&gt; 10));<br></font></pre>
<font><a name="bulkbind"></a>
<i>Bulk binding</i>
</font><p><font>Since ADOdb 3.80, we support bulk binding in Execute(), in which you pass in a 2-dimensional array to
be bound to an INSERT/UPDATE or DELETE statement.
</font></p><pre><font>$arr = array(<br>	array('Ahmad',32),<br>	array('Zulkifli', 24),<br>	array('Rosnah', 21)<br>	);<br>$ok = $db-&gt;Execute('insert into table (name,age) values (?,?)',$arr);<br></font></pre>
<p><font>This provides very high performance as the SQL statement is prepared first. 
The prepared statement is executed repeatedly for each array row until all rows are completed, 
or until the first error. Very useful for importing data.

</font></p><p><font><b>CacheExecute<a name="cacheexecute"></a>([$secs2cache,]$sql,$inputarr=false)</b></font></p>
<p><font>Similar to Execute, except that the recordset is cached for $secs2cache seconds 
	in the $ADODB_CACHE_DIR directory, and $inputarr only accepts 1-dimensional arrays. 
	If CacheExecute() is called again with the same $sql, $inputarr, 
	and also the same database, same userid, and the cached recordset 
	has not expired, the cached recordset is returned. 
</font></p><pre><font>  include('adodb.inc.php'); <br>  include('tohtml.inc.php');<br>  $ADODB_<b>CACHE_DIR</b> = '/usr/local/ADOdbcache';<br>  $conn = &amp;ADONewConnection('mysql'); <br>  $conn-&gt;PConnect('localhost','userid','password','database');<br>  $rs = $conn-&gt;<b>CacheExecute</b>(15, 'select * from table'); # cache 15 secs<br>  rs2html($rs); /* recordset to html table */  <br></font></pre>
<p><font> Alternatively, since ADOdb 1.80, the $secs2cache parameter is optional:</font></p>
<pre><font>	$conn-&gt;Connect(...);<br>   	$conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></font></pre>
<font>If $secs2cache is omitted, we use the value 
in $connection-&gt;cacheSecs (default is 3600 seconds, or 1 hour). Use CacheExecute() 
only with SELECT statements. 
</font><p><font>Performance note: I have done some benchmarks and found that they vary so greatly 
	that it's better to talk about when caching is of benefit. When your database 
	server is <i>much slower </i>than your Web server or the database is <i>very 
	overloaded </i>then ADOdb's caching is good because it reduces the load on 
	your database server. If your database server is lightly loaded or much faster 
	than your Web server, then caching could actually reduce performance. </font></p>
<p><font><b>ExecuteCursor<a name="executecursor"></a>($sql,$cursorName='rs',$parameters=false)</b></font></p>
<p><font>Execute an Oracle stored procedure, and returns an Oracle REF cursor variable as 
	a regular ADOdb recordset. Does not work with any other database except oci8. 
	Thanks to Robert Tuttle for the design.
</font></p><pre><font>    $db = ADONewConnection("oci8"); <br>    $db-&gt;Connect("foo.com:1521", "uid", "pwd", "FOO"); <br>    $rs = $db-&gt;ExecuteCursor("begin :cursorvar := getdata(:param1); end;", <br>					'cursorvar',<br>					array('param1'=&gt;10)); <br>    # $rs is now just like any other ADOdb recordset object<br>    rs2html($rs);</font></pre>
<p><font>ExecuteCursor() is a helper function that does the following internally: 
</font></p><pre><font>	$stmt = $db-&gt;Prepare("begin :cursorvar := getdata(:param1); end;", true); <br>	$db-&gt;Parameter($stmt, $cur, 'cursorvar', false, -1, OCI_B_CURSOR);<br>	$rs = $db-&gt;Execute($stmt,$bindarr);<br></font></pre>
<p><font>ExecuteCursor only accepts 1 out parameter. So if you have 2 out parameters, use:
</font></p><pre><font>	$vv = 'A%';<br>	$stmt = $db-&gt;PrepareSP("BEGIN list_tabs(:crsr,:tt); END;");<br>	$db-&gt;OutParameter($stmt, $cur, 'crsr', -1, OCI_B_CURSOR);<br>	$db-&gt;OutParameter($stmt, $vv, 'tt', 32); # return varchar(32)<br>	$arr = $db-&gt;GetArray($stmt);<br>	print_r($arr);<br>	echo " val = $vv"; ## outputs 'TEST'<br></font></pre>
<font>for the following PL/SQL:
</font><pre><font>	TYPE TabType IS REF CURSOR RETURN TAB%ROWTYPE;<br><br>	PROCEDURE list_tabs(tabcursor IN OUT TabType,tablenames IN OUT VARCHAR) IS<br>	BEGIN<br>		OPEN tabcursor FOR SELECT * FROM TAB WHERE tname LIKE tablenames;<br>		tablenames := 'TEST';<br>	END list_tabs;<br></font></pre>
<p><font><b>SelectLimit<a name="selectlimit"></a>($sql,$numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
<p><font>Returns a recordset if successful. Returns false otherwise. Performs a select 
	statement, simulating PostgreSQL's SELECT statement, LIMIT $numrows OFFSET 
	$offset clause.</font></p>
<p><font>In PostgreSQL, SELECT * FROM TABLE LIMIT 3 will return the first 3 records 
	only. The equivalent is <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',3)</code>. 
	This functionality is simulated for databases that do not possess this feature.</font></p>
<p><font>And SELECT * FROM TABLE LIMIT 3 OFFSET 2 will return records 3, 4 and 5 (eg. 
	after record 2, return 3 rows). The equivalent in ADOdb is <code>$connection-&gt;SelectLimit('SELECT 
	* FROM TABLE',3,2)</code>.</font></p>
<p><font>Note that this is the <i>opposite</i> of MySQL's LIMIT clause. You can also 
	set <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',-1,10)</code> to 
	get rows 11 to the last row.</font></p>
<p><font>The last parameter $inputarr is for databases that support variable binding 
	such as Oracle oci8. This substantially reduces SQL compilation overhead. 
	Below is an Oracle example:</font></p>
<pre><font> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=:val", 100,-1,array('val'=&gt; $val));<br> </font></pre>
<p><font>The oci8po driver (oracle portable driver) uses the more standard bind variable 
	of ?: 
</font></p><pre><font> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=?", 100,-1,array('val'=&gt; $val));<br></font></pre>
<p><font> 
</font></p><p><font>Ron Wilson reports that SelectLimit does not work with UNIONs. 
</font></p><p><font><b>CacheSelectLimit<a name="cacheselectlimit"></a>([$secs2cache,] $sql, $numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
<p><font>Similar to SelectLimit, except that the recordset returned is cached for $secs2cache 
	seconds in the $ADODB_CACHE_DIR directory. </font></p>
<p><font>Since 1.80, $secs2cache has been optional, and you can define the caching time 
	in $connection-&gt;cacheSecs.</font></p>
 
<pre><font>	$conn-&gt;Connect(...);<br>   $conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheSelectLimit('select * from table',10);</font></pre>
<font> 
</font><p><font><b>CacheFlush<a name="cacheflush"></a>($sql=false,$inputarr=false)</b></font></p>
<p><font>Flush (delete) any cached recordsets for the SQL statement $sql in $ADODB_CACHE_DIR. 
</font></p><p><font>If no parameter is passed in, then all adodb_*.cache files are deleted. 
</font></p>
  <p>CacheSelectLimit() rewrites the SQL query, so you won't be able to pass the SQL to CacheFlush. In this case,
   to flush the cached SQL recordset returned by CacheSelectLimit(), set $secs2cache to -1:
<pre>
	$db->CacheSelectLimit(-1, $sql, $nrows);
</pre>
<p><font> If you want to flush all cached recordsets manually, execute the following 
	PHP code (works only under Unix): <br>
	<code> &nbsp; system("rm -f `find ".$ADODB_CACHE_DIR." -name 
	adodb_*.cache`");</code></font></p>
<p><font>For general cleanup of all expired files, you should use <a href="http://www.superscripts.com/tutorial/crontab.html">crontab</a> 
	on Unix, or at.exe on Windows, and a shell script similar to the following:<font face="Courier New, Courier, mono"><br>
	#------------------------------------------------------ <br>
	# This particular example deletes files in the TMPPATH <br>
	# directory with the string ".cache" in their name that <br>
	# are more than 7 days old. <br>
	#------------------------------------------------------ <br>
	AGED=7 <br>
	find ${TMPPATH} -mtime +$AGED | grep "\.cache" | xargs rm -f <br>
	</font> </font></p>
<p><font><b>MetaError<a name="metaerror"></a>($errno=false)</b></font></p>
<p><font>Returns a virtualized error number, based on PEAR DB's error number system. You might
need to include adodb-error.inc.php before you call this function. The parameter $errno
is the native error number you want to convert. If you do not pass any parameter, MetaError
will call ErrorNo() for you and convert it. If the error number cannot be virtualized, MetaError 
will return -1 (DB_ERROR).</font></p>

<p><font><b>MetaErrorMsg<a name="metaerrormsg"></a>($errno)</b></font></p>
<p><font>Pass the error number returned by MetaError() for the equivalent textual error message.</font></p>
<p><font><b>ErrorMsg<a name="errormsg"></a>()</b></font></p>
<p><font>Returns the last status or error message. The error message is reset after every 
call to Execute(). 
</font></p><p>
<font>This can return a string even if 
	no error occurs. In general you do not need to call this function unless an 
	ADOdb function returns false on an error. </font></p>
<p><font>Note: If <b>debug</b> is enabled, the SQL error message is always displayed 
	when the <b>Execute</b> function is called.</font></p>
<p><font><b>ErrorNo<a name="errorno"></a>()</b></font></p>
<p><font>Returns the last error number. The error number is reset after every call to Execute(). 
If 0 is returned, no error occurred.
</font></p><p>
<font>Note that old versions of PHP (pre 4.0.6) do 
	not support error number for ODBC. In general you do not need to call this 
	function unless an ADOdb function returns false on an error.</font></p>
<p><font><b>IgnoreErrors<a name="ignoreerrors"></a>($saveErrHandlers)</b></font></p>
<p>Allows you to ignore errors so that StartTrans()/CompleteTrans() is not affected, nor is the default error handler called if an error occurs.
Useful when you want to check if a field or table exists in a database without invoking an error if it does not exist.
<p>Usage:
<pre>
$saveErrHandlers = $conn->IgnoreErrors();
$rs = $conn->Execute("select field from some_table_that_might_not_exist");
$conn->IgnoreErrors($saveErrHandlers);
</pre>
<p>Warning: do not call StartTrans()/CompleteTrans() inside a code block that is using IgnoreErrors().
<p><font><b>SetFetchMode<a name="setfetchmode"></a>($mode)</b></font></p>
<p><font>Sets the current fetch mode for the connection and stores 
	it in $db-&gt;fetchMode. Legal modes are ADODB_FETCH_ASSOC and ADODB_FETCH_NUM. 
	For more info, see <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>.</font></p>
<p><font>Returns the previous fetch mode, which could be false 
	if SetFetchMode( ) has not been called before.</font></p>
<font> 
</font><p><font><b>CreateSequence<a name="createseq"></a>($seqName = 'adodbseq',$startID=1)</b></font></p>
<p><font>Create a sequence. The next time GenID( ) is called, the value returned will 
	be $startID. Added in 2.60. 
</font></p><p><font><b>DropSequence<a name="dropseq"></a>($seqName = 'adodbseq')</b></font></p>
<p><font>Delete a sequence. Added in 2.60. 
</font></p><p><font><b>GenID<a name="genid"></a>($seqName = 'adodbseq',$startID=1)</b></font></p>
<p><font>Generate a sequence number . Works for interbase, 
	mysql, postgresql, oci8, oci8po, mssql, ODBC based (access,vfp,db2,etc) drivers 
	currently. Uses $seqName as the name of the sequence. GenID() will automatically 
	create the sequence for you if it does not exist (provided the userid has 
	permission to do so). Otherwise you will have to create the sequence yourself. 
</font></p><p><font> If your database driver emulates sequences, the name of the table is the sequence 
	name. The table has one column, "id" which should be of type integer, or if 
	you need something larger - numeric(16). 
</font></p><p><font> For ODBC and databases that do not support sequences natively (eg mssql, mysql), 
	we create a table for each sequence. If the sequence has not been defined 
	earlier, it is created with the starting value set in $startID.</font></p>
<p><font>Note that the mssql driver's GenID() before 1.90 used to generate 16 byte GUID's.</font></p>
<p><font><b>UpdateBlob<a name="updateblob"></a>($table,$column,$val,$where)</b></font></p>
<font>Allows you to store a blob (in $val) into $table into $column in a row at $where. 
</font><p><font> Usage: 
</font></p><p><font> 
</font></p><pre><font>	# for oracle<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, empty_blob())');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br></font></pre>
<p><font> Returns true if succesful, false otherwise. Supported by MySQL, PostgreSQL, 
	Oci8, Oci8po and Interbase drivers. Other drivers might work, depending on 
	the state of development.</font></p>
<p><font>Note that when an Interbase blob is retrieved using SELECT, it still needs 
	to be decoded using $connection-&gt;DecodeBlob($blob); to derive the original 
	value in versions of PHP before 4.1.0. 
</font></p><p><font>For PostgreSQL, you can store your blob using blob oid's or as a bytea field. 
	You can use bytea fields but not blob oid's currently with UpdateBlob( ). 
	Conversely UpdateBlobFile( ) supports oid's, but not bytea data.<br>
	<br>
	If you do not pass in an oid, then UpdateBlob() assumes that you are storing 
	in bytea fields.
	<p>If you do not have any blob fields, you can improve you can improve general SQL query performance by disabling blob handling with $connection->disableBlobs = true.
</p></font><p><font><b>UpdateClob<a name="updateclob"></a>($table,$column,$val,$where)</b></font></p>
<font>Allows you to store a clob (in $val) into $table into $column in a row at $where. 
Similar to UpdateBlob (see above), but for Character Large OBjects. 
</font><p><font> Usage:
</font></p><pre><font>	# for oracle<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, empty_clob())');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br></font></pre>
<p><font><b>UpdateBlobFile<a name="updateblobfile"></a>($table,$column,$path,$where,$blobtype='BLOB')</b></font></p>
<p><font>Similar to UpdateBlob, except that we pass in a file path to where the blob 
	resides.
</font></p><p><font>For PostgreSQL, if you are using blob oid's, use this interface. This interface 
	does not support bytea fields.
</font></p><p><font>Returns true if successful, false otherwise. 
</font></p><p><font><b>BlobEncode<a name="blobencode" id="blobencode"></a>($blob)</b> 
</font></p><p><font>Some databases require blob's to be encoded manually before upload. Note if 
	you use UpdateBlob( ) or UpdateBlobFile( ) the conversion is done automatically 
	for you and you do not have to call this function. For PostgreSQL, currently, 
	BlobEncode() can only be used for bytea fields.
</font></p><p><font>Returns the encoded blob value.
</font></p><p><font>Note that there is a connection property called <em>blobEncodeType</em> which 
	has 3 legal values: 
</font></p><p><font>false - no need to perform encoding or decoding.<br>
	'I' - blob encoding required, and returned encoded blob is a numeric value 
	(no need to quote).<br>
	'C' - blob encoding required, and returned encoded blob is a character value 
	(requires quoting).
</font></p><p><font>This is purely for documentation purposes, so that programs that accept multiple 
	database drivers know what is the right thing to do when processing blobs.
</font></p><p><font><strong>BlobDecode<a name="blobdecode"></a>($blob, $maxblobsize = false)</strong> 
</font></p><p><font>Some databases require blob's to be decoded manually after doing a select statement. 
	If the database does not require decoding, then this function will return 
	the blob unchanged. Currently BlobDecode is only required for one database, 
	PostgreSQL, and only if you are using blob oid's (if you are using bytea fields, 
	we auto-decode for you).</font> The default maxblobsize is set in $connection-&gt;maxblobsize, which 
	is set to 256K in adodb 4.54. </p><p>
	In ADOdb 4.54 and later, the blob is the return value. In earlier versions, the blob data is sent to stdout.</p><font>
</font><p></p><pre><font>$rs = $db-&gt;Execute("select bloboid from postgres_table where id=$key");<br>$blob = $db-&gt;BlobDecode( reset($rs-&gt;fields) );</font></pre>
<p><font><b>Replace<a name="replace"></a>($table, $arrFields, $keyCols,$autoQuote=false)</b></font></p>
<p><font>Try to update a record, and if the record is not found, an insert statement 
	is generated and executed. Returns 0 on failure, 1 if update statement worked, 
	2 if no record was found and the insert was executed successfully. This differs 
	from MySQL's replace which deletes the record and inserts a new record. This 
	also means you cannot update the primary key. The only exception to this is 
	Interbase and its derivitives, which uses delete and insert because of some 
	Interbase API limitations. 
</font></p><p><font>The parameters are $table which is the table name, the $arrFields which is an 
	associative array where the keys are the field names, and $keyCols is the name 
	of the primary key, or an array of field names if it is a compound key. If 
	$autoQuote is set to true, then Replace() will quote all values that are non-numeric; 
	auto-quoting will not quote nulls. Note that auto-quoting will not work if 
	you use SQL functions or operators. 
</font></p><p><font>Examples: 
</font></p><pre><font># single field primary key<br>$ret = $db-&gt;Replace('atable', <br>	array('id'=&gt;1000,'firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid'),<br>	'id',$autoquote = true);	<br># generates UPDATE atable SET firstname='Harun',lastname='Al-Rashid' WHERE id=1000<br># or INSERT INTO atable (id,firstname,lastname) VALUES (1000,'Harun','Al-Rashid')<br><br># compound key<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid', 'age' =&gt; 33, 'birthday' =&gt; 'null'),<br>	array('lastname','firstname'),<br>	$autoquote = true);<br><br># no auto-quoting<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=&gt;"'Harun'",'lastname'=&gt;"'Al-Rashid'", 'age' =&gt; 'null'),<br>	array('lastname','firstname'));	<br></font></pre>
<p><font><b>AutoExecute<a name="autoexecute"></a>($table, $arrFields, $mode, $where=false, $forceUpdate=true,$magicq=false)</b></font></p>
<p>Since ADOdb 4.56, you can automatically generate and execute INSERTs and UPDATEs on a given table with this
function, which is a wrapper for GetInsertSQL() and GetUpdateSQL().
<p>AutoExecute() inserts or updates $table given an array of $arrFields, where the keys are the field names and the array values are the 
field values to store. Note that there is some overhead because the table is first queried to extract key information 
before the SQL is generated. We generate an INSERT or UPDATE based on $mode (see below).
<p>
Legal values for $mode are 
<ul>
<li>'INSERT' or 1 or DB_AUTOQUERY_INSERT
<li>'UPDATE' or 2 or DB_AUTOQUERY_UPDATE
</ul>
<p>You have to define the constants DB_AUTOQUERY_UPDATE and DB_AUTOQUERY_INSERT yourself or include adodb-pear.inc.php.
<p>The $where clause is required if $mode == 'UPDATE'. If $forceUpdate=false then we will query the 
database first and check if the field value returned by the query matches the current field value; only if they differ do we update that field.
<p>Returns true on success, false on error.
<p>An example of its use is:
<pre>
$record["firstName"] = "Carol";
$record["lasTname"] = "Smith"; 
$conn->AutoExecute($table,$record,'INSERT');
# executes <i>"INSERT INTO $table (firstName,lasTname) values ('Carol',Smith')"</i>;

$record["firstName"] = "Carol";
$record["lasTname"] = "Jones"; 
$conn->AutoExecute($table,$record,'UPDATE', "lastname like 'Sm%'");
# executes <i>"UPDATE $table SET firstName='Carol',lasTname='Jones' WHERE lastname like 'Sm%'"</i>;
</pre>
<p>Note: One of the strengths of ADOdb's AutoExecute() is that only valid field names for $table are updated. If $arrFields
contains keys that are invalid field names for $table, they are ignored. There is some overhead in doing this as we have to 
query the database to get the field names, but given that you are not directly coding the SQL yourself, you probably aren't interested in
speed at all, but convenience.
<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
<p>Since 4.94, setting the global variable $ADODB_QUOTE_FIELDNAMES to true will force field names to be auto-quoted in AutoExecute(), GetInsertSQL() and GetUpdateSQL(). </p>
<p><font><b>GetUpdateSQL<a name="getupdatesql"></a>(&amp;$rs, $arrFields, $forceUpdate=false,$magicq=false, $force=null)</b></font></p>
<p><font>Generate SQL to update a table given a recordset $rs, and the modified fields 
	of the array $arrFields (which must be an associative array holding the column 
	names and the new values) are compared with the current recordset. If $forceUpdate 
	is true, then we also generate the SQL even if $arrFields is identical to 
	$rs-&gt;fields. Requires the recordset to be associative. $magicq is used 
	to indicate whether magic quotes are enabled (see qstr()). The field names in the array 
	are case-insensitive.</font></p>
<font>	</font><p><font>Since 4.52, we allow you to pass the $force type parameter, and this overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a>
	global variable.
<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
</p></font><p><font><b>GetInsertSQL<a name="getinsertsql"></a>(&amp;$rs, $arrFields,$magicq=false,$force_type=false)</b></font></p>
<p><font>Generate SQL to insert into a table given a recordset $rs. Requires the query 
	to be associative. $magicq is used to indicate whether magic quotes are enabled 
	(for qstr()). The field names in the array are case-insensitive.</font></p>
<p>
<font>  Since 2.42, you can pass a  table name instead of a recordset into 
GetInsertSQL (in $rs), and it will generate an insert statement for that table.
</font></p><p><font>Since 4.52, we allow you to pass the $force_type parameter, and this overrides the <a href="#ADODB_FORCE_TYPE">$ADODB_FORCE_TYPE</a>
	global variable.
<p>Since 4.62, the table name to be used can be overridden by setting $rs->tableName before AutoExecute(), GetInsertSQL() or GetUpdateSQL() is called.
</p></font><p><font><b>PageExecute<a name="pageexecute"></a>($sql, $nrows, $page, $inputarr=false)</b> 
</font></p><p><font>Used for pagination of recordset. $page is 1-based. See <a href="#ex8">Example 
  8</a>.</font></p>
 
<p><font><b>CachePageExecute<a name="cachepageexecute"></a>($secs2cache, 
  $sql, $nrows, $page, $inputarr=false)</b> </font></p>
<p><font>Used for pagination of recordset. $page is 1-based. See 
  <a href="#ex8">Example 8</a>. Caching version of PageExecute.</font></p>
<font> 
</font><p></p>
<p><font><b>Close<a name="close"></a>( )</b></font></p>
<p><font>Close the database connection. PHP4 proudly states that we no longer have to 
  clean up at the end of the connection because the reference counting mechanism 
  of PHP4 will automatically clean up for us.</font></p>
<font>  </font><p><font><b>StartTrans<a name="starttrans"></a>( )</b></font></p>
<font>  </font><p><font>Start a monitored transaction. As SQL statements are executed, ADOdb will monitor
  for SQL errors, and if any are detected, when CompleteTrans() is called, we auto-rollback.
  </font></p><p>
<font>  </font></p><p><font> To understand why StartTrans() is superior to BeginTrans(), 
  let us examine a few ways of using BeginTrans().
  The following is the wrong way to use transactions: 
</font></p><pre><font>$DB-&gt;BeginTrans();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans();<br></font></pre>
<p><font>because you perform no error checking. It is possible to update table1 and 
  for the update on table2 to fail. Here is a better way: 
</font></p><pre><font>$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>if ($ok) $DB-&gt;CommitTrans();<br>else $DB-&gt;RollbackTrans();<br></font></pre>
<p><font>Another way is (since ADOdb 2.0): 
</font></p><pre><font>$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans($ok);<br></font></pre>
<p><font> Now it is a headache monitoring $ok all over the place. StartTrans() is an
improvement because it monitors all SQL errors for you. This is particularly
useful if you are calling black-box functions in which SQL queries might be executed.
 Also all BeginTrans, CommitTrans and RollbackTrans calls inside a StartTrans block 
  will be disabled, so even if the black box function does a commit, it will be ignored.
</font></p><pre><font>$DB-&gt;StartTrans();<br>CallBlackBox();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CompleteTrans();<br></font></pre>
<p><font>Note that a StartTrans blocks are nestable, the inner blocks are ignored.
 </font></p><p><font><b>CompleteTrans<a name="completetrans"></a>($autoComplete=true)</b></font></p>
<font>  </font><p><font>Complete a transaction called with StartTrans(). This function monitors
  for SQL errors, and will commit if no errors have occured, otherwise it will rollback. 
  Returns true on commit, false on rollback. If the parameter $autoComplete is true
  monitor sql errors and commit and rollback as appropriate. Set $autoComplete to false 
  to force rollback even if no SQL error detected.
  </font></p><p><font><b>FailTrans<a name="failtrans"></a>( )</b></font></p>
<font>  </font><p><font>Fail a transaction started with StartTrans(). The rollback will only occur when
  CompleteTrans() is called.
    </font></p><p><font><b>HasFailedTrans<a name="hasfailedtrans"></a>( )</b></font></p>
<font>	</font><p><font>Check whether smart transaction has failed, 
	eg. returns true if there was an error in SQL execution or FailTrans() was called.
	If not within smart transaction, returns false.
</font></p><p><font><b>BeginTrans<a name="begintrans"></a>( )</b></font></p>
<p><font>Begin a transaction. Turns off autoCommit. Returns true if successful. Some 
  databases will always return false if transaction support is not available. 
   Any open transactions will be rolled back when the connection is closed. Among the
   databases that support transactions are Oracle, PostgreSQL, Interbase, MSSQL, certain
    versions of MySQL, DB2, Informix, Sybase, etc.</font></p>
<font> </font><p><font>Note that <a href="#starttrans">StartTrans()</a> and CompleteTrans() is a superior method of 
 handling transactions, available since ADOdb 3.40. For a explanation, see the <a href="#starttrans">StartTrans()</a> documentation.

</font></p><p><font>You can also use the ADOdb <a href="#errorhandling">error handler</a> to die 
  and rollback your transactions for you transparently. Some buggy database extensions 
  are known to commit all outstanding tranasactions, so you might want to explicitly 
  do a $DB-&gt;RollbackTrans() in your error handler for safety. 
 </font></p><h4><font>Detecting Transactions</font></h4>
<font> </font><p><font>Since ADOdb 2.50, you are able to detect when you are inside a transaction. Check
 that $connection-&gt;transCnt &gt; 0. This variable is incremented whenever BeginTrans() is called,
 and decremented whenever RollbackTrans() or CommitTrans() is called.
</font></p><p><font><b>CommitTrans<a name="committrans"></a>($ok=true)</b></font></p>
<p><font>End a transaction successfully. Returns true if successful. If the database 
  does not support transactions, will return true also as data is always committed. 
</font></p>
<p><font>If you pass the parameter $ok=false, the data is rolled back. See example in 
  BeginTrans().</font></p>
<p><font><b>RollbackTrans<a name="rollbacktrans"></a>( )</b></font></p>
<p><font>End a transaction, rollback all changes. Returns true if successful. If the 
  database does not support transactions, will return false as data is never rollbacked. 
</font></p>
 
<p><font><b>SetTransactionMode<a name="SetTransactionMode"></a>($mode )</b></font></p>
<p>SetTransactionMode allows you to pass in the transaction mode to use for all subsequent transactions. 
Note: if you have persistent connections and using mssql or mysql, you might have to explicitly reset your transaction mode at the beginning of each page request. 
This is only supported in postgresql, mssql, mysql with InnoDB and oci8 currently. For example:
<pre>
$db->SetTransactionMode("SERIALIZABLE");
$db->BeginTrans();
$db->Execute(...); $db->Execute(...);
$db->CommiTrans();

$db->SetTransactionMode(""); // restore to default
$db->StartTrans();
$db->Execute(...); $db->Execute(...);
$db->CompleteTrans();
</pre>

<p>Supported values to pass in:
<ul>
<li>READ UNCOMMITTED (allows dirty reads, but fastest)
<li>READ COMMITTED (default postgres, mssql and oci8)
<li>REPEATABLE READ (default mysql)
<li>SERIALIZABLE (slowest and most restrictive)
</ul>
<p>You can also pass in database specific values such as 'SNAPSHOT' for mssql or 'READ ONLY' for oci8/postgres.
<p>See transaction levels for <a href=http://www.postgresql.org/docs/8.1/interactive/sql-set-transaction.html>PostgreSQL</a>,
<a href=http://www.stanford.edu/dept/itss/docs/oracle/10g/server.101/b10759/statements_10005.htm>Oracle</a>,
<a href=http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html>MySQL</a>, and
<a href=http://msdn2.microsoft.com/en-US/ms173763.aspx>MS SQL Server</a>.
<p><font><b>GetAssoc<a name="getassoc1"></a>($sql,$inputarr=false,$force_array=false,$first2cols=false)</b></font></p>
<p><font>Returns an associative array for the given query $sql with optional bind parameters 
  in $inputarr. If the number of columns returned is greater to two, a 2-dimensional 
  array is returned, with the first column of the recordset becomes the keys 
  to the rest of the rows. If the columns is equal to two, a 1-dimensional array 
  is created, where the the keys directly map to the values (unless $force_array 
  is set to true, when an array is created for each value).
</font></p><p><font> Examples:<a name="getassocex"></a></font></p>

<p><font>We have the following data in a recordset:</font></p>
<p><font>row1: Apple, Fruit, Edible<br>
  row2: Cactus, Plant, Inedible<br>
  row3: Rose, Flower, Edible</font></p>
<p><font>GetAssoc will generate the following 2-dimensional associative 
  array:</font></p>
<p><font>Apple =&gt; array[Fruit, Edible]<br>
  Cactus =&gt; array[Plant, Inedible]<br>
  Rose =&gt; array[Flower,Edible]</font></p>
<p><font>If the dataset is:</font></p>
<p><font>row1: Apple, Fruit<br>
row2: Cactus, Plant<br>
row3: Rose, Flower </font></p>
<p><font>GetAssoc will generate the following 1-dimensional associative
  array (with $force_array==false):</font></p>
<p><font>Apple =&gt; Fruit</font><br>
  Cactus=&gt;Plant<br>
  Rose=&gt;Flower </p>
<p><font>The function returns:</font></p>
<p><font>The associative array, or false if an error occurs.</font></p>
<font>
<p><b>CacheGetAssoc<a name="cachegetassoc"></a>([$secs2cache,] $sql,$inputarr=false,$force_array=false,$first2cols=false)</b></p>
</font>
<p><font>Caching version of <a href="#getassoc1">GetAssoc</a> function above.
</font></p><p><font><b>GetOne<a name="getone"></a>($sql,$inputarr=false)</b></font></p>
<p><font>Executes the SQL and returns the first field of the first row. The recordset 
  and remaining rows are discarded for you automatically. If an error occur, false 
  is returned.</font></p>
<p><font><b>GetRow<a name="getrow"></a>($sql,$inputarr=false)</b></font></p>
<p><font>Executes the SQL and returns the first row as an array. The recordset and remaining 
  rows are discarded for you automatically. If an error occurs, false is returned.</font></p>
<p><font><b>GetAll<a name="getall"></a>($sql,$inputarr=false)</b></font></p>

<p>Executes the SQL and returns the all the rows as a 2-dimensional 
  array. The recordset is discarded for you automatically. If an error occurs, 
  false is returned. <i>GetArray</i> is a synonym for <i>GetAll</i>.</p>
 <p><b>GetCol<a name="getcol"></a>($sql,$inputarr=false,$trim=false)</b></p>

<p><font>Executes the SQL and returns all elements of the first column as a 
1-dimensional array. The recordset is discarded for you automatically. If an error occurs, 
  false is returned.</font></p>
<p><font><b>CacheGetOne<a name="cachegetone"></a>([$secs2cache,] 
  $sql,$inputarr=false), CacheGetRow<a name="cachegetrow"></a>([$secs2cache,] $sql,$inputarr=false), CacheGetAll<a name="cachegetall"></a>([$secs2cache,] 
  $sql,$inputarr=false), CacheGetCol<a name="cachegetcol"></a>([$secs2cache,] 
  $sql,$inputarr=false,$trim=false)</b></font></p>
<font> 
</font><p><font>Similar to above Get* functions, except that the recordset is serialized and 
  cached in the $ADODB_CACHE_DIR directory for $secs2cache seconds. Good for speeding 
  up queries on rarely changing data. Note that the $secs2cache parameter is optional. 
  If omitted, we use the value in $connection-&gt;cacheSecs (default is 3600 seconds, 
  or 1 hour).</font></p>
<p><font><b>Prepare<a name="prepare"></a>($sql )</b></font></p>
 
<p><font>Prepares (compiles) an SQL query for repeated execution. Bind parameters
are denoted by ?, except for the oci8 driver, which uses the traditional Oracle :varname
convention. 
  </font></p>
<p><font>Returns an array containing the original sql statement 
  in the first array element; the remaining elements of the array are driver dependent. 
  If there is an error, or we are emulating Prepare( ), we return the original 
  $sql string. This is because all error-handling has been centralized in Execute( 
  ).</font></p>
<p><font>Prepare( ) cannot be used with functions that use SQL 
  query rewriting techniques, e.g. PageExecute( ) and SelectLimit( ).</font></p>
<p>Example:</p>
<pre><font>$stmt = $DB-&gt;Prepare('insert into table (col1,col2) values (?,?)');<br>for ($i=0; $i &lt; $max; $i++)<br></font>	$DB-&gt;<font>Execute($stmt,array((string) rand(), $i));<br></font></pre>
<font> 
</font><p><font>Also see InParameter(), OutParameter() and PrepareSP() below. Only supported internally by interbase, 
  oci8 and selected ODBC-based drivers, otherwise it is emulated. There is no 
  performance advantage to using Prepare() with emulation. 
</font></p><p><font> Important: Due to limitations or bugs in PHP, if you are getting errors when 
  you using prepared queries, try setting $ADODB_COUNTRECS = false before preparing. 
  This behaviour has been observed with ODBC. 
</font></p><p><font><b>IfNull<a name="ifnull"></a>($field, $nullReplacementValue)</b></font></p>
<p><font>Portable IFNULL function (NVL in Oracle). Returns a string that represents 
  the function that checks whether a $field is null for the given database, and 
  if null, change the value returned to $nullReplacementValue. Eg.</font></p>
<pre><font>$sql = <font color="#993300">'SELECT '</font>.$db-&gt;IfNull('name', <font color="#993300">"'- unknown -'"</font>).<font color="#993300"> ' FROM table'</font>;</font></pre>

<p><font><b>length<a name="length"></a></b></font></p>
<p><font>This is not a function, but a property. Some databases have "length" and others "len"
as the function to measure the length of a string. To use this property:
</font></p><pre><font>  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;length.<font color="#993300">"(field) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>

<p><font><b>random<a name="random"></a></b></font></p>
<p><font>This is not a function, but a property. This is a string that holds the sql to
generate a random number between 0.0 and 1.0 inclusive.

</font></p><p><font><b>substr<a name="substr"></a></b></font></p>
<p><font>This is not a function, but a property. Some databases have "substr" and others "substring"
as the function to retrieve a sub-string. To use this property:
</font></p><pre><font>  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;substr.<font color="#993300">"(field, $offset, $length) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>
<p><font>For all databases, the 1st parameter of <i>substr</i> is the field, the 2nd is the
offset (1-based) to the beginning of the sub-string, and the 3rd is the length of the sub-string.


</font></p><p><font><b>Param<a name="param"></a>($name)</b></font></p>
<p><font>Generates a bind placeholder portably. For most databases, the bind placeholder 
  is "?". However some databases use named bind parameters such as Oracle, eg 
  ":somevar". This allows us to portably define an SQL statement with bind parameters: 
</font></p><pre><font>$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;<br><font color="#006600"># generates 'insert into table (col1,col2) values (?,?)'<br># or        'insert into table (col1,col2) values (:a,:b)</font>'<br>$stmt = $DB-&gt;Prepare($sql);<br>$stmt = $DB-&gt;Execute($stmt,array('one','two'));<br></font></pre>
<font> </font>
<p></p>
<p><font><b>PrepareSP</b><b><a name="preparesp"></a></b><b>($sql,
$cursor=false )</b></font></p>
<p><font>When calling stored procedures in mssql and oci8 (oracle),
    and you might want to directly bind to parameters that return values, or
for special LOB handling. PrepareSP() allows you to do so. </font></p>
<p><font>Returns the same array or $sql string as Prepare( )
    above. If you do not need to bind to return values, you should use Prepare(
  ) instead.</font></p>
<p><font>The 2nd parameter, $cursor is not used except with oci8.
    Setting it to true will force OCINewCursor to be called; this is to support
output REF CURSORs. </font></p>
<p><font>For examples of usage of PrepareSP( ), see InParameter(
) below. </font></p>
<p><font>Note: in the mssql driver, preparing stored procedures
    requires a special function call, mssql_init( ), which is called by this
    function. PrepareSP( ) is available in all other drivers, and is emulated
  by calling Prepare( ). </font></p>
<p><font><b> InParameter<a name="inparameter"></a>($stmt, $var,
  $name, $maxLen = 4000, $type = false )</b></font></p>
<font>Binds a PHP variable as input to a stored procedure variable.
The parameter <i>$stmt</i> is the value returned by PrepareSP(), <i>$var</i> is
the PHP variable you want to bind, $name is the name of the stored procedure
variable. Optional is <i>$maxLen</i>, the maximum length of the data to bind,
and $type which is database dependant. Consult <a href="http://php.net/mssql_bind">mssql_bind</a> and <a href="http://php.net/ocibindbyname">ocibindbyname</a> docs
at php.net for more info on legal values for $type. </font>
<p>
<font>InParameter() is a wrapper function that calls Parameter()
with $isOutput=false. The advantage of this function is that it is self-documenting,
because the $isOutput parameter is no longer needed. Only for mssql and oci8
currently. </font></p>
<p><font>Here is an example using oci8: </font></p>
<pre><font><font color="green"># For oracle, Prepare and PrepareSP are identical</font>
$stmt = $db-&gt;PrepareSP(
	<font color="#993300">"declare RETVAL integer; <br>	begin<br>	:RETVAL := </font><font color="#993300">SP_RUNSOMETHING</font><font color="#993300">(:myid,:group);<br>	end;"</font>);<br>$db-&gt;InParameter($stmt,$id,'myid');<br>$db-&gt;InParameter($stmt,$group,'group',64);<br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt);<br></font></pre>
<p><font> The same example using mssql:</font></p>
<font> 
</font><pre><font><font color="green"># @RETVAL = SP_RUNSOMETHING @myid,@group</font>
$stmt = $db-&gt;PrepareSP(<font color="#993333">'<font color="#993300">SP_RUNSOMETHING</font>'</font>); <br><font color="green"># note that the parameter name does not have @ in front!</font>
$db-&gt;InParameter($stmt,$id,'myid');
$db-&gt;InParameter($stmt,$group,'group',64);
<font color="green"># return value in mssql - RETVAL is hard-coded name</font> <br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt); </font></pre>

<p><font>Note that the only difference between the oci8 and mssql implementations is $sql.</font></p>
<p>
<font> If $type parameter is set to false, in mssql, $type will be dynamicly determined 
based on the type of the PHP variable passed <font face="Courier New, Courier, mono">(string 
=&gt; SQLCHAR, boolean =&gt;SQLINT1, integer =&gt;SQLINT4 or float/double=&gt;SQLFLT8)</font>.
</font></p><p><font> 
In oci8, $type can be set to OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). To 
pass in a null, use<font face="Courier New, Courier, mono"> $db-&gt;Parameter($stmt, 
$null=null, 'param')</font>. 
  </font></p><p><font><b> OutParameter<a name="outparameter"></a>($stmt, $var, $name, 
  $maxLen = 4000, $type = false )</b></font></p>
<font>  Binds a PHP variable as output from a stored procedure variable. The parameter <i>$stmt</i>
 is the value returned by PrepareSP(), <i>$var</i> is the PHP variable you want to bind, <i>$name</i>
 is the name of the stored procedure variable. Optional is <i>$maxLen</i>, the maximum length of the
 data to bind, and <i>$type</i> which is database dependant. 
</font><p>
<font>  OutParameter() is a wrapper function that calls Parameter() with $isOutput=true. 
  The advantage of this function is that it is self-documenting, because
the $isOutput parameter is no longer needed.  Only for mssql 
  and oci8 currently.
</font></p><p>
<font>For an example, see <a href="#inparameter">InParameter</a>.

</font></p><p><font><b> Parameter<a name="parameter"></a>($stmt, $var, $name, $isOutput=false, 
  $maxLen = 4000, $type = false )</b></font></p>
<p><font>Note: This function is deprecated, because of the new InParameter() and OutParameter() functions.
These are superior because they are self-documenting, unlike Parameter().
</font></p><p><font>Adds a bind parameter suitable for return values or special data handling (eg. 
  LOBs) after a statement has been prepared using PrepareSP(). Only for mssql 
  and oci8 currently. The parameters are:<br>
  <br>
  $<i><b>stmt</b></i> Statement returned by Prepare() or PrepareSP().<br>
  $<i><b>var</b></i> PHP variable to bind to. Make sure you pre-initialize it!<br>
  $<i><b>name</b></i> Name of stored procedure variable name to bind to.<br>
  [$<i><b>isOutput</b></i>] Indicates direction of parameter 0/false=IN 1=OUT 
  2= IN/OUT. This is ignored in oci8 as this driver auto-detects the direction.<br>
  [$<b>maxLen</b>] Maximum length of the parameter variable.<br>
  [$<b>type</b>] Consult <a href="http://php.net/mssql_bind">mssql_bind</a> and 
  <a href="http://php.net/ocibindbyname">ocibindbyname</a> docs at php.net for 
  more info on legal values for type.</font></p>
<p><font>Lastly, in oci8, bind parameters can be reused without calling PrepareSP( ) 
  or Parameters again. This is not possible with mssql. An oci8 example:</font></p>
<pre><font>$id = 0; $i = 0;<br>$stmt = $db-&gt;PrepareSP( <font color="#993300">"update table set val=:i where id=:id"</font>);<br>$db-&gt;Parameter($stmt,$id,'id');<br>$db-&gt;Parameter($stmt,$i, 'i');<br>for ($cnt=0; $cnt &lt; 1000; $cnt++) {<br>	$id = $cnt; <br>	$i = $cnt * $cnt; <font color="green"># works with oci8!</font>
	$db-&gt;Execute($stmt); <br>}</font></pre>
<p><font><b>Bind<a name="bind"></a>($stmt, $var, $size=4001, $type=false, $name=false)</b></font></p>
 
<p><font>This is a low-level function supported only by the oci8 
  driver. <b>Avoid using</b> unless you only want to support Oracle. The Parameter( 
  ) function is the recommended way to go with bind variables.</font></p>
<p><font>Bind( ) allows you to use bind variables in your sql 
  statement. This binds a PHP variable to a name defined in an Oracle sql statement 
  that was previously prepared using Prepare(). Oracle named variables begin with 
  a colon, and ADOdb requires the named variables be called :0, :1, :2, :3, etc. 
  The first invocation of Bind() will match :0, the second invocation will match 
  :1, etc. Binding can provide 100% speedups for insert, select and update statements. 
  </font></p>
<p>The other variables, $size sets the buffer size for data storage, $type is 
  the optional descriptor type OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
  OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). 
  Lastly, instead of using the default :0, :1, etc names, you can define your 
  own bind-name using $name. 
</p><p><font>The following example shows 3 bind variables being used: 
  p1, p2 and p3. These variables are bound to :0, :1 and :2.</font></p>
<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:0, :1, :2)");<br>$DB-&gt;Bind($stmt, $p1);<br>$DB-&gt;Bind($stmt, $p2);<br>$DB-&gt;Bind($stmt, $p3);<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
<p>You can also use named variables:</p>
<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:name0, :name1, :name2)");<br>$DB-&gt;Bind($stmt, $p1, "name0");<br>$DB-&gt;Bind($stmt, $p2, "name1");<br>$DB-&gt;Bind($stmt, $p3, "name2");<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
<p><b>LogSQL($enable=true)<a name="logsql"></a></b></p>
Call this method to install a SQL logging and timing function (using fnExecute). 
Then all SQL statements are logged into an adodb_logsql table in a database. If 
the adodb_logsql table does not exist, ADOdb will create the table if you have 
the appropriate permissions. Returns the previous logging value (true for enabled, 
false for disabled). Here are samples of the DDL for selected databases: 
<p> 
</p><pre>		<b>mysql:</b>
		CREATE TABLE adodb_logsql (
		  created datetime NOT NULL,
		  sql0 varchar(250) NOT NULL,
		  sql1 text NOT NULL,
		  params text NOT NULL,
		  tracer text NOT NULL,
		  timer decimal(16,6) NOT NULL
		)
		
		<b>postgres:</b>
		CREATE TABLE adodb_logsql (
		  created timestamp NOT NULL,
		  sql0 varchar(250) NOT NULL,
		  sql1 text NOT NULL,
		  params text NOT NULL,
		  tracer text NOT NULL,
		  timer decimal(16,6) NOT NULL
		)
		
		<b>mssql:</b>
		CREATE TABLE adodb_logsql (
		  created datetime NOT NULL,
		  sql0 varchar(250) NOT NULL,
		  sql1 varchar(4000) NOT NULL,
		  params varchar(3000) NOT NULL,
		  tracer varchar(500) NOT NULL,
		  timer decimal(16,6) NOT NULL
		)
		
		<b>oci8:</b>
		CREATE TABLE adodb_logsql (
		  created date NOT NULL,
		  sql0 varchar(250) NOT NULL,
		  sql1 varchar(4000) NOT NULL,
		  params varchar(4000),
		  tracer varchar(4000),
		  timer decimal(16,6) NOT NULL
		)
</pre>
Usage: 
<pre>	$conn-&gt;LogSQL(); // turn on logging<br>	  :<br>	$conn-&gt;Execute(...);<br>	  :<br>	$conn-&gt;LogSQL(false); // turn off logging<br>	<br>	# output summary of SQL logging results<br>	$perf = NewPerfMonitor($conn);<br>	echo $perf-&gt;SuspiciousSQL();<br>	echo $perf-&gt;ExpensiveSQL();<br></pre>
<p>One limitation of logging is that rollback also prevents SQL from being logged.
</p><p>
If you prefer to use another name for the table used to store the SQL, you can override it by calling 
adodb_perf::table($tablename), where $tablename is the new table name (you will still need to manually
create the table yourself). An example:
</p><pre>	include('adodb.inc.php');<br>	include('adodb-perf.inc.php');<br>	adodb_perf::table('my_logsql_table');<br></pre>
Also see <a href="docs-perf.htm">Performance Monitor</a>. 
<p><font><b>fnExecute and fnCacheExecute properties<a name="fnexecute" id="fnexecute"></a></b></font></p>
<p>These two properties allow you to define bottleneck functions for all sql statements 
  processed by ADOdb. This allows you to perform statistical analysis and query-rewriting 
  of your sql. 
</p><p><b>Examples of fnExecute</b></p>
<p>Here is an example of using fnExecute, to count all cached queries and non-cached 
  queries, you can do this:</p>
<pre><font color="#006600"># $db is the connection object</font>
function &CountExecs($db, $sql, $inputarray)
{
global $EXECS;

	if (!is_array(inputarray)) $EXECS++;
	<font color="#006600"># handle 2-dimensional input arrays</font>
	else if (is_array(reset($inputarray))) $EXECS += sizeof($inputarray);
	else $EXECS++;
	
	<font color="#006600"># in PHP4.4 and PHP5, we need to return a value by reference</font>
	$null = null;
	return $null;
}

<font color="#006600"># $db is the connection object</font>
function CountCachedExecs($db, $secs2cache, $sql, $inputarray)
{<br>global $CACHED; $CACHED++;<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;Connect(...);<br>$db-&gt;<strong>fnExecute</strong> = 'CountExecs';<br>$db-&gt;<strong>fnCacheExecute</strong> = 'CountCachedExecs';<br> :<br> :<br><font color="#006600"># After many sql statements:</font>`<br>printf("&lt;p&gt;Total queries=%d; total cached=%d&lt;/p&gt;",$EXECS+$CACHED, $CACHED);<br></pre>
<p>The fnExecute function is called before the sql is parsed and executed, so 
  you can perform a query rewrite. If you are passing in a prepared statement, 
  then $sql is an array (see <a href="#prepare">Prepare</a>). The fnCacheExecute 
  function is only called if the recordset returned was cached.<font> 
  The function parameters match the Execute and CacheExecute functions respectively, 
  except that $this (the connection object) is passed as the first parameter.</font></p>
<p>Since ADOdb 3.91, the behaviour of fnExecute varies depending on whether the 
  defined function returns a value. If it does not return a value, then the $sql 
  is executed as before. This is useful for query rewriting or counting sql queries. 
</p><p> On the other hand, you might want to replace the Execute function with one 
  of your own design. If this is the case, then have your function return a value. 
  If a value is returned, that value is returned immediately, without any further 
  processing. This is used internally by ADOdb to implement LogSQL() functionality. 
</p>
<p>
</p><hr />
<h3><font>ADOConnection Utility Functions</font></h3>
<p><font><b>BlankRecordSet<a name="blankrecordset"></a>([$queryid])</b></font></p>
<p><font>No longer available - removed since 1.99.</font></p>
<p><font><b>Concat<a name="concat"></a>($s1,$s2,....)</b></font></p>
<p><font>Generates the sql string used to concatenate $s1, $s2, etc together. Uses the 
  string in the concat_operator field to generate the concatenation. Override 
  this function if a concatenation operator is not used, eg. MySQL.</font></p>
<p><font>Returns the concatenated string.</font></p>
<p><font><b>DBDate<a name="dbdate"></a>($date)</b></font></p>
<p><font>Format the $<b>date</b> in the format the database accepts - the return string is also quoted. This is used
when you are sending dates to the database (eg INSERT, UPDATE or where clause of SELECT statement). 
  The $<b>date</b> parameter can be a Unix integer timestamp or an ISO format 
  Y-m-d. Uses the fmtDate field, which holds the format to use. If null or false 
  or '' is passed in, it will be converted to an SQL null.</font></p>
<p><font>Returns the date as a quoted string.</font></p>
<pre>
	$sql = "select * from atable where created > ".$db->DBDate("$year-$month-$day");
	$db->Execute($sql);
</pre>
<p>Note to retrieve a date column in a specific format,  use <a href="#sqldate">SQLDate</a>. </p>
<p><font><b>BindDate<a name="binddate"></a>($date)</b></font></p>
<p><font>Format the $<b>date</b> in the bind format the database accepts. Normally
 this means that the date string is not quoted, unlike DBDate, which quotes the string.
<pre>
	$sql = "select * from atable where created > ".$db->Param('0');
	// or
	$sql = "select * from atable where created > ?";
	$db->Execute($sql,array($db->BindDate("$year-$month-$day"));
</pre>
<p><font><b>DBTimeStamp<a name="dbtimestamp"></a>($ts)</b></font></p>
<p><font>Format the timestamp $<b>ts</b> in the format the database accepts; this can 
  be a Unix integer timestamp or an ISO format Y-m-d H:i:s. Uses the fmtTimeStamp 
  field, which holds the format to use. If null or false or '' is passed in, it 
  will be converted to an SQL null.</font></p>
<p><font>Returns the timestamp as a quoted string.</font></p>
<pre>
	$sql = "select * from atable where created > ".$db->DBTimeStamp("$year-$month-$day $hr:$min:$secs");
	$db->Execute($sql);
</pre>
<p><font><b>BindTimeStamp<a name="bindtimestamp"></a>($ts)</b></font></p>
<p><font>Format the timestamp $<b>ts</b> in the bind format the database accepts. Normally
 this means that the timestamp string is not quoted, unlike DBTimeStamp, which quotes the string.
<pre>
	$sql = "select * from atable where created > ".$db->Param('0');
	// or
	$sql = "select * from atable where created > ?";
	$db->Execute($sql,array($db->BindTimeStamp("$year-$month-$day $hr:$min:$secs"));
</pre>
<p><font><b>qstr<a name="qstr"></a>($s,[$magic_quotes_enabled</b>=false]<b>)</b></font></p>
<p><font>Quotes a string to be sent to the database. The $<b>magic_quotes_enabled</b> 
  parameter may look funny, but the idea is if you are quoting a string extracted 
  from a POST/GET variable, then pass get_magic_quotes_gpc() as the second parameter. 
  This will ensure that the variable is not quoted twice, once by <i>qstr</i> 
  and once by the <i>magic_quotes_gpc</i>.</font></p>
<p><font>Eg.<font face="Courier New, Courier, mono"> $s = $db-&gt;qstr(HTTP_GET_VARS['name'],get_magic_quotes_gpc());</font></font></p>
<p><font>Returns the quoted string.</font></p>
<p><font><b>Quote<a name="quote"></a>($s)</b></font></p>
<p><font>Quotes the string $s, escaping the database specific quote character as appropriate. 
  Formerly checked magic quotes setting, but this was disabled since 3.31 for 
  compatibility with PEAR DB. 
</font></p><p><font><b>Affected_Rows<a name="affected_rows"></a>( )</b></font></p>
<p><font>Returns the number of rows affected by a update or delete statement. Returns 
  false if function not supported.</font></p>
<p><font>Not supported by interbase/firebird currently. </font></p>
<p><font><b>Insert_ID<a name="inserted_id"></a>( )</b></font></p>
<p><font>Returns the last autonumbering ID inserted. Returns false if function not supported. 
</font></p>
<p><font>Only supported by databases that support auto-increment or object id's, such 
  as PostgreSQL, MySQL and MS SQL Server currently. PostgreSQL returns the OID, which 
  can change on a database reload.</font></p>
<p><font><b>RowLock<a name="rowlock"></a>($table,$where)</b></font></p>
<p><font>Lock a table row for the duration of a transaction. For example to lock record $id in table1:
</font></p><pre><font>	$DB-&gt;StartTrans();<br>	$DB-&gt;RowLock("table1","rowid=$id");<br>	$DB-&gt;Execute($sql1);<br>	$DB-&gt;Execute($sql2);<br>	$DB-&gt;CompleteTrans();<br></font></pre>
<p><font>Supported in db2, interbase, informix, mssql, oci8, postgres, sybase.
</font></p><p><font><b>MetaDatabases<a name="metadatabases"></a>()</b></font></p>
<p><font>Returns a list of databases available on the server as an array. You have to 
  connect to the server first. Only available for ODBC, MySQL and ADO.</font></p>
<p><font><b>MetaTables<a name="metatables"></a>($ttype = false, $showSchema = false, 
  $mask=false)</b></font></p>
<p><font>Returns an array of tables and views for the current database as an array. 
  The array should exclude system catalog tables if possible. To only show tables, 
  use $db-&gt;MetaTables('TABLES'). To show only views, use $db-&gt;MetaTables('VIEWS'). 
  The $showSchema parameter currently works only for DB2, and when set to true, 
  will add the schema name to the table, eg. "SCHEMA.TABLE". </font></p>
<p><font>You can define a mask for matching. For example, setting $mask = 'TMP%' will 
  match all tables that begin with 'TMP'. Currently only mssql, oci8, odbc_mssql 
  and postgres* support $mask. 
</font></p><p><font><b>MetaColumns<a name="metacolumns"></a>($table,$notcasesensitive=true)</b></font></p>
<p><font>Returns an array of ADOFieldObject's, one field object for every column of 
  $table. A field object is a class instance with (name, type, max_length) defined.
  Currently Sybase does not recognise date types, and ADO cannot identify 
  the correct data type (so we default to varchar).   
 </font></p><p><font> The $notcasesensitive parameter determines whether we uppercase or lowercase the table name to normalize it
 (required for some databases). Does not work with MySQL ISAM tables.
 </font></p><p><font>For schema support, pass in the $table parameter, "$schema.$tablename". This is only
 supported for selected databases.
</font></p><p><font><b>MetaColumnNames<a name="metacolumnames"></a>($table,$numericIndex=false)</b></font></p>
<p><font>Returns an array of column names for $table. Since ADOdb 4.22, this is an associative array, with the
keys in uppercase. Set $numericIndex=true if you want the old behaviour of numeric indexes (since 4.23).
</font></p><p>
<font>e.g. array('FIELD1' =&gt; 'Field1', 'FIELD2'=&gt;'Field2')
</font></p><p>
</p><p><font><b>MetaPrimaryKeys<a name="metaprimarykeys"></a>($table,
      $owner=false)</b></font> 
</p>
<p><font>Returns an array containing column names that are the 
  primary keys of $table. Supported by mysql, odbc (including db2, odbc_mssql, 
etc), mssql, postgres, interbase/firebird, oci8 currently. </font></p>
<p><font>Views (and some tables) have primary keys, but sometimes this information is not available from the
database. You can define a function  ADODB_View_PrimaryKeys($databaseType, $database, $view, $owner) that
should return an array containing the fields that make up the primary key. If that function exists,
it will be called when MetaPrimaryKeys() cannot find a primary key for a table or view.
</font></p><pre><font>// In this example: dbtype = 'oci8', $db = 'mydb', $view = 'dataView', $owner = false <br>function ADODB_View_PrimaryKeys($dbtype,$db,$view,$owner)<br>{<br>	switch(strtoupper($view)) {<br>	case 'DATAVIEW': return array('DATAID');<br>	default: return false;<br>	}<br>}<br><br>$db = NewADOConnection('oci8');<br>$db-&gt;Connect('localhost','root','','mydb'); <br>$db-&gt;MetaPrimaryKeys('dataView');<br></font></pre>
<p><font><b>ServerInfo<a name="serverinfo" id="serverinfo"></a>()</b></font> 
</p>
<p><font>Returns an array of containing two elements 'description' 
  and 'version'. The 'description' element contains the string description of 
  the database. The 'version' naturally holds the version number (which is also 
a string).</font></p>
<p><font><b>MetaForeignKeys<a name="metaforeignkeys"></a>($table, $owner=false, $upper=false)</b> 
</font></p><p><font>Returns an associate array of foreign keys, or false if not supported. For 
  example, if table employee has a foreign key where employee.deptkey points to 
  dept_table.deptid, and employee.posn=posn_table.postionid and employee.poscategory=posn_table.category, 
  then $conn-&gt;MetaForeignKeys('employee') will return 
</font></p><pre><font>	array(<br>		'dept_table' =&gt; array('deptkey=deptid'),<br>		'posn_table' =&gt; array('posn=positionid','poscategory=category')<br>	)<br></font></pre>
<p><font>The optional schema or owner can be defined in $owner. If $upper is true, then 
  the table names (array keys) are upper-cased. 
</font></p><hr />
<h2><font>ADORecordSet<a name="adorecordset"></a></font></h2>
<p><font>When an SQL statement successfully is executed by <font face="Courier New, Courier, mono">ADOConnection-&gt;Execute($sql),</font>an 
  ADORecordSet object is returned. This object contains a virtual cursor so we 
  can move from row to row, functions to obtain information about the columns 
  and column types, and helper functions to deal with formating the results to 
  show to the user.</font></p>
<h3><font>ADORecordSet Fields</font></h3>
<p><font><b>fields: </b>Array containing the current row. This is not associative, but 
  is an indexed array from 0 to columns-1. See also the function <b><a href="#fields">Fields</a></b>, 
  which behaves like an associative array.</font></p>
<p><font><b>dataProvider</b>: The underlying mechanism used to connect to the database. 
  Normally set to <b>native</b>, unless using <b>odbc</b> or <b>ado</b>.</font></p>
<p><font><b>blobSize</b>: Maximum size of a char, string or varchar object before it 
  is treated as a Blob (Blob's should be shown with textarea's). See the <a href="#metatype">MetaType</a> 
  function.</font></p>
<p><font><b>sql</b>: Holds the sql statement used to generate this record set.</font></p>
<p><font><b>canSeek</b>: Set to true if Move( ) function works.</font></p>
<p><font><b>EOF</b>: True if we have scrolled the cursor past the last record.</font></p>
<h3><font>ADORecordSet Functions</font></h3>
<p><font><b>ADORecordSet( )</b></font></p>
<p><font>Constructer. Normally you never call this function yourself.</font></p>
<p><font><b>GetAssoc<a name="getassoc"></a>([$force_array])</b></font></p>
<p><font>Generates an associative array from the recordset. Note that is this function 
  is also <a href="#getassoc1">available</a> in the connection object. More details 
  can be found there.</font></p>
<font> </font>
<p><font><b>GetArray<a name="getarray"></a>([$number_of_rows])</b></font></p>
<p><font>Generate a 2-dimensional array of records from the current
    cursor position, indexed from 0 to $number_of_rows - 1. If $number_of_rows
  is undefined, till EOF.</font></p>
<p><font><b>GetRows<a name="getrows"></a>([$number_of_rows])</b></font></p>
<font>Generate a 2-dimensional array of records from the current
cursor position. Synonym for GetArray() for compatibility with Microsoft ADO. </font>
<p><font> <b>GetMenu<a name="getmenu"></a>($name, [$default_str=''],
  [$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></font></p>
<p><font>Generate a HTML menu (&lt;select&gt;&lt;option&gt;&lt;option&gt;&lt;/select&gt;).
    The first column of the recordset (fields[0]) will hold the string to display
    in the option tags. If the recordset has more than 1 column, the second column
    (fields[1]) is the value to send back to the web server.. The menu will be
given the name $<i>name</i>. </font></p>
<p><font> If $<i>default_str</i> is defined, then if $<i>default_str</i> ==
    fields[0], that field is selected. If $<i>blank1stItem</i> is true, the first
    option is empty. You can also set the first option strings by setting $blank1stItem
  = "$value:$text".</font></p>
<p><font>$<i>Default_str</i> can be array for a multiple select
listbox.</font></p>
<p><font>To get a listbox, set the $<i>size</i> to a non-zero
    value (or pass $default_str as an array). If $<i>multiple_select</i> is true
    then a listbox will be generated with $<i>size</i> items (or if $size==0,
    then 5 items) visible, and we will return an array to a server. Lastly use
  $<i>moreAttr </i> to add additional attributes such as javascript or styles. </font></p>
<p><font>Menu Example 1: <code>GetMenu('menu1','A',true)</code> will
    generate a menu:
    <select name="menu1"><option> </option><option value="1" selected="selected">A </option><option value="2">B </option><option value="3">C </option></select>
for the data (A,1), (B,2), (C,3). Also see <a href="#ex5">example 5</a>.</font></p>
<p><font>Menu Example 2: For the same data, <code>GetMenu('menu1',array('A','B'),false)</code> will
    generate a menu with both A and B selected: <br>
    <select name="menu1" multiple="multiple" size="3"><option value="1" selected="selected">A </option><option value="2" selected="selected">B </option><option value="3">C </option></select>
</font></p>
<p><font> <b>GetMenu2<a name="getmenu2"></a>($name, [$default_str=''],
  [$blank1stItem=true], [$multiple_select=false], [$size=0], [$moreAttr=''])</b></font></p>
<p><font>This is nearly identical to GetMenu, except that the
  $<i>default_str</i> is matched to fields[1] (the option values).</font></p>
<p><font>Menu Example 3: Given the data in menu example 2, <code>GetMenu2('menu1',array('1','2'),false)</code> will
    generate a menu with both A and B selected in menu example 2, but this time
    the selection is based on the 2nd column, which holds the values to return
to the Web server. </font></p>
<p><font><b>UserDate<a name="userdate"></a>($str, [$fmt])</b></font></p>
<p><font>Converts the date string $<i>str</i> to another format.
    The date format is Y-m-d, or Unix timestamp format. The default $<i>fmt</i> is
Y-m-d.</font></p>
<p><font><b>UserTimeStamp<a name="usertimestamp"></a>($str, [$fmt])</b></font></p>
<p><font>Converts the timestamp string $<b>str</b> to another
    format. The timestamp format is Y-m-d H:i:s, as in '2002-02-28 23:00:12',
    or Unix timestamp format. UserTimeStamp calls UnixTimeStamp to parse $<i>str</i>,
and $<i>fmt</i> defaults to Y-m-d H:i:s if not defined. </font></p>
<p><font><b>UnixDate<a name="unixdate"></a>($str)</b></font></p>
<p><font>Parses the date string $<b>str</b> and returns it in
    unix mktime format (eg. a number indicating the seconds after January 1st,
    1970). Expects the date to be in Y-m-d H:i:s format, except for Sybase and
    Microsoft SQL Server, where M d Y is also accepted (the 3 letter month strings
  are controlled by a global array, which might need localisation).</font></p>
<p><font>This function is available in both ADORecordSet and
ADOConnection since 1.91.</font></p>
<p><font><b>UnixTimeStamp<a name="unixtimestamp"></a>($str)</b></font></p>
<p><font>Parses the timestamp string $<b>str</b> and returns
    it in unix mktime format (eg. a number indicating the seconds after January
    1st, 1970). Expects the date to be in "Y-m-d, H:i:s" (1970-12-24, 00:00:00)
    or "Y-m-d H:i:s" (1970-12-24 00:00:00) or "YmdHis" (19701225000000) format,
    except for Sybase and Microsoft SQL Server, where "M d Y h:i:sA" (Dec 25
    1970 00:00:00AM) is also accepted (the 3 letter month strings are controlled
by a global array, which might need localisation).</font></p>
<font> 
</font><p><font>This function is available in both ADORecordSet
    and ADOConnection since 1.91. </font></p>
<p><font><b>OffsetDate<a name="OffsetDate"></a>($dayFraction,
  $basedate=false)</b></font></p>
<p><font>Returns a string with the native SQL functions to calculate
    future and past dates based on $basedate in a portable fashion. If $basedate
    is not defined, then the current date (at 12 midnight) is used. Returns the
  SQL string that performs the calculation when passed to Execute(). </font></p>
<p><font>For example, in Oracle, to find the date and time that
  is 2.5 days from today, you can use:</font></p>
<pre><font># get date one week from now<br>$fld = $conn-&gt;OffsetDate(7); // returns "(trunc(sysdate)+7")</font></pre>
<pre><font># get date and time that is 60 hours from current date and time<br>$fld = $conn-&gt;OffsetDate(2.5, $conn-&gt;sysTimeStamp);	// returns "(sysdate+2.5)"<br><br>$conn-&gt;Execute("UPDATE TABLE SET dodate=$fld WHERE ID=$id");</font></pre>
<p><font> This function is available for mysql, mssql, oracle, oci8 and postgresql drivers 
  since 2.13. It might work with other drivers provided they allow performing
  numeric day arithmetic on dates.</font></p>
<font> </font>
<p><font><b>SQLDate<a name="sqldate"></a>($dateFormat, $basedate=false)</b></font></p>
<font>Returns a string which contains the native SQL functions
to format a date or date column $basedate. This is used when retrieving date columns in SELECT statements.
For sending dates to the database (eg. in UPDATE, INSERT or the where clause of SELECT statements) 
use <a href="#dbdate">DBDate</a>. It uses a case-sensitive
$dateFormat, which supports: </font>
<pre><font> 
  Y: 4-digit Year
  Q: Quarter (1-4)
  M: Month (Jan-Dec)
  m: Month (01-12)
  d: Day (01-31)
  H: Hour (00-23)
  h: Hour (1-12)
  i: Minute (00-59)
  s: Second (00-60)
  A: AM/PM indicator
  w: day of week (0-6 or 1-7 depending on DB)
  l: day of week (as string - lowercase L)
  W: week in year (0..53 for MySQL, 1..53 for PostgreSQL and Oracle)
  </font></pre>
<p><font>All other characters are treated as strings. You can
    also use \ to escape characters. Available on selected databases, including
mysql, postgresql, mssql, oci8 and DB2. </font></p>
<p><font>This is useful in writing portable sql statements that
    GROUP BY on dates. For example to display total cost of goods sold broken
by quarter (dates are stored in a field called postdate): </font></p>
<pre><font> $sqlfn = $db-&gt;SQLDate('Y-\QQ','postdate'); # get sql that formats postdate to output 2002-Q1<br> $sql = "SELECT $sqlfn,SUM(cogs) FROM table GROUP BY $sqlfn ORDER BY 1 desc";<br> </font></pre>
<p><font><b>MoveNext<a name="movenext"></a>( )</b></font></p>
<p><font>Move the internal cursor to the next row. The <i>$this-&gt;fields</i> array
    is automatically updated. Returns false if unable to do so (normally because
EOF has been reached), otherwise true. </font></p>
<p><font> If EOF is reached, then the $this-&gt;fields array
    is set to false (this was only implemented consistently in ADOdb 3.30). For
    the pre-3.30 behaviour of $this-&gt;fields (at EOF), set the global variable
  $ADODB_COMPAT_FETCH = true.</font></p>
<p><font>Example:</font></p>
<pre><font>$rs = $db-&gt;Execute($sql);<br>if ($rs) <br>	while (!$rs-&gt;EOF) {<br> 		ProcessArray($rs-&gt;fields);	<br>		$rs-&gt;MoveNext();<br>	} </font></pre>
<p><font><b>Move<a name="move"></a>($to)</b></font></p>
<p><font>Moves the internal cursor to a specific row $<b>to</b>.
    Rows are zero-based eg. 0 is the first row. The <b>fields</b> array is automatically
    updated. For databases that do not support scrolling internally, ADOdb will
    simulate forward scrolling. Some databases do not support backward scrolling.
    If the $<b>to</b> position is after the EOF, $<b>to</b> will move to the
    end of the RecordSet for most databases. Some obscure databases using odbc
  might not behave this way.</font></p>
<p><font>Note: This function uses <i>absolute positioning</i>,
unlike Microsoft's ADO.</font></p>
<p><font>Returns true or false. If false, the internal cursor
    is not moved in most implementations, so AbsolutePosition( ) will return
  the last cursor position before the Move( ). </font></p>
<p><font><b>MoveFirst<a name="movefirst"></a>()</b></font></p>
<p><font>Internally calls Move(0). Note that some databases do
not support this function.</font></p>
<p><font><b>MoveLast<a name="movelast"></a>()</b></font></p>
<p><font>Internally calls Move(RecordCount()-1). Note that some
  databases do not support this function.</font></p>
<p><font><b>GetRowAssoc</b><a name="getrowassoc"></a>($toUpper=true)</font></p>
<p><font>Returns an associative array containing the current
    row. The keys to the array are the column names. The column names are upper-cased
  for easy access. To get the next row, you will still need to call MoveNext(). </font></p>
<p><font>For example:<br>
Array ( [ID] =&gt; 1 [FIRSTNAME] =&gt; Caroline [LASTNAME] =&gt; Miranda [CREATED]
=&gt; 2001-07-05 ) </font></p>
<p><font>Note: do not use GetRowAssoc() with $ADODB_FETCH_MODE
    = ADODB_FETCH_ASSOC. Because they have the same functionality, they will
  interfere with each other.</font></p>
<font> 
</font><p><font><b>AbsolutePage<a name="absolutepage"></a>($page=-1) </b></font></p>
<p><font>Returns the current page. Requires PageExecute()/CachePageExecute() to be called. 
  See <a href="#ex8">Example 8</a>.</font></p>
<font>
<p><b>AtFirstPage<a name="atfirstpage">($status='')</a></b></p>
<p>Returns true if at first page (1-based). Requires PageExecute()/CachePageExecute()
  to be called. See <a href="#ex8">Example 8</a>.</p>
<p><b>AtLastPage<a name="atlastpage">($status='')</a></b></p>
<p>Returns true if at last page (1-based). Requires PageExecute()/CachePageExecute()
  to be called. See <a href="#ex8">Example 8</a>.</p>
<p><b>Fields</b><a name="fields"></a>(<b>$colname</b>)</p>
<p>Returns the value of the associated column $<b>colname</b> for the current
  row. The column name is case-insensitive.</p>
<p>This is a convenience function. For higher performance, use <a href="#adodb_fetch_mode">$ADODB_FETCH_MODE</a>. </p>
<p><b>FetchRow</b><a name="fetchrow"></a>()</p> 
</font><p><font>Returns array containing current row, or false
    if EOF. FetchRow( ) internally moves to the next record after returning the
    current row. </font></p>
<p><font>Warning: Do not mix using FetchRow() with MoveNext().</font></p>
<p><font>Usage:</font></p>
<pre><font>$rs = $db-&gt;Execute($sql);<br>if ($rs)<br>	while ($arr = $rs-&gt;FetchRow()) {<br>	   &nbsp;&nbsp;# process $arr	<br>	}</font></pre>
<p><font><b>FetchInto</b><a name="fetchinto"></a>(<b>&amp;$array</b>)</font></p>
<p><font> Sets $array to the current row. Returns PEAR_Error
    object if EOF, 1 if ok (DB_OK constant). If PEAR is undefined, false is returned
    when EOF. FetchInto( ) internally moves to the next record after returning
  the current row. </font></p>
<p><font> FetchRow() is easier to use. See above.</font></p>
<font> </font>
<p><font><b>FetchField<a name="fetchfield"></a>($column_number)</b></font></p>
<p><font>Returns an object containing the <b>name</b>, <b>type</b> and <b>max_length</b> of
    the associated field. If the max_length cannot be determined reliably, it
    will be set to -1. The column numbers are zero-based. See <a href="#ex2">example
  2.</a></font></p>
<p><font><b>FieldCount<a name="fieldcount"></a>( )</b></font></p>
<p><font>Returns the number of fields (columns) in the record
set.</font></p>
<p><font><b>RecordCount<a name="recordcount"></a>( )</b></font></p>
<p><font>Returns the number of rows in the record set. If the
    number of records returned cannot be determined from the database driver
    API, we will buffer all rows and return a count of the rows after all the
    records have been retrieved. This buffering can be disabled (for performance
    reasons) by setting the global variable $ADODB_COUNTRECS = false. When disabled,
    RecordCount( ) will return -1 for certain databases. See the supported databases
  list above for more details. </font></p>
<p><font> RowCount is a synonym for RecordCount.</font></p>
<p><font><b>PO_RecordCount<a name="po_recordcount"></a>($table,
$where)</b></font></p>
<p><font>Returns the number of rows in the record set. If the
    database does not support this, it will perform a SELECT COUNT(*) on the
    table $table, with the given $where condition to return an estimate of the
  recordset size.</font></p>
<p><font>$numrows = $rs-&gt;PO_RecordCount("articles_table", "group=$group");</font></p>
<font><b> NextRecordSet<a name="nextrecordset" id="nextrecordset"></a>()</b> </font>
<p><font>For databases that allow multiple recordsets to be returned
    in one query, this function allows you to switch to the next recordset. Currently
  only supported by mssql driver.</font></p>
<pre><font>$rs = $db-&gt;Execute('execute return_multiple_rs');<br>$arr1 = $rs-&gt;GetArray();<br>$rs-&gt;NextRecordSet();<br>$arr2 = $rs-&gt;GetArray();</font></pre>
<p><font><b>FetchObject<a name="fetchobject"></a>($toupper=true)</b></font></p>
<p><font>Returns the current row as an object. If you set $toupper
    to true, then the object fields are set to upper-case. Note: The newer FetchNextObject()
  is the recommended way of accessing rows as objects. See below.</font></p>
<p><font><b>FetchNextObject<a name="fetchnextobject"></a>($toupper=true)</b></font></p>
<p><font>Gets the current row as an object and moves to the next
    row automatically. Returns false if at end-of-file. If you set $toupper to
  true, then the object fields are set to upper-case. Note that for some drivers such as mssql, you need to SetFetchMode(ADODB_FETCH_ASSOC) or SetFetchMode(ADODB_FETCH_BOTH).</font></p>
<pre><font>$rs = $db-&gt;Execute('select firstname,lastname from table');<br>if ($rs) {<br>	while ($o = $rs-&gt;FetchNextObject()) {<br>		print "$o-&gt;FIRSTNAME, $o-&gt;LASTNAME&lt;BR&gt;";<br>	}<br>}<br></font></pre>
<p><font>There is some trade-off in speed in using FetchNextObject().
If performance is important, you should access rows with the <code>fields[]</code> array. <b>FetchObj<a name="fetchobj" id="fetchobj"></a>()</b> </font></p>
<p><font>Returns the current record as an object. Fields are
    not upper-cased, unlike FetchObject.  
</font></p>
<p><font><b>FetchNextObj<a name="fetchnextobj" id="fetchnextobj"></a>()</b> </font></p>
<p><font>Returns the current record as an object and moves to
    the next record. If EOF, false is returned. Fields are not upper-cased, unlike
  FetctNextObject. </font></p>
<font>
<p><b>CurrentRow<a name="currentrow"></a>( )</b></p>
<p>Returns the current row of the record set. 0 is the first row.</p>
<p><b>AbsolutePosition<a name="abspos"></a>( )</b></p>
<p>Synonym for <b>CurrentRow</b> for compatibility with ADO. Returns the current
  row of the record set. 0 is the first row.</p>
<p><b>MetaType<a name="metatype"></a>($nativeDBType[,$field_max_length],[$fieldobj])</b></p>
<p>Determine what <i>generic</i> meta type a database field type is given its
  native type $<b>nativeDBType</b> as a string and the length of the field $<b>field_max_length</b>.
  Note that field_max_length can be -1 if it is not known. The field object returned
  by FetchField() can be passed in $<b>fieldobj</b> or as the 1st parameter <b>$nativeDBType</b>.
  This is useful for databases such as <i>mysql</i> which has additional properties
  in the field object such as <i>primary_key</i>. </p>
<p>Uses the field <b>blobSize</b> and compares it with $<b>field_max_length</b> to
  determine whether the character field is actually a blob.</p>
For example, $db-&gt;MetaType('char') will return 'C'.
<p>Returns:</p>
<ul>
  <li><b>C</b>: Character fields that should be shown in a &lt;input type="text"&gt; tag. </li>
  <li><b>X</b>: Clob (character large objects), or large text fields that should
    be shown in a &lt;textarea&gt;</li>
  <li><b>D</b>: Date field</li>
  <li><b>T</b>: Timestamp field</li>
  <li><b>L</b>: Logical field (boolean or bit-field)</li>
  <li><b>N</b>: Numeric field. Includes decimal, numeric, floating point, and
    real. </li>
  <li><b>I</b>:&nbsp; Integer field. </li>
  <li><b>R</b>: Counter or Autoincrement field. Must be numeric.</li>
  <li><b>B</b>: Blob, or binary large objects. </li>
</ul> 
</font><p><font> Since ADOdb 3.0, MetaType accepts $fieldobj
    as the first parameter, instead of $nativeDBType. </font></p>
<font> </font>
<p><font><b>Close( )<a name="rsclose"></a></b></font></p>
<p><font>Closes the recordset, cleaning all memory and resources
associated with the recordset. </font></p>
<p>
<font>If memory management is not an issue, you do not need to
call this function as recordsets are closed for you by PHP at the end of the
script. SQL statements such as INSERT/UPDATE/DELETE do not really return a recordset,
so you do not have to call Close() for such SQL statements.</font></p>
<hr />
<h3><font>function rs2html<a name="rs2html"></a>($adorecordset,[$tableheader_attributes],
  [$col_titles])</font></h3>
<p><font>This is a standalone function (rs2html = recordset to
    html) that is similar to PHP's <i>odbc_result_all</i> function, it prints
    a ADORecordSet, $<b>adorecordset</b> as a HTML table. $<b>tableheader_attributes</b> allow
    you to control the table <i>cellpadding</i>, <i>cellspacing</i> and <i>border</i> attributes.
    Lastly you can replace the database column names with your own column titles
    with the array $<b>col_titles</b>. This is designed more as a quick debugging
  mechanism, not a production table recordset viewer.</font></p>
<p><font>You will need to include the file <i>tohtml.inc.php</i>.</font></p>
<p><font>Example of rs2html:<b><font color="#336600"><a name="exrs2html"></a></font></b></font></p>
<pre><font><b><font color="#336600">&lt;?<br>include('tohtml.inc.php')</font></b>; # load code common to ADOdb <br><b>include</b>('adodb.inc.php'); # load code common to ADOdb <br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');   # create a connection <br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers'; <br>$<font color="#663300">rs</font>   = $<font color="#663300">conn</font>-&gt;Execute($sql); <br><font color="#336600"><b>rs2html</b></font><b>($<font color="#663300">rs</font>,'<i>border=2 cellpadding=3</i>',array('<i>Customer Name','Customer ID</i>'));<br>?&gt;</b></font></pre>
<hr />
<h3><font>Differences between this ADOdb library and Microsoft
ADO<a name="adodiff"></a></font></h3>
<ol>
<font>
<li>ADOdb only supports recordsets created by a connection object. Recordsets
  cannot be created independently.</li>
<li>ADO properties are implemented as functions in ADOdb. This makes it easier
  to implement any enhanced ADO functionality in the future.</li>
<li>ADOdb's <font face="Courier New, Courier, mono">ADORecordSet-&gt;Move()</font> uses
  absolute positioning, not relative. Bookmarks are not supported.</li>
<li><font face="Courier New, Courier, mono">ADORecordSet-&gt;AbsolutePosition() </font>cannot
  be used to move the record cursor.</li>
<li>ADO Parameter objects are not supported. Instead we have the ADOConnection::<a href="#parameter">Parameter</a>(
  ) function, which provides a simpler interface for calling preparing parameters
  and calling stored procedures.</li>
<li>Recordset properties for paging records are available, but implemented as
  in <a href="#ex8">Example 8</a>.</li>
</font></ol>
<hr />
<h1><font>Database Driver Guide<a name="driverguide"></a></font></h1>
<p><font>This describes how to create a class to connect to a
    new database. To ensure there is no duplication of work, kindly email me
  at jlim#natsoft.com.my if you decide to create such a class.</font></p>
<p><font>First decide on a name in lower case to call the database
  type. Let's say we call it xbase. </font></p>
<p><font>Then we need to create two classes ADODB_xbase and ADORecordSet_xbase
  in the file adodb-xbase.inc.php.</font></p>
<p><font>The simplest form of database driver is an adaptation
    of an existing ODBC driver. Then we just need to create the class <i>ADODB_xbase
    extends ADODB_odbc</i> to support the new <b>date</b> and <b>timestamp</b> formats,
    the <b>concatenation</b> operator used, <b>true</b> and <b>false</b>. For
    the<i> ADORecordSet_xbase extends ADORecordSet_odbc </i>we need to change
  the <b>MetaType</b> function. See<b> adodb-vfp.inc.php</b> as an example.</font></p>
<p><font>More complicated is a totally new database driver that
    connects to a new PHP extension. Then you will need to implement several
    functions. Fortunately, you do not have to modify most of the complex code.
    You only need to override a few stub functions. See <b>adodb-mysql.inc.php</b> for
  example.</font></p>
<p><font>The default date format of ADOdb internally is YYYY-MM-DD
    (Ansi-92). All dates should be converted to that format when passing to an
    ADOdb date function. See Oracle for an example how we use ALTER SESSION to
  change the default date format in _pconnect _connect.</font></p>
<p><font><b>ADOConnection Functions to Override</b></font></p>
<p><font>Defining a constructor for your ADOConnection derived
  function is optional. There is no need to call the base class constructor.</font></p>
<p><font>_<b>connect</b>: Low level implementation of Connect.
  Returns true or false. Should set the _<b>connectionID</b>.</font></p>
<p><font>_<b>pconnect:</b> Low level implemention of PConnect.
  Returns true or false. Should set the _<b>connectionID</b>.</font></p>
<p><font>_<b>query</b>: Execute a query. Returns the queryID,
or false.</font></p>
<p><font>_<b>close: </b>Close the connection -- PHP should clean
up all recordsets. </font></p>
<p><font><b>ErrorMsg</b>: Stores the error message in the private
variable _errorMsg. </font></p>
<p><font><b>ADOConnection Fields to Set</b></font></p>
<p><font>_<b>bindInputArray</b>: Set to true if binding of parameters
  for SQL inserts and updates is allowed using ?, eg. as with ODBC.</font></p>
<p><font><b>fmtDate</b></font></p>
<p><font><b>fmtTimeStamp</b></font></p>
<p><font><b>true</b></font></p>
<p><font><b>false</b></font></p>
<p><font><b>concat_operator</b></font></p>
<p><font><b>replaceQuote</b></font></p>
<p><font><b>hasLimit</b> support SELECT * FROM TABLE LIMIT 10
of MySQL.</font></p>
<p><font><b>hasTop</b> support Microsoft style SELECT TOP 10
* FROM TABLE.</font></p>
<p><font><b>ADORecordSet Functions to Override</b></font></p>
<p><font>You will need to define a constructor for your ADORecordSet
  derived class that calls the parent class constructor.</font></p>
<p><font><b>FetchField: </b> as documented above in ADORecordSet</font></p>
<p><font>_<b>initrs</b>: low level initialization of the recordset:
    setup the _<b>numOfRows</b> and _<b>numOfFields</b> fields -- called by the
  constructor.</font></p>
<p><font>_<b>seek</b>: seek to a particular row. Do not load
    the data into the fields array. This is done by _fetch. Returns true or false.
    Note that some implementations such as Interbase do not support seek. Set
  canSeek to false.</font></p>
<p><font>_<b>fetch</b>: fetch a row using the database extension
    function and then move to the next row. Sets the <b>fields</b> array. If
    the parameter $ignore_fields is true then there is no need to populate the <b>fields</b> array,
  just move to the next row. then Returns true or false.</font></p>
<p><font>_<b>close</b>: close the recordset</font></p>
<p><font><b>Fields</b>: If the array row returned by the PHP
    extension is not an associative one, you will have to override this. See
    adodb-odbc.inc.php for an example. For databases such as MySQL and MSSQL
    where an associative array is returned, there is no need to override this
  function.</font></p>
<p><font><b>ADOConnection Fields to Set</b></font></p>
<p><font>canSeek: Set to true if the _seek function works.</font></p>
<h2><font>Optimizing PHP</font></h2>
    For info on tuning PHP, read this article on <a href="http://phplens.com/lens/php-book/optimizing-debugging-php.php">Optimizing
  PHP</a>. </font></p>

<h2><font>Change Log<a name="Changes"></a><a name="changes"></a><a name="changelog"></a></font></h2>

<p><a name="4.95"></a><b>4.95/5.01 17 May 2007</b>
<p>CacheFlush debug outp() passed in invalid parameters. Fixed.
<p>Added Thai language file for adodb. Thx Trirat Petchsingh rosskouk#gmail.com and Marcos Pont</p>
<p>Added zerofill checking support to MetaColumns for mysql and mysqli.
<p>CacheFlush no longer deletes all files/directories. Only *.cache files deleted.</p>
<p>DB2 timestamp format changed to var $fmtTimeStamp = "'Y-m-d-H:i:s'";</p>
<p>Added some code sanitization to AutoExecute in adodb-lib.inc.php.</p>
<p>Due to typo, all connections in adodb-oracle.inc.php would become persistent, even non-persistent ones. Fixed.</p>
<P>Oci8 DBTimeStamp uses 24 hour time for input now, so you can perform string comparisons between 2 DBTimeStamp values.</P>
<p>Some PHP4.4 compat issues fixed in adodb-session2.inc.php</p>
<p>For ADOdb 5.01, fixed some adodb-datadict.inc.php MetaType compat issues with PHP5.
<p>The $argHostname was wiped out in adodb-ado5.inc.php. Fixed.
<p>Adodb5 version, added iterator support for adodb_recordset_empty.

<p><a name="4.94"></a><b>4.94 23 Jan 2007</b>
<p>Active Record: $ADODB_ASSOC_CASE=2 did not work properly. Fixed. Thx gmane#auxbuss.com.
<p>mysqli had bugs in BeginTrans() and EndTrans(). Fixed.</p>
<p>Improved error handling when no database is connected for oci8. Thx Andy Hassall.</p>
<p>Names longer than 30 chars in oci8 datadict will be changed to random name. Thx Eugenio. http://phplens.com/lens/lensforum/msgs.php?id=16182
<p>Added var $upperCase = 'ucase' to access and ado_access drivers. Thx Renato De Giovanni renato#cria.org.br</p>
<p>Postgres64 driver, if preparing plan failed in _query, did not handle error properly. Fixed. See http://phplens.com/lens/lensforum/msgs.php?id=16131.
<p>Fixed  GetActiveRecordsClass() reference bug. See http://phplens.com/lens/lensforum/msgs.php?id=16120
<p>

Added handling of nulls in adodb-ado_mssql.inc.php for qstr(). Thx to Felix Rabinovich.
<p>

Adodb-dict contributions by Gaetano:
<br>
+ Support for INDEX in data-dict. Example:
idx_ev1. The ability to define indexes using the INDEX keyword was added in ADOdb 4.94. The following example features mutiple indexes, including a compound index idx_ev1. 
<pre>
  event_id I(11) NOTNULL AUTOINCREMENT PRIMARY,
  event_type I(4) NOTNULL  <b>INDEX idx_evt</b>,
  event_start_date T DEFAULT NULL <b>INDEX id_esd</b>,
  event_end_date T DEFAULT '0000-00-00 00:00:00' <b>INDEX id_eted</b>,
  event_parent I(11) UNSIGNED NOTNULL DEFAULT 0 <b>INDEX id_evp</b>,
  event_owner I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,
  event_project I(11) DEFAULT 0 <b>INDEX idx_ev1</b>,
  event_times_recuring I(11) UNSIGNED NOTNULL DEFAULT 0,
  event_icon C(20) DEFAULT 'obj/event',
  event_description X
</pre>
<br>
+ Prevents the generated SQL from including double drop-sequence statements for REPLACE case of tables with autoincrement columns (on those dbs that emulate it via sequences)
<br>
+ makes any date defined as DEFAULT value for D and T columns work cross-database, not just the "sysdate" value (as long as it is specified using adodb standard format). See above example.
<p>Fixed pdo's GetInsertID() support. Thx Ricky Su.
<p>oci8 Prepare() now sets error messages if an error occurs.
<p>Added 'PT_BR' to SetDateLocale() -- brazilian portugese.
<p>charset in oci8 was not set correctly on *Connect()
<p>ADOConnection::Transpose() now appends as first column the field names.
<p>Added $ADODB_QUOTE_FIELDNAMES. If set to true, will autoquote field names in AutoExecute(),GetInsertSQL(), GetUpdateSQL().
<p>Transpose now adds the field names as the first column after transposition.
<p>Added === check in ADODB_SetDatabaseAdapter for $db, adodb-active-record.inc.php. Thx Christian Affolter.
<p>Added ErrorNo() to adodb-active-record.inc.php. Thx ante#novisplet.com.



<p><a name="4.93"></a><b>4.93 10 Oct 2006</b>
<p>Added support for multiple database connections in performance monitoring code (adodb-perf.inc.php). Now all sql in multiple database connections can be saved into one database ($ADODB_LOG_CONN).
<p>Added MetaIndexes() to odbc_mssql.
<p>Added connection property $db->null2null = 'null'. In autoexecute/getinsertsql/getupdatesql, this value will be converted to a null. Set this to a funny invalid value if you do not want null conversion. See http://phplens.com/lens/lensforum/msgs.php?id=15902.
<p>Path disclosure problem in mysqli fixed. Thx Andy.
<p>Fixed typo in session_schema2.xml.
<p>Changed INT in oci8 to return correct precision in $fld->max_length, MetaColumns(). Thx Eloy Lafuente Plaza.
<p>Patched postgres64 _connect to handle serverinfo(). see http://phplens.com/lens/lensforum/msgs.php?id=15887.
<p>Added pdo fix for null columns. See http://phplens.com/lens/lensforum/msgs.php?id=15889
<p>For stored procedures, missing connection id now passed into mssql_query(). Thx Ecsy (ecsy#freemail.hu).

<p><a name="4.92a"></a><b>4.92a 30 Aug 2006</b>
<p>Syntax error in postgres7 driver. Thx Eloy Lafuente Plaza. 
<p>Minor bug fixes - adodb informix 10 types added to adodb.inc.php. Thx Fernando Ortiz.

<p><a name="4.92"></a><b>4.92 29 Aug 2006</b>

<p>Better odbtp date support.
<P>Added IgnoreErrors() to bypass default error handling.
<p>The _adodb_getcount() function in adodb-lib.inc.php, some ORDER BY bug fixes.
<p>For ibase and firebird, set  $sysTimeStamp = "CURRENT_TIMESTAMP".
<p>Fixed postgres connection bug: http://phplens.com/lens/lensforum/msgs.php?id=11057.
<p>Changed CacheSelectLimit() to flush cache when $secs2cache==-1 due to complaints from other users. 
<p>Added support for using memcached with CacheExecute/CacheSelectLimit. Requires memcache module PECL extension. Usage:
<pre>
$db = NewADOConnection($driver);
$db->memCache = true; /// should we use memCache instead of caching in files
$db->memCacheHost = 126.0.1.1; /// memCache host
$db->memCachePort = 11211; /// this is default memCache port
$db->memCacheCompress = false; /// Use 'true' to store the item compressed (uses zlib)

$db->Connect(...);
$db->CacheExecute($sql);
</pre>
<p>Implemented Transpose() for recordsets. Recordset must be retrieved using ADODB_FETCH_NUM. First column becomes the 
column name.
<pre>
$DB = NewADOConnection('mysql');
$DB->Connect(...);
$DB->SetFetchMode(ADODB_FETCH_NUM);
$rs = $DB->Execute('select productname,productid,unitprice from products limit 10');
$rs2 = $DB->Transpose($rs);
rs2html($rs2);
</pre>
<p><a name="4.91"></a><b>4.91 2 Aug 2006</b>
<p>Major session code rewrite .... See session docs.
<p>PDO bindinputarray was not set properly for MySQL (changed from true to false).
<p>Changed CacheSelectLimit() to re-cache when $secs2cache==0. This is one way to flush the cache when SelectLimit is called.
<p>Added to quotes to mysql  and mysqli: "SHOW COLUMNS FROM `%s`";
<p>Removed accidental optgroup handling in GetMenu().
<a>Fixed ibase _BlobDecode for php5 compat, and also mem alloc issues for small blobs, thx salvatori#interia.pl
<p>Mysql driver OffsetDate() speedup, useful for adodb-sessions.
<p>Fix for GetAssoc() PHP5 compat. See http://phplens.com/lens/lensforum/msgs.php?id=15425
<p>Active Record - If inserting a record and the value of a primary key field is null, then we do not insert that field in as we assume it is an auto-increment field. Needed by mssql.
<p>Changed postgres7 MetaForeignKeys() see http://phplens.com/lens/lensforum/msgs.php?id=15531
<p>DB2 will now return db2_conn_errormsg() when it is a connection error. 
<p><a name="4.90"></a><b>4.90 8 June 2006</b>
<p>Changed adodb_countrec() in adodb-lib.inc.php to allow LIMIT to be used as a speedup to reduce no of records counted.
<p>Added support for transaction modes for postgres and oci8 with SetTransactionMode(). 
These transaction modes affect all subsequent transactions of that connection.
<p>Thanks to Halmai Csongor for suggestion.
<p>Removed $off = $fieldOffset - 1 line in db2 driver, FetchField(). Tx Larry Menard.
<p>Added support for PHP5 objects as Execute() bind parameters using __toString (eg. Simple-XML). Thx Carl-Christian Salvesen.
<p>Rounding in tohtml.inc.php did not work properly. Fixed.
<p>MetaIndexes in postgres fails when fields are deleted then added in again because the attnum has gaps in it. 
See http://sourceforge.net/tracker/index.php?func=detail&aid=1451245&group_id=42718&atid=433976. Fixed.
<p>MetaForeignkeys in mysql and mysqli did not work when fetchMode==ADODB_FETCH_ASSOC used. Fixed.
<p>Reference error in AutoExecute() fixed.
<p>Added macaddr postgres type to MetaType. Maps to 'C'.
<p>Added to _connect() in adodb-ado5.inc.php support for $database and $dataProvider parameters.  Thx Larry Menard.
<p>Added support for sequences in adodb-ado_mssql.inc.php. Thx Larry Menard.
<p>Added ADODB_SESSION_READONLY.
<p>Added session expiryref support to crc32 mode, and in LOB code.
<p>Clear _errorMsg in postgres7 driver, so that ErrorMsg() displays properly when no error occurs.
<p>Added BindDate and BindTimeStamp
<p><a name="4.81"></a><b>4.81 3 May 2006</b>
<p>Fixed variable ref errors in adodb-ado5.inc.php in _query().
<p>Mysqli setcharset fix using method_exists().
<p>The adodb-perf.inc.php CreateLogTable() code now works for user-defined table names.
<p>Error in ibase_blob_open() fixed. See http://phplens.com/lens/lensforum/msgs.php?id=14997
<p><a name="4.80"></a><b>4.80 8 Mar 2006</b>
<p>Added activerecord support.
<p>Added mysql $conn->compat323 = true if you want MySQL 3.23 compat enabled. Fixes GetOne() Select-Limit problems.
<p>Added adodb-xmlschema03.inc.php to support XML Schema version 3 and updated adodb-datadict.htm docs.
<p>Better memory management in Execute. Thx Mike Fedyk.
<p><a name="4.72"></a><b>4.72 21 Feb 2006</b>
<p>Added 'new' DSN parameter for NConnect().
<p>Pager now sanitizes $PHP_SELF to protect against XSS. Thx to James Bercegay and others.
<p>ADOConnection::MetaType changed to setup $rs->connection correctly. 
<p>New native DB2 driver contributed by Larry Menard, Dan Scott, Andy Staudacher, Bharat Mediratta.
<p>The mssql CreateSequence() did not BEGIN TRANSACTION correctly. Fixed. Thx Sean Lee.
<p>The _adodb_countrecs() function in adodb-lib.inc.php has been revised to handle more ORDER BY variations.
<p><a name="4.71"></a><b>4.71 24 Jan 2006</b>
<p>Fixes postgresql security issue related to binary strings. Thx to Andy Staudacher.
<p>Several DSN bugs found:
<p>1. Fix bugs in DSN connections introduced in 4.70 when underscores are found in the DSN. 
<p>2. DSN with _ did not work properly in PHP5 (fine in PHP4). Fixed.
<p>3. Added support for PDO DSN connections in NewADOConnection(), and database parameter in PDO::Connect().
<p>The oci8 datetime flag not correctly implemented in ADORecordSet_array. Fixed.
<p>Added BlobDelete() to postgres, as a counterpoint to UpdateBlobFile().
<p>Fixed GetInsertSQL() to support oci8po.
<p>Fixed qstr() issue with postgresql with \0 in strings.
<p>Fixed some datadict driver loading issues in _adodb_getdriver(). 
<p>Added register shutdown function session_write_close in adodb-session.inc.php for PHP 5 compat. See http://phplens.com/lens/lensforum/msgs.php?id=14200.
<p><a name="4.70"></a><b>4.70 6 Jan 2006</b>
<p>Many fixes from Danila Ulyanov  to ibase, oci8, postgres, mssql, odbc_oracle, odbtp, etc drivers.
<p>Changed usage of binary hint in adodb-session.inc.php for mysql. See 
http://phplens.com/lens/lensforum/msgs.php?id=14160
<p>Fixed invalid variable reference problem in undomq(), adodb-perf.inc.php.
<p>Fixed http://phplens.com/lens/lensforum/msgs.php?id=14254 in adodb-perf.inc.php, _DBParameter() settings of fetchmode was wrong.
<p>Fixed security issues in server.php and tmssql.php discussed by Andreas Sandblad in a Secunia security advisory. Added $ACCEPTIP = 127.0.0.1
and changed suggested root password to something more secure.
<p>Changed pager to close recordset after RenderLayout().
<p><a name="4.68"></a><b>4.68 25 Nov  2005</b>
<p>PHP 5 compat for mysqli. MetaForeignKeys repeated twice and MYSQLI_BINARY_FLAG missing.
<p>PHP 5.1 support for postgresql bind parameters using ? did not work if >= 10 parameters. Fixed. Thx to Stanislav Shramko.
<p>Lots of PDO improvements.
<p>Spelling error fixed in mysql MetaForeignKeys, $associative parameter.
<p><a name="4.67"></a><b>4.67 16 Nov  2005</b>
<p>Postgresql not_null flag not set to false correctly. Thx Cristian MARIN.
<p>We now check in Replace() if key is in fieldArray. Thx Sbastien Vanvelthem.
<p>_file_get_contents() function was missing in xmlschema. fixed.
<p>Added week in year support to SQLDate(), using 'W' flag. Thx Spider.
<p>In sqlite metacolumns was repeated twice, causing PHP 5 problems. Fixed.
<p>Made debug output XHTML compliant. 
<p><a name="4.66"></a><b>4.66 28 Sept  2005</b>
<p>ExecuteCursor() in oci8 did not clean up properly on failure. Fixed.
<p>Updated xmlschema.dtd, by "Alec Smecher" asmecher#smecher.bc.ca
<p>Hardened SelectLimit, typecasting nrows and offset to integer.
<p>Fixed misc bugs in AutoExecute() and GetInsertSQL().
<p>Added $conn->database as the property holding the database name. The older $conn->databaseName is retained for backward
compat.
<p>Changed _adodb_backtrace() compat check to use function_exists().
<p>Bug in postgresql MetaIndexes fixed. Thx Kevin Jamieson. 
<p>Improved OffsetDate for MySQL, reducing rounding error.
<p>Metacolumns added to sqlite. Thx Mark Newnham.
<p>PHP 4.4 compat fixes for GetAssoc().
<p>Added postgresql bind support for php 5.1. Thx Cristiano da Cunha Duarte
<p>OffsetDate() fixes for postgresql, typecasting strings to date or timestamp.
<p>DBTimeStamp formats for mssql, odbc_mssql and postgresql made to conform with other db's.
<p>Changed PDO constants from PDO_ to PDO:: to support latest spec.
<p><a name="4.65"></a><b>4.65 22 July  2005</b>
<p>Reverted 'X' in mssql datadict to 'TEXT' to be compat with mssql driver. However now you can 
set $datadict->typeX = 'varchar(4000)' or 'TEXT' or 'CLOB' for mssql and oci8 drivers. 
<p>Added charset support when using DSN for Oracle.
<p>_adodb_getmenu did not use fieldcount() to get number of fields. Fixed.
<p>MetaForeignKeys() for mysql/mysqli contributed by Juan Carlos Gonzalez.
<p>MetaDatabases() now correctly returns an array for mysqli driver. Thx Cristian MARIN.
<p>CompleteTrans(false) did not return false. Fixed. Thx to JMF.
<p>AutoExecute() did not work with Oracle. Fixed. Thx Jos Moreira.
<p>MetaType() added to connection object.
<p>More PHP 4.4 reference return fixes. Thx Ryan C Bonham and others.

<p><a name="4.64"></a><b>4.64 20 June 2005</b>
<p>In datadict, if the default field value is set to '', then it is not applied when the field is created. Fixed by Eugenio.
<p>MetaPrimaryKeys for postgres did not work because of true/false change in 4.63. Fixed.
<p>Tested ocifetchstatement in oci8. Rejected at the end.
<p>Added port to dsn handling. Supported in postgres, mysql, mysqli,ldap.
<p>Added  'w' and 'l' to mysqli SQLDate().
<p>Fixed error handling in ldap _connect() to be more consistent. Also added ErrorMsg() handling to ldap.
<p>Added support for union in _adodb_getcount, adodb-lib.inc.php for postgres and oci8.
<p>rs2html() did not work with null dates properly.
<p>PHP 4.4 reference return fixes.

<p><a name="4.63"></a><b>4.63  18 May 2005</b>
<p>Added $nrows<0 check to mysqli's SelectLimit().
<p>Added OptimizeTable() and OptimizeTables() in adodb-perf.inc.php. By Markus Staab.
<p>PostgreSQL inconsistencies fixed. true and false set to TRUE and FALSE, and boolean type in datadict-postgres.inc.php set
to 'L' => 'BOOLEAN'. Thx Kevin Jamieson.
<p>New adodb_session_create_table() function in adodb-session.inc.php. By Markus Staab.
<p>Added null check to UserTimeStamp().
<p>Fixed typo in mysqlt driver in adorecordset. Thx to Andy Staudacher.
<p>GenID() had a bug in the raiseErrorFn handling. Fixed. Thx Marcos Pont.
<p>Datadict name quoting now handles ( ) in index fields correctly - they aren't part of the index field.
<p>Performance monitoring: (1) oci8 Ixora checks moved down; (2) expensive sql changed so that only those sql with 
count(*)>1 are shown; (3) changed sql1 field to a length+crc32 checksum - this breaks backward compat.
<p>We remap firebird15 to firebird in data dictionary.

<p><a name="4.62"></a><b>4.62  2 Apr 2005</b>
<p>Added 'w' (dow as 0-6 or 1-7) and 'l' (dow as string) for SQLDate for oci8, postgres and mysql.
<p>Rolled back MetaType() changes for mysqli done in prev version.
<p>Datadict change by chris, cblin#tennaxia.com data mappings from:
<pre>
oci8:  X->varchar(4000) XL->CLOB
mssql: X->XL->TEXT
mysql: X->XL->LONGTEXT
fbird: X->XL->varchar(4000)
</pre>
<p>to:
<pre>
oci8:  X->varchar(4000) XL->CLOB
mssql: X->VARCHAR(4000) XL->TEXT
mysql: X->TEXT          XL->LONGTEXT
fbird: X->VARCHAR(4000) XL->VARCHAR(32000)
</pre>
<p>Added $connection->disableBlobs to postgresql to improve performance when no bytea is used (2-5% improvement).
<p>Removed all HTTP_* vars.
<p>Added $rs->tableName to be set before calling AutoExecute().
<p>Alex Rootoff rootoff#pisem.net contributed ukrainian language file.
<p>Added new mysql_option() support using $conn->optionFlags array.
<p>Added support for ldap_set_option() using the $LDAP_CONNECT_OPTIONS global variable. Contributed by Josh Eldridge.
<p>Added LDAP_* constant definitions to ldap.
<p>Added support for boolean bind variables. We use $conn->false and $conn->true to hold values to set false/true to.
<p>We now do not close the session connection in adodb-session.inc.php as other objects could be using this connection.
<p>We now strip off \0 at end of Ixora SQL strings in $perf->tohtml() for oci8.
<p><a name="4.61"></a><b>4.61 23 Feb 2005</b>
<p>MySQLi added support for mysqli_connect_errno() and mysqli_connect_error().
<p>Massive improvements to alpha PDO driver.
<p>Quote string bind parameters logged by performance monitor for easy type checking. Thx Jason Judge.
<p>Added support for $role when connecting with Interbase/firebird.
<p>Added support for enum recognition in MetaColumns() mysql and mysqli. Thx Amedeo Petrella.
<p>The sybase_ase driver contributed by Interakt Online. Thx Cristian Marin cristic#interaktonline.com.
<p>Removed not_null, has_default, and default_value from ADOFieldObject.
<p>Sessions code, fixed quoting of keys when handling LOBs in session write() function.
<p>Sessions code, added adodb_session_regenerate_id(), to reduce risk of session hijacking by changing session cookie dynamically. Thx Joe Li.
<p>Perf monitor, polling for CPU did not work for PHP 4.3.10 and 5.0.0-5.0.3 due to PHP bugs, so we special case these versions.
<p>Postgresql, UpdateBlob() added code to handle type==CLOB.
<p><a name="4.60"></a><b>4.60 24 Jan 2005</b>
<p>Implemented PEAR DB's autoExecute(). Simplified design because I don't like using constants when
strings work fine.
<p>_rs2serialize will now update $rs->sql and $rs->oldProvider.
<p>Added autoExecute().
<p>Added support for postgres8 driver. Currently just remapped to postgres7 driver.
<p>Changed oci8 _query(), so that OCIBindByName() sets the length to -1 if element size is > 4000. This provides better support
for LONGs.
<p>Added SetDateLocale() support for netherlands (Nl).
<p>Spelling error in pivot code ($iff should be $iif).
</p><p>mysql insert_id() did not work with mysql 3.x. Fixed.
</p><p>"\r\n" not converted to spaces correctly in exporting data. Fixed.
</p><p>_nconnect() in mysqli did not return value correctly. Fixed.
</p><p>Arne Eckmann contributed danish language file.
</p><p>Added clone() support to FetchObject() for PHP5.<br>
</p>
<p>Removed SQL_CUR_USE_ODBC from odbc_mssql.<br>
</p>
<p><a name="4.55"></a><b>4.55 5 Jan 2005</b>
</p><p>Found bug in Execute() with bind params for db's that do not support binding natively.
</p><p>DropSequence() now correctly uses default parameter.
</p><p>Now Execute() ignores locale for floats, so 1.23 is NEVER converted to 1,23.
</p><p>SetFetchMode() not properly saved in adodb-perf, suspicious sql and expensive sql. Fixed.
</p><p>Added INET to postgresql metatypes. Thx motzel.
</p><p>Allow oracle hints to work when counting with _adodb_getcount in adodb-lib.inc.php. Thx Chris Wrye.
</p><p>Changed mysql insert_id() to use SELECT LAST_INSERT_ID().
</p><p>If alter col in datadict does not modify col type/size of actual
col, then it is removed from alter col code. By Mark Newham. Not
perfect as MetaType() !== ActualType().
</p><p>Added handling of view fields in metacolumns() for postgresql. Thx Renato De Giovanni.
</p><p>Added to informix MetaPrimaryKeys and MetaColumns fixes for null bit. Thx to Cecilio Albero.
</p><p>Removed obsolete connection_timeout() from perf code.
</p><p>Added support for arrayClass in adodb-csv.inc.php.
</p><p>RSFilter now accepts methods of the form $array($obj, 'methodname'). Thx to blake#near-time.com.
</p><p>Changed CacheFlush to $cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/[0-9a-f][0-9a-f]/'; 
</p><p>For better cursor concurrency, added code to free ref cursors in
oci8 when $rs-&gt;Close() is called. Note that CLose() is called
internally by the Get* functions too.
</p><p>Added IIF support for access when pivoting.  Thx Volodia Krupach.
</p><p>Added mssql datadict support for timestamp. Thx Alexios.
</p><p>Informix pager fix. By Mario Ramirez.
</p><p>ADODB_TABLE_REGEX now includes ':'. By Mario Ramirez.
</p><p>Mark Newnham contributed MetaIndexes for oci8 and db2.
</p><p><a name="4.54"></a><b>4.54 5 Nov 2004</b>
</p><p>
Now you can set $db-&gt;charSet = ?? before doing a Connect() in oci8.
</p><p>
Added adodbFetchMode to sqlite.
</p><p>
Perf code, added a string typecast to substr in adodb_log_sql().
</p><p>
Postgres: Changed BlobDecode() to use po_loread, added new $maxblobsize parameter, and now it returns the blob instead
of sending it to stdout - make sure to mention that as a compat warning.
Also added $db-&gt;IsOID($oid) function; uses a heuristic, not guaranteed to work 100%.
</p><p>
Contributed arabic language file by "El-Shamaa, Khaled" k.el-shamaa#cgiar.org
</p><p>
PHP5 exceptions did not handle @ protocol properly. Fixed.
</p><p>
Added ifnull handling for postgresql (using coalesce).
</p><p>
Added  metatables() support for Postgresql 8.0 (no longer uses pg_% dictionary tables).
</p><p>
Improved Sybase ErrorMsg() function. By Gaetano Giunta.
</p><p>
Improved oci8 SelectLimit() to use Prepare(). By Cristiano Duarte.
</p><p>
Type-cast $row parameter in ifx_fetch_row() to int. Thx stefan bodgan.
</p><p>Ralf becker contributed improvements in postgresql, sapdb, mysql data dictionary handling:<br>
- MySql and Postgres MetaType was reporting every int column which was 
part of a primary key and unique as serial<br>
- Postgres was not reporting the scale of decimal types<br>
- MaxDB was padding the defaults of none-string types with spaces<br>
- MySql now correctly converts enum columns to varchar
</p><p>
Ralf also changed Postgresql datadict:<br>
- you cant add NOT NULL columns in postgres in one go, they need to be 
added as NULL and then altered to NOT NULL<br>
- AlterColumnSQL could not change a varchar column with numbers into an 
integer column, postgres need an explicit conversation<br>
- a re-created sequence was not set to the correct value, if the name 
was the old name (no implicit sequence), now always the new name of the 
implicit sequence is used<br>
</p><p>Sergio Strampelli added extra $intoken check to Lens_ParseArgs() in datadict code.
</p><p><a name="4.53"></a><b>4.53 28 Sept 2004</b>
</p><p>FetchMode cached in recordset is sometimes mapped to native db fetchMode. Normally this does not matter,
but when using cached recordsets, we need to switch back to using adodb fetchmode.  So we cache this
in $rs-&gt;adodbFetchMode if it differs from the db's fetchMode.
</p><p>For informix we now set canSeek = false driver because stefan bodgan tells me that seeking doesn't work. 
</p><p>SetDateLocale() never worked till now ;-) Thx david#tomato.it
</p><p>Set $_bindInputArray = true in sapdb driver. Required for clob support.
</p><p>Fixed some PEAR::DB emulation issues with isError() and isWarning. Thx to Gert-Rainer Bitterlich.
</p><p>Empty() used in getupdatesql without strlen() check. Fixed.</p>
<p>Added unsigned detection to mysql and mysqli drivers. Thx to dan cech.
</p><p>Added hungarian language file. Thx to Hal&aacute;szv&aacute;ri G&aacute;bor.
</p><p>Improved fieldname-type formatting of datadict SQL generated (adding $widespacing parameter to _GenField).
</p><p>Datadict oci8 DROP CONSTRAINTS misspelt. Fixed. Thx Mark Newnham.
</p><p>Changed odbtp to dynamically change databaseType based on connection, eg. from 'odbtp' to 'odbtp_mssql' when connecting
to mssql database.
</p><p>In datadict, MySQL I4 was wrongly mapped to MEDIUMINT, which is actually I3. Fixed.
</p><p>Fixed mysqli MetaType() recognition. Mysqli returns numeric types unlike mysql extension. Thx Francesco Riosa.
</p><p>VFP odbc driver curmode set wrongly, causing problems with memo fields. Fixed.
</p><p>Odbc driver did not recognize odbc version 2 driver date types properly. Fixed. Thx Bostjan.
</p><p>ChangeTableSQL() fixes to datadict-db2.inc.php by Mark Newnham.
</p><p>Perf monitoring with odbc improved. Now we try in perf code to manually set the sysTimeStamp using date() if sysTimeStamp
is empty.
</p><p>All ADO errors are thrown as exceptions in PHP5. 
So we added exception handling to ado in PHP5 by creating new adodb-ado5.inc.php driver.
</p><p>Added IsConnected(). Returns true if connection object connected. By Luca.Gioppo.
</p><p>"Ralf Becker"
RalfBecker#digitalROCK.de contributed new sapdb data-dictionary driver
and a large patch that implements field and table renaming for oracle,
mssql, postgresql, mysql and sapdb. See the new RenameTableSQL() and
RenameColumnSQL() functions.
</p><p>We now check ExecuteCursor to see if PrepareSP was initially called.
</p><p>Changed oci8 datadict to use MODIFY for $dd-&gt;alterCol. Thx Mark Newnham.
</p><p><a name="4.52"></a><b>4.52  10 Aug 2004</b>
</p><p>Bug found in Replace() when performance logging enabled, introduced in ADOdb 4.50. Fixed.
</p><p>Replace() checks update stmt. If update stmt fails, we now return immediately. Thx to alex.
</p><p>Added support for $ADODB_FORCE_TYPE in GetUpdateSQL/GetInsertSQL. Thx to niko.
</p><p>Added ADODB_ASSOC_CASE support to postgres/postgres7 driver.
</p><p>Support for DECLARE stmt in oci8. Thx Lochbrunner.
</p><p><a name="4.51"></a><b>4.51  29 July  2004</b>
</p><p>Added adodb-xmlschema 1.0.2. Thx dan and richard.
</p><p>Added new adorecordset_ext_* classes. If ADOdb extension installed for mysql, mysqlt and oci8 
(but not oci8po),  we use the superfast ADOdb extension code for movenext.
</p><p>Added schema support to mssql and odbc_mssql MetaPrimaryKeys().
</p><p>Patched MSSQL driver to support PHP NULL and Boolean values 
while binding the input array parameters in the _query() function. By Stephen Farmer.
</p><p>Added support for clob's for mssql,  UpdateBlob(). Thx to gfran#directa.com.br
</p><p>Added normalize support for postgresql (true=lowercase table name, or false=case-sensitive table names) 
to MetaColumns($table, $normalize=true).
</p><p>PHP5 variant dates in ADO not working. Fixed in adodb-ado.inc.php.
</p><p>Constant ADODB_FORCE_NULLS was not working properly for many releases (for GetUpdateSQL). Fixed. 
Also GetUpdateSQL strips off ORDER BY now - thx Elieser Le&atilde;o.
</p><p>Perf Monitor for oci8 now dynamically highlights optimizer_* params if too high/low.
</p><p>Added dsn support to NewADOConnection/ADONewConnection.
</p><p>Fixed out of page bounds bug in _adodb_pageexecute_all_rows() Thx to "Sergio Strampelli" sergio#rir.it
</p><p>Speedup of movenext for mysql and oci8 drivers.
</p><p>Moved debugging code _adodb_debug_execute() to adodb-lib.inc.php.
</p><p>Fixed postgresql bytea detection bug. See http://phplens.com/lens/lensforum/msgs.php?id=9849.
</p><p>Fixed ibase datetimestamp typo in PHP5. Thx stefan.
</p><p>Removed whitespace at end of odbtp drivers.
</p><p>Added db2 metaprimarykeys fix.
</p><p>Optimizations to MoveNext() for mysql and oci8. Misc speedups to Get* functions.
</p><p><a name="4.50"></a><b>4.50  6 July  2004</b>
</p><p>Bumped it to 4.50 to avoid confusion with PHP 4.3.x series.
</p><p>Added db2 metatables and metacolumns extensions.
</p><p>Added alpha PDO driver. Very buggy, only works with odbc.
</p><p>Tested mysqli. Set poorAffectedRows = true. Cleaned up movenext() and _fetch().
</p><p>PageExecute does not work properly with php5 (return val not a variable). Reported Dmytro Sychevsky sych#php.com.ua.  Fixed.
</p><p>MetaTables() for mysql, $showschema parameter was not backward compatible with older versions of adodb. Fixed.
</p><p>Changed mysql GetOne() to work with mysql 3.23 when using with non-select stmts (e.g. SHOW TABLES).
</p><p>Changed TRIG_ prefix to a variable in datadict-oci8.inc.php. Thx to Luca.Gioppo#csi.it.
</p><p>New to adodb-time code. We allow you to define your own daylights savings function, 
adodb_daylight_sv for pre-1970 dates. If the function is defined 
(somewhere in an include), then you can correct 
for daylights savings. See http://phplens.com/phpeverywhere/node/view/16#daylightsavings
for more info.
</p><p>New sqlitepo driver. This is because assoc mode does not work like other drivers in sqlite.
   Namely, when selecting (joining) multiple tables, in assoc mode the table
   	  names are included in the assoc keys in the "sqlite" driver.
	  In "sqlitepo" driver, the table names are stripped from the returned column names. 
	  When this results in a conflict,  the first field get preference.
	Contributed by Herman Kuiper  herman#ozuzo.net  
</p><p>Added $forcenull parameter to GetInsertSQL/GetUpdateSQL. Idea by Marco Aurelio Silva.
</p><p>More XHTML changes for GetMenu. By Jeremy Evans.
</p><p>Fixes some ibase date issues. Thx to stefan bogdan.
</p><p>Improvements to mysqli driver to support $ADODB_COUNTRECS.
</p><p>Fixed adodb-csvlib.inc.php problem when reading stream from socket. We need to poll stream continiously.
</p><p><a name="4.23"></a><b>4.23  16 June   2004</b>
</p><p>
New interbase/firebird fixes thx to Lester Caine.
Driver fixes a problem with getting field names in the result array, and 
corrects a couple of data conversions. Also we default to dialect3 for firebird.
Also ibase sysDate property was wrong. Changed to cast as timestamp.
</p><p>
The datadict driver is set up to give quoted tables and fields as this 
was the only way round reserved words being used as field names in 
TikiWiki. TikiPro is tidying that up, and I hope to be able to produce a 
build of THAT which uses what I consider proper UPPERCASE field and 
table names. The conversion of TikiWiki to ADOdb helped in that, but 
until the database is completely tidied up in TikiPro ...
</p><p>Modified _gencachename() to include fetchmode in name hash.
This means you should clear your cache directory after installing this release as the 
cache name algorithm has changed.
</p><p>Now Cache* functions work in safe
mode, because we do not create sub-directories in the $ADODB_CACHE_DIR
in safe mode. In non-safe mode we still create sub-directories. Done by
modifying _gencachename().
</p><p>Added $gmt parameter (true/false)
to UserDate and UserTimeStamp in connection class, to force conversion
of input (in local time) to be converted to UTC/GMT.
</p><p>Mssql datadict did not support INT types properly (no size param allowed). 
Added _GetSize() to datadict-mssql.inc.php.
</p><p>For borland_ibase, BeginTrans(), changed:<br>
</p><pre>   $this-&gt;_transactionID = $this-&gt;_connectionID;</pre>
to<br>
<pre>   $this-&gt;_transactionID = ibase_trans($this-&gt;ibasetrans, $this-&gt;_connectionID);</pre>
		
<p>Fixed typo in mysqi_field_seek(). Thx to Sh4dow (sh4dow#php.pl).
</p><p>LogSQL did not work with Firebird/Interbase. Fixed.
</p><p>Postgres: made errorno() handling more consistent. Thx to Michael Jahn, Michael.Jahn#mailbox.tu-dresden.de.
</p><p>Added informix patch to better support metatables, metacolumns by "Cecilio Albero" c-albero#eos-i.com
</p><p>Cyril Malevanov contributed patch to oci8 to support passing of LOB parameters:
</p><pre>	$text = 'test test test';<br>	$sql = "declare rs clob; begin :rs := lobinout(:sa0); end;";<br>	$stmt = $conn -&gt; PrepareSP($sql);<br>	$conn -&gt; InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB);<br>	$rs = '';<br>	$conn -&gt; OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);<br>	$conn -&gt; Execute($stmt);<br>	echo "return = ".$rs."&lt;br&gt;";<br></pre>
As he says, the LOBs limitations are:
<pre> - use OCINewDescriptor before binding<br> - if Param is IN, uses save() before each execute. This is done automatically for you.<br> - if Param is OUT, uses load() after each execute. This is done automatically for you.<br> - when we bind $var as LOB, we create new descriptor and return it as a<br>   Bind Result, so if we want to use OUT parameters, we have to store<br>   somewhere &amp;$var to load() data from LOB to it.<br> - IN OUT params are not working now (should not be a big problem to fix it)<br> - now mass binding not working too (I've wrote about it before)<br></pre>
<p>Simplified Connect() and PConnect() error handling.
</p><p>When extension not loaded, Connect() and PConnect() will return null. On connect error, the fns will return false.
</p><p>CacheGetArray() added to code.
</p><p>Added Init() to adorecordset_empty().
</p><p>Changed postgres64 driver, MetaColumns() to not strip off quotes in default value if :: detected (type-casting of default).
</p><p>Added test: if (!defined('ADODB_DIR')) die(). Useful to prevent hackers from detecting file paths.
</p><p>Changed metaTablesSQL to ignore Postgres 7.4 information schemas (sql_*).
</p><p>New polish language file by  Grzegorz Pacan
</p><p>Added support for UNION in _adodb_getcount().
</p><p>Added security check for ADODB_DIR to limit path disclosure issues. Requested by postnuke team.
</p><p>Added better error message support to oracle driver. Thx to Gaetano Giunta.
</p><p>Added showSchema support to mysql.
</p><p>Bind in oci8 did not handle $name=false properly. Fixed.
</p><p>If extension not loaded, Connect(), PConnect(), NConnect() will return null.
</p><p><b>4.22  15 Apr   2004</b>
</p><p>Moved docs to own adodb/docs folder.
</p><p>Fixed session bug when quoting compressed/encrypted data in Replace().
</p><p>Netezza Driver and LDAP drivers contributed by Josh Eldridge.
</p><p>GetMenu now uses rtrim() on values instead of trim().
</p><p>Changed MetaColumnNames to return an associative array, keys being the field names in uppercase.
</p><p>Suggested fix to adodb-ado.inc.php affected_rows to support PHP5 variants. Thx to Alexios Fakos.
</p><p>Contributed bulgarian language file by Valentin Sheiretsky valio#valio.eu.org.
</p><p>Contributed romanian language file by stefan bogdan.
</p><p>GetInsertSQL now checks for table name (string) in $rs, and will create a recordset for that
table automatically. Contributed by Walt Boring. Also added OCI_B_BLOB in bind on Walt's request - hope
it doesn't break anything :-)
</p><p>Some minor postgres speedups in _initrs().
</p><p> ChangeTableSQL checks now if MetaColumns returns empty. Thx Jason Judge.
</p><p>Added ADOConnection::Time(), returns current database time in unix timestamp format, or false.
</p><p><b>4.21 20 Mar 2004</b>
</p><p>We no longer in SelectLimit for VFP driver add SELECT TOP X unless an ORDER BY exists.
</p><p>Pim Koeman contributed dutch language file adodb-nl.inc.php.
</p><p>Rick Hickerson added CLOB support to db2 datadict.
</p><p>Added odbtp driver. Thx to "stefan bogdan" sbogdan#rsb.ro.
</p><p>Changed PrepareSP() 2nd parameter, $cursor, to default to true (formerly false). Fixes oci8 backward
compat problems with OUT params.
</p><p>Fixed month calculation error in adodb-time.inc.php. 2102-June-01 appeared as 2102-May-32.
</p><p>Updated PHP5 RC1 iterator support. API changed, hasMore() renamed to valid().
</p><p>Changed internal format of serialized cache recordsets. As we store a version number, this should be
backward compatible.
</p><p>Error handling when driver file not found was flawed in ADOLoadCode(). Fixed.
</p><p><b>4.20 27 Feb 2004</b>
</p><p>Updated to AXMLS 1.01.
</p><p>MetaForeignKeys for postgres7 modified by Edward Jaramilla, works on pg 7.4.
</p><p>Now numbers accepts function calls or sequences for GetInsertSQL/GetUpdateSQL numeric fields.
</p><p>Changed quotes of 'delete from $perf_table' to "". Thx Kehui (webmaster#kehui.net)
</p><p>Added ServerInfo() for ifx, and putenv trim fix. Thx Fernando Ortiz.
</p><p>Added addq(), which is analogous to addslashes().
</p><p>Tested with php5b4. Fix some php5 compat problems with exceptions and sybase.
</p><p>Carl-Christian Salvesen added patch to mssql _query to support binds greater than 4000 chars.
</p><p>Mike suggested patch to PHP5 exception handler. $errno must be numeric.
</p><p>Added double quotes (") to ADODB_TABLE_REGEX.
</p><p>For oci8, Prepare(...,$cursor),
$cursor's meaning was accidentally inverted in 4.11. This causes
problems with ExecuteCursor() too, which calls Prepare() internally.
Thx to William Lovaton.
</p><p>Now dateHasTime property in connection object renamed to datetime for consistency. This could break bc.
</p><p>Csongor Halmai reports that db2 SelectLimit with input array is not working. Fixed..
</p><p><b>4.11 27 Jan 2004</b>
</p><p>Csongor Halmai reports db2 binding not working. Reverted back to emulated binding.
</p><p>Dan Cech modifies datadict code. Adds support for DropIndex. Minor cleanups.
</p><p>Table misspelt in perf-oci8.inc.php. Changed v$conn_cache_advice to v$db_cache_advice. Reported by Steve W.
</p><p>UserTimeStamp and DBTimeStamp did not handle YYYYMMDDHHMMSS format properly. Reported by Mike Muir. Fixed.
</p><p>Changed oci8 Prepare(). Does not auto-allocate OCINewCursor automatically, unless 2nd param is set to true.
This will break backward compat, if Prepare/Execute is used instead of ExecuteCursor. Reported by Chris Jones.
</p><p>Added InParameter() and OutParameter(). Wrapper functions to Parameter(), but nicer because they
are self-documenting.
</p><p>Added 'R' handling in ActualType() to datadict-mysql.inc.php
</p><p>Added ADOConnection::SerializableRS($rs). Returns a recordset that can be serialized in a session.
</p><p>Added "Run SQL" to performance UI().
</p><p>Misc spelling corrections in adodb-mysqli.inc.php, adodb-oci8.inc.php and datadict-oci8.inc.php, from Heinz Hombergs.
</p><p>MetaIndexes() for ibase contributed by Heinz Hombergs.
</p><p><b>4.10 12 Jan 2004</b>
</p><p>Dan Cech contributed extensive changes to data dictionary to support name quoting (with `), and drop table/index.
</p><p>Informix added cursorType property. Default remains IFX_SCROLL, but you can change to 0 (non-scrollable cursor) for performance.
</p><p>Added ADODB_View_PrimaryKeys() for returning view primary keys to MetaPrimaryKeys().
</p><p>Simplified chinese file, adodb-cn.inc.php from cysoft.
</p><p>Added check for ctype_alnum in adodb-datadict.inc.php. Thx to Jason Judge.
</p><p>Added connection parameter to ibase Prepare(). Fix by Daniel Hassan.
</p><p>Added nameQuote for quoting identifiers and names to connection obj. Requested by Jason Judge. Also the
data dictionary parser now detects `field name` and generates column names with spaces correctly.
</p><p>BOOL type not recognised correctly as L. Fixed.
</p><p>Fixed paths in ADODB_DIR for session files, and back-ported it to 4.05 (15 Dec 2003)
</p><p>Added Schema to postgresql MetaTables. Thx to col#gear.hu
</p><p>Empty postgresql recordsets that had blob fields did not set EOF properly. Fixed.
</p><p>CacheSelectLimit internal parameters to SelectLimit were wrong. Thx to Nio.
</p><p>Modified adodb_pr() and adodb_backtrace() to support command-line usage (eg. no html).
</p><p>Fixed some fr and it lang errors. Thx to Gaetano G.
</p><p>Added contrib directory, with adodb rs to xmlrpc convertor by Gaetano G.
</p><p>Fixed array recordset bugs when _skiprow1 is true. Thx to Gaetano G.
</p><p>Fixed pivot table code when count is false.
</p><p>

</p><p><b>4.05 13 Dec 2003 </b>
</p><p>Added MetaIndexes to data-dict code - thx to Dan Cech.
</p><p>Rewritten session code by Ross Smith. Moved code to adodb/session directory.
</p><p>Added function exists check on connecting to most drivers, so we don't crash with the unknown function error.
</p><p>Smart Transactions failed with GenID() when it no seq table has been created because the sql
	statement fails. Fix by Mark Newnham.
</p><p>Added $db-&gt;length, which holds name of function that returns strlen.
</p><p>Fixed error handling for bad driver in ADONewConnection - passed too few params to error-handler.
</p><p>Datadict did not handle types like 16.0 properly in _GetSize. Fixed.
</p><p>Oci8 driver SelectLimit() bug &amp;= instead of =&amp; used. Thx to Swen Th&uuml;mmler.
</p><p>Jesse Mullan suggested not flushing outp when output buffering enabled. Due to Apache 2.0 bug. Added.
</p><p>MetaTables/MetaColumns return ref bug with PHP5 fixed in adodb-datadict.inc.php.
</p><p>New mysqli driver contributed by Arjen de Rijke. Based on adodb 3.40 driver.
Then jlim added BeginTrans, CommitTrans, RollbackTrans, IfNull, SQLDate. Also fixed return ref bug.
</p><p>$ADODB_FLUSH added, if true then force flush in debugging outp. Default is false.  In earlier
versions, outp defaulted to flush, which is not compat with apache 2.0.
</p><p>Mysql driver's GenID() function did not work when when sql logging is on. Fixed.
</p><p>$ADODB_SESSION_TBL not declared as global var. Not available if adodb-session.inc.php included in function. Fixed.
</p><p>The input array not passed to Execute() in _adodb_getcount(). Fixed.
</p><p><b>4.04 13 Nov 2003 </b>
</p><p>Switched back to foreach - faster than list-each.
</p><p>Fixed bug in ado driver - wiping out $this-&gt;fields with date fields.
</p><p>Performance Monitor, View SQL, Explain Plan did not work if strlen($SQL)&gt;max($_GET length). Fixed.
</p><p>Performance monitor, oci8 driver added memory sort ratio.
</p><p>Added random property, returns SQL to generate a floating point number between 0 and 1;
</p><p><b>4.03 6 Nov 2003 </b>
</p><p>The path to adodb-php4.inc.php and adodb-iterators.inc.php was not setup properly.
</p><p>Patched SQLDate in interbase to support hours/mins/secs. Thx to ari kuorikoski.
</p><p>Force autorollback for pgsql persistent connections - 
apparently pgsql did not autorollback properly before 4.3.4. See http://bugs.php.net/bug.php?id=25404
</p><p><b>4.02 5 Nov 2003 </b>
</p><p>Some errors in adodb_error_pg() fixed. Thx to Styve.
</p><p>Spurious Insert_ID() error was generated by LogSQL(). Fixed.
</p><p>Insert_ID was interfering with Affected_Rows() and Replace()  when LogSQL() enabled. Fixed.
</p><p>More foreach loops optimized with list/each.
</p><p>Null dates not handled properly in ADO driver (it becomes 31 Dec 1969!).
</p><p>Heinz Hombergs contributed patches for mysql MetaColumns - adding scale, made
interbase MetaColumns work with firebird/interbase, and added lang/adodb-de.inc.php.
</p><p>Added INFORMIXSERVER environment variable.
</p><p>Added $ADODB_ANSI_PADDING_OFF for interbase/firebird.
</p><p>PHP 5 beta 2 compat check. Foreach (Iterator) support. Exceptions support.
</p><p><b>4.01 23 Oct 2003 </b>
</p><p>Fixed bug in rs2html(), tohtml.inc.php, that generated blank table cells.
</p><p>Fixed insert_id() incorrectly generated when logsql() enabled.
</p><p>Modified PostgreSQL _fixblobs to use list/each instead of foreach.
</p><p>Informix ErrorNo() implemented correctly.
</p><p>Modified several places to use list/each, including GetRowAssoc().
</p><p>Added UserTimeStamp() to connection class.
</p><p>Added $ADODB_ANSI_PADDING_OFF for oci8po.
</p><p><b>4.00 20 Oct 2003 </b>
</p><p>Upgraded adodb-xmlschema to 1 Oct 2003 snapshot.
</p><p>Fix to rs2html warning message. Thx to Filo.
</p><p>Fix for odbc_mssql/mssql SQLDate(), hours was wrong.
</p><p>Added MetaColumns and MetaPrimaryKeys for sybase. Thx to Chris Phillipson.
</p><p>Added autoquoting to datadict for MySQL and PostgreSQL. Suggestion by Karsten Dambekalns  
</p><p><b>3.94 11 Oct 2003 </b>
</p><p>Create trigger in datadict-oci8.inc.php did not work, because all cr/lf's must be removed. 
</p><p>ErrorMsg()/ErrorNo() did not work for many databases when logging enabled. Fixed.
</p><p>Removed global variable $ADODB_LOGSQL as it does not work properly with multiple connections.
</p><p>Added SQLDate support for sybase. Thx to Chris Phillipson
</p><p>Postgresql checking of pgsql resultset resource was incorrect. Fix by Bharat Mediratta bharat#menalto.com.
Same patch applied to  _insertid and _affectedrows for adodb-postgres64.inc.php.
</p><p>Added support for NConnect for postgresql.
</p><p>Added Sybase data dict support. Thx to Chris Phillipson  
</p><p>Extensive improvements in $perf-&gt;UI(), eg. Explain now opens in new window, we show scripts
which call sql, etc.
</p><p>Perf Monitor UI works with magic quotes enabled.
</p><p>rsPrefix was declared twice. Removed.
</p><p>Oci8 stored procedure support, eg. "begin func(); end;" was incorrect in _query. Fixed.
</p><p>Tiraboschi Massimiliano contributed italian language file.
</p><p>Fernando Ortiz, fortiz#lacorona.com.mx, contributed informix performance monitor.
</p><p>Added _varchar (varchar arrays) support for postgresql. Reported by PREVOT St&eacute;phane.<hr />
<p><strong>0.10 Sept 9 2000</strong> First release 
</p><h3><strong>Old change log history moved to <a href="old-changelog.htm">old-changelog.htm</a>. 
  </strong></h3>
<p>&nbsp;</p>
<p>  
</p></body></html>