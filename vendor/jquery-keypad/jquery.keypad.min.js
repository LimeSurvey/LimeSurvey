!function(a){"use strict";var b="keypad";a.JQPlugin.createPlugin({name:b,deepMerge:!1,defaultOptions:{showOn:"focus",buttonImage:"",buttonImageOnly:!1,showAnim:"show",showOptions:null,duration:"normal",appendText:"",useThemeRoller:!1,keypadClass:"",prompt:"",layout:[],separator:"",target:null,keypadOnly:!0,randomiseAlphabetic:!1,randomiseNumeric:!1,randomiseOther:!1,randomiseAll:!1,beforeShow:null,onKeypress:null,onClose:null},regionalOptions:{"":{buttonText:"...",buttonStatus:"Open the keypad",closeText:"Close",closeStatus:"Close the keypad",clearText:"Clear",clearStatus:"Erase all the text",backText:"Back",backStatus:"Erase the previous character",spacebarText:"&#160;",spacebarStatus:"Space",enterText:"Enter",enterStatus:"Carriage return",tabText:"â†’",tabStatus:"Horizontal tab",shiftText:"Shift",shiftStatus:"Toggle upper/lower case characters",alphabeticLayout:[],fullLayout:[],isAlphabetic:null,isNumeric:null,toUpper:null,isRTL:!1}},BS:"\b",DEL:"",_curInst:null,_disabledFields:[],_keypadShowing:!1,_keyCode:0,_specialKeys:[],_mainDivClass:b+"-popup",_inlineClass:b+"-inline",_appendClass:b+"-append",_triggerClass:b+"-trigger",_disableClass:b+"-disabled",_inlineEntryClass:b+"-keyentry",_rtlClass:b+"-rtl",_rowClass:b+"-row",_promptClass:b+"-prompt",_specialClass:b+"-special",_namePrefixClass:b+"-",_keyClass:b+"-key",_keyDownClass:b+"-key-down",addKeyDef:function(a,b,c,d){if(32===this._keyCode)throw"Only 32 special keys allowed";return this[a]=String.fromCharCode(this._keyCode++),this._specialKeys.push({code:this[a],id:a,name:b,action:c,noHighlight:d}),this},_init:function(){this.mainDiv=a('<div class="'+this._mainDivClass+'" style="display: none;"></div>'),this._super()},_instSettings:function(b,d){var e=!b[0].nodeName.toLowerCase().match(/input|textarea/);return{_inline:e,ucase:!1,_mainDiv:e?a('<div class="'+this._inlineClass+'"></div>'):c.mainDiv}},_postAttach:function(a,b){b._inline?(a.append(b._mainDiv).on("click."+b.name,function(){b._input.focus()}),this._updateKeypad(b)):a.is(":disabled")&&this.disable(a)},_setInput:function(b,c){c._input=a(c._inline?c.options.target||'<input type="text" class="'+this._inlineEntryClass+'" disabled/>':b),c._inline&&(b.find("input").remove(),c.options.target||b.append(c._input))},_optionsChanged:function(b,d,e){a.extend(d.options,e),b.off("."+d.name).siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove();var f=d.options.appendText;if(f&&b[d.options.isRTL?"before":"after"]('<span class="'+this._appendClass+'">'+f+"</span>"),!d._inline&&("focus"!==d.options.showOn&&"both"!==d.options.showOn||b.on("focus."+d.name,this.show).on("keydown."+d.name,this._doKeyDown),"button"===d.options.showOn||"both"===d.options.showOn)){var g=d.options.buttonStatus,h=d.options.buttonImage,i=a(d.options.buttonImageOnly?a('<img src="'+h+'" alt="'+g+'" title="'+g+'"/>'):a('<button type="button" title="'+g+'"></button>').html(""===h?d.options.buttonText:a('<img src="'+h+'" alt="'+g+'" title="'+g+'"/>')));b[d.options.isRTL?"before":"after"](i),i.addClass(this._triggerClass).click(function(){return c._keypadShowing&&c._lastField===b[0]?c.hide():c.show(b[0]),!1})}d.saveReadonly=b.attr("readonly"),b[d.options.keypadOnly?"attr":"removeAttr"]("readonly",!0).on("setData."+d.name,function(a,b,c){d.options[b]=c}).on("getData."+d.name,function(a,b){return d.options[b]}),this._setInput(b,d),this._updateKeypad(d)},_preDestroy:function(a,b){this._curInst===b&&this.hide(),a.siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().prev("."+this._inlineEntryClass).remove(),a.empty().off("."+b.name)[b.saveReadonly?"attr":"removeAttr"]("readonly",!0),b._input.removeData(b.name)},enable:function(b){if(b=a(b),b.hasClass(this._getMarker())){var c=b[0].nodeName.toLowerCase();c.match(/input|textarea/)?b.prop("disabled",!1).siblings("button."+this._triggerClass).prop("disabled",!1).end().siblings("img."+this._triggerClass).css({opacity:"1.0",cursor:""}):c.match(/div|span/)&&(b.children("."+this._disableClass).remove(),this._getInst(b)._mainDiv.find("button").prop("disabled",!1)),this._disabledFields=a.map(this._disabledFields,function(a){return a===b[0]?null:a})}},disable:function(b){if(b=a(b),b.hasClass(this._getMarker())){var c=b[0].nodeName.toLowerCase();if(c.match(/input|textarea/))b.prop("disabled",!0).siblings("button."+this._triggerClass).prop("disabled",!0).end().siblings("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});else if(c.match(/div|span/)){var d=b.children("."+this._inlineClass),e=d.offset(),f={left:0,top:0};d.parents().each(function(){if("relative"===a(this).css("position"))return f=a(this).offset(),!1}),b.prepend('<div class="'+this._disableClass+'" style="width: '+d.outerWidth()+"px; height: "+d.outerHeight()+"px; left: "+(e.left-f.left)+"px; top: "+(e.top-f.top)+'px;"></div>'),this._getInst(b)._mainDiv.find("button").prop("disabled",!0)}this._disabledFields=a.map(this._disabledFields,function(a){return a===b[0]?null:a}),this._disabledFields[this._disabledFields.length]=b[0]}},isDisabled:function(b){return b&&a.inArray(b,this._disabledFields)>-1},show:function(b){if(b=b.target||b,!c.isDisabled(b)&&c._lastField!==b){var d=c._getInst(b);c.hide(null,""),c._lastField=b,c._pos=c._findPos(b),c._pos[1]+=b.offsetHeight;var e=!1;a(b).parents().each(function(){return!(e=e||"fixed"===a(this).css("position"))});var f={left:c._pos[0],top:c._pos[1]};c._pos=null,d._mainDiv.stop(!0,!0).css({position:"absolute",display:"block",top:"-1000px",width:"auto"}),c._updateKeypad(d),f=c._checkOffset(d,f,e),d._mainDiv.css({position:e?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});var g=d.options.duration,h=d.options.showAnim,i=function(){c._keypadShowing=!0};if(a.effects&&(a.effects[h]||a.effects.effect&&a.effects.effect[h])){var j=d._mainDiv.data();for(var k in j)k.match(/^ec\.storage\./)&&(j[k]=d._mainDiv.css(k.replace(/ec\.storage\./,"")));d._mainDiv.data(j).show(h,d.options.showOptions||{},g,i)}else d._mainDiv[h||"show"](h?g:0,i);"hidden"!==d._input[0].type&&d._input[0].focus(),c._curInst=d}},_updateKeypad:function(b){b._mainDiv.empty().append(this._generateHTML(b)).removeClass().addClass(b.options.keypadClass+(b.options.useThemeRoller?" ui-widget ui-widget-content":"")+(b.options.isRTL?" "+this._rtlClass:"")+" "+(b._inline?this._inlineClass:this._mainDivClass)),a.isFunction(b.options.beforeShow)&&b.options.beforeShow.apply(b._input?b._input[0]:null,[b._mainDiv,b])},_checkOffset:function(b,c,d){var e=b._input?this._findPos(b._input[0]):null,f=window.innerWidth||document.documentElement.clientWidth,g=window.innerHeight||document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,j=0;return b._mainDiv.find(":not(div)").each(function(){j=Math.max(j,this.offsetLeft+a(this).outerWidth(!0))}),b._mainDiv.css("width",j+1),b.options.isRTL||c.left+b._mainDiv.outerWidth()-h>f?c.left=Math.max(d?0:h,e[0]+(b._input?b._input.outerWidth():0)-(d?h:0)-b._mainDiv.outerWidth()):c.left=Math.max(d?0:h,c.left-(d?h:0)),c.top+b._mainDiv.outerHeight()-i>g?c.top=Math.max(d?0:i,e[1]-(d?i:0)-b._mainDiv.outerHeight()):c.top=Math.max(d?0:i,c.top-(d?i:0)),c},_findPos:function(b){for(;b&&("hidden"===b.type||1!==b.nodeType);)b=b.nextSibling;var c=a(b).offset();return[c.left,c.top]},hide:function(b,c){var d=this._curInst;if(d&&(!b||d===a.data(b,this.name))){if(this._keypadShowing){d._mainDiv.stop(!0,!0),c=void 0!==c&&null!==c?c:d.options.duration;var e=d.options.showAnim;a.effects&&(a.effects[e]||a.effects.effect&&a.effects.effect[e])?d._mainDiv.hide(e,d.options.showOptions||{},c):d._mainDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?c:0)}a.isFunction(d.options.onClose)&&d.options.onClose.apply(d._input?d._input[0]:null,[d._input.val(),d]),this._keypadShowing&&(this._keypadShowing=!1,this._lastField=null),d._inline&&d._input.val(""),this._curInst=null}},_doKeyDown:function(a){9===a.keyCode&&(c.mainDiv.stop(!0,!0),c.hide())},_checkExternalClick:function(b){if(c._curInst){var d=a(b.target);0===d.closest("."+c._mainDivClass).length&&!d.hasClass(c._getMarker())&&0===d.closest("."+c._triggerClass).length&&c._keypadShowing&&c.hide()}},_shiftKeypad:function(a){a.ucase=!a.ucase,this._updateKeypad(a),a._input.focus()},_clearValue:function(a){this._setValue(a,"",0),this._notifyKeypress(a,c.DEL),a._input.focus()},_backValue:function(a){var b=a._input[0],d=a._input.val(),e=[d.length,d.length];e=a._input.prop("readonly")||a._input.prop("disabled")?e:b.setSelectionRange?[b.selectionStart,b.selectionEnd]:b.createTextRange?this._getIERange(b):e,this._setValue(a,0===d.length?"":d.substr(0,e[0]-1)+d.substr(e[1]),e[0]-1),this._notifyKeypress(a,c.BS),a._input.focus()},_selectValue:function(a,b){this.insertValue(a._input[0],b),this._setValue(a,a._input.val()),this._notifyKeypress(a,b)},insertValue:function(b,c){b=b.jquery?b:a(b);var d=b[0],e=b.val(),f=[e.length,e.length];f=b.attr("readonly")||b.attr("disabled")?f:d.setSelectionRange?[d.selectionStart,d.selectionEnd]:d.createTextRange?this._getIERange(d):f,b.val(e.substr(0,f[0])+c+e.substr(f[1]));var g=f[0]+c.length;b.is(":visible")&&b.focus(),d.setSelectionRange?b.is(":visible")&&d.setSelectionRange(g,g):d.createTextRange&&(f=d.createTextRange(),f.move("character",g),f.select())},_getIERange:function(a){a.focus();var b=document.selection.createRange().duplicate(),c=this._getIETextRange(a);c.setEndPoint("EndToStart",b);var d=function(a){for(var b=a.text,c=b;;){if(0===a.compareEndPoints("StartToEnd",a))break;if(a.moveEnd("character",-1),a.text!==b)break;c+="\r\n"}return c},e=d(c),f=d(b);return[e.length,e.length+f.length]},_getIETextRange:function(a){var b="input"===a.nodeName.toLowerCase(),c=b?a.createTextRange():document.body.createTextRange();return b||c.moveToElementText(a),c},_setValue:function(b,c){var d=b._input.attr("maxlength");d>-1&&(c=c.substr(0,d)),b._input.val(c),a.isFunction(b.options.onKeypress)||b._input.trigger("change")},_notifyKeypress:function(b,c){a.isFunction(b.options.onKeypress)&&b.options.onKeypress.apply(b._input?b._input[0]:null,[c,b._input.val(),b])},_generateHTML:function(b){for(var d=b.options.prompt?'<div class="'+this._promptClass+(b.options.useThemeRoller?" ui-widget-header ui-corner-all":"")+'">'+b.options.prompt+"</div>":"",e=this._randomiseLayout(b),f=0;f<e.length;f++){d+='<div class="'+this._rowClass+'">';for(var g=e[f].split(b.options.separator),h=0;h<g.length;h++){b.ucase&&(g[h]=b.options.toUpper(g[h]));var i=this._specialKeys[g[h].charCodeAt(0)];d+=i?i.action?'<button type="button" class="'+this._specialClass+" "+this._namePrefixClass+i.name+(b.options.useThemeRoller?" ui-corner-all ui-state-default"+(i.noHighlight?"":" ui-state-highlight"):"")+'" title="'+b.options[i.name+"Status"]+'">'+(b.options[i.name+"Text"]||"&#160;")+"</button>":'<div class="'+this._namePrefixClass+i.name+'"></div>':'<button type="button" class="'+this._keyClass+(b.options.useThemeRoller?" ui-corner-all ui-state-default":"")+'">'+(" "===g[h]?"&#160;":g[h])+"</button>"}d+="</div>"}d=a(d);var j=b,k=this._keyDownClass+(b.options.useThemeRoller?" ui-state-active":"");return d.find("button").mousedown(function(){a(this).addClass(k)}).mouseup(function(){a(this).removeClass(k)}).mouseout(function(){a(this).removeClass(k)}).filter("."+this._keyClass).click(function(){c._selectValue(j,a(this).text())}),a.each(this._specialKeys,function(a,b){d.find("."+c._namePrefixClass+b.name).click(function(){b.action.apply(j._input,[j])})}),d},_randomiseLayout:function(a){if(!(a.options.randomiseNumeric||a.options.randomiseAlphabetic||a.options.randomiseOther||a.options.randomiseAll))return a.options.layout;var b,c,d,e=[],f=[],g=[],h=[];for(b=0;b<a.options.layout.length;b++)for(h[b]="",d=a.options.layout[b].split(a.options.separator),c=0;c<d.length;c++)this._isControl(d[c])||(a.options.randomiseAll?g.push(d[c]):a.options.isNumeric(d[c])?e.push(d[c]):a.options.isAlphabetic(d[c])?f.push(d[c]):g.push(d[c]));a.options.randomiseNumeric&&this._shuffle(e),a.options.randomiseAlphabetic&&this._shuffle(f),(a.options.randomiseOther||a.options.randomiseAll)&&this._shuffle(g);var i=0,j=0,k=0;for(b=0;b<a.options.layout.length;b++)for(d=a.options.layout[b].split(a.options.separator),c=0;c<d.length;c++)h[b]+=(c>0?a.options.separator:"")+(this._isControl(d[c])?d[c]:a.options.randomiseAll?g[k++]:a.options.isNumeric(d[c])?e[i++]:a.options.isAlphabetic(d[c])?f[j++]:g[k++]);return h},_isControl:function(a){return a<" "},isAlphabetic:function(a){return a>="A"&&a<="Z"||a>="a"&&a<="z"},isNumeric:function(a){return a>="0"&&a<="9"},toUpper:function(a){return a.toUpperCase()},_shuffle:function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}}});var c=a.keypad;c.addKeyDef("CLOSE","close",function(a){c._curInst=a._inline?a:c._curInst,c.hide()}),c.addKeyDef("CLEAR","clear",function(a){c._clearValue(a)}),c.addKeyDef("BACK","back",function(a){c._backValue(a)}),c.addKeyDef("SHIFT","shift",function(a){c._shiftKeypad(a)}),c.addKeyDef("SPACE_BAR","spacebar",function(a){c._selectValue(a," ")},!0),c.addKeyDef("SPACE","space"),c.addKeyDef("HALF_SPACE","half-space"),c.addKeyDef("ENTER","enter",function(a){c._selectValue(a,"\r")},!0),c.addKeyDef("TAB","tab",function(a){c._selectValue(a,"\t")},!0),c.numericLayout=["123"+c.CLOSE,"456"+c.CLEAR,"789"+c.BACK,c.SPACE+"0"],c.qwertyAlphabetic=["qwertyuiop","asdfghjkl","zxcvbnm"],c.qwertyLayout=["!@#$%^&*()_="+c.HALF_SPACE+c.SPACE+c.CLOSE,c.HALF_SPACE+"`~[]{}<>\\|/"+c.SPACE+"789","qwertyuiop'\""+c.HALF_SPACE+"456",c.HALF_SPACE+"asdfghjkl;:"+c.SPACE+"123",c.SPACE+"zxcvbnm,.?"+c.SPACE+c.HALF_SPACE+"-0+",""+c.TAB+c.ENTER+c.SPACE_BAR+c.SHIFT+c.HALF_SPACE+c.BACK+c.CLEAR],a.extend(c.regionalOptions[""],{alphabeticLayout:c.qwertyAlphabetic,fullLayout:c.qwertyLayout,isAlphabetic:c.isAlphabetic,isNumeric:c.isNumeric,toUpper:c.toUpper}),c.setDefaults(a.extend({layout:c.numericLayout},c.regionalOptions[""])),a(function(){a(document.body).append(c.mainDiv).on("mousedown."+b,c._checkExternalClick)})}(jQuery);
//# sourceMappingURL=jquery.keypad.min.map